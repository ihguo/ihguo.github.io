<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.1.1">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="An efficient method to measure the ISFs of periodic circuits via periodic AC (PAC) analysis, which is available from RF circuit simulators such as SpectreRF and ADS ISF Linear Time-varying System Theo">
<meta property="og:type" content="article">
<meta property="og:title" content="Impulse Sensitivity Function (ISF) of Periodic Sampler">
<meta property="og:url" content="http://example.com/2022/06/10/isf-sampler/index.html">
<meta property="og:site_name" content="KNOW-HOW">
<meta property="og:description" content="An efficient method to measure the ISFs of periodic circuits via periodic AC (PAC) analysis, which is available from RF circuit simulators such as SpectreRF and ADS ISF Linear Time-varying System Theo">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2022/06/10/isf-sampler/image-20220610235211500.png">
<meta property="og:image" content="http://example.com/2022/06/10/isf-sampler/yt.drawio.svg">
<meta property="og:image" content="http://example.com/2022/06/10/isf-sampler/image-20220614214446328.png">
<meta property="og:image" content="http://example.com/2022/06/10/isf-sampler/image-20220614214537033.png">
<meta property="og:image" content="http://example.com/2022/06/10/isf-sampler/image-20220614214613574.png">
<meta property="og:image" content="http://example.com/2022/06/10/isf-sampler/image-20220610222535614.png">
<meta property="og:image" content="http://example.com/2022/06/10/isf-sampler/image-20220610224100135.png">
<meta property="og:image" content="http://example.com/2022/06/10/isf-sampler/image-20220610225310243.png">
<meta property="article:published_time" content="2022-06-10T19:57:01.000Z">
<meta property="article:modified_time" content="2024-08-14T15:55:06.402Z">
<meta property="article:author" content="Guo">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2022/06/10/isf-sampler/image-20220610235211500.png">


<link rel="canonical" href="http://example.com/2022/06/10/isf-sampler/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://example.com/2022/06/10/isf-sampler/","path":"2022/06/10/isf-sampler/","title":"Impulse Sensitivity Function (ISF) of Periodic Sampler"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Impulse Sensitivity Function (ISF) of Periodic Sampler | KNOW-HOW</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">KNOW-HOW</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#isf"><span class="nav-number">1.</span> <span class="nav-text">ISF</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#linear-time-varying-system-theory"><span class="nav-number">1.1.</span> <span class="nav-text">Linear Time-varying System
Theory</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#characterizing-isf-via-pac"><span class="nav-number">1.2.</span> <span class="nav-text">Characterizing ISF via PAC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#align-pss_td.pss-with-isf"><span class="nav-number">1.3.</span> <span class="nav-text">Align pss_td.pss with ISF</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#align-pss_fd.pss-with-isf"><span class="nav-number">1.4.</span> <span class="nav-text">Align pss_fd.pss with ISF</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#remarks"><span class="nav-number">1.5.</span> <span class="nav-text">Remarks</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#tstab-in-pss"><span class="nav-number">2.</span> <span class="nav-text">tstab in PSS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#simulation-log"><span class="nav-number">2.1.</span> <span class="nav-text">simulation log</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pss-simulation-result"><span class="nav-number">2.2.</span> <span class="nav-text">PSS simulation result</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#align-pss_tb-and-pss_fd"><span class="nav-number">2.3.</span> <span class="nav-text">Align pss_tb and pss_fd</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#reference"><span class="nav-number">3.</span> <span class="nav-text">reference</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Guo</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">165</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/raytroop" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;raytroop" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:raytroop@gmail.com" title="E-Mail → mailto:raytroop@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/10/isf-sampler/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Impulse Sensitivity Function (ISF) of Periodic Sampler | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Impulse Sensitivity Function (ISF) of Periodic Sampler
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-06-10 19:57:01" itemprop="dateCreated datePublished" datetime="2022-06-10T19:57:01+00:00">2022-06-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-08-14 15:55:06" itemprop="dateModified" datetime="2024-08-14T15:55:06+00:00">2024-08-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/noise/" itemprop="url" rel="index"><span itemprop="name">noise</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>An efficient method to measure the ISFs of periodic circuits via
periodic AC (PAC) analysis, which is available from RF circuit
simulators such as SpectreRF and ADS</p>
<h2 id="isf">ISF</h2>
<h3 id="linear-time-varying-system-theory">Linear Time-varying System
Theory</h3>
<p>We define the ISF of the sampler as the sensitivity of its final
output voltage to the impulse arriving at its input at different times,
the ISF essentially describes the aperture of the sampler.</p>
<p>An ideal sampler would have the perfect aperture, i.e. sampling the
input voltage at exactly one point in time; thus, its ISF would be a
Dirac delta function, <span class="math inline">\(\delta(t-t_s)\)</span>
where <span class="math inline">\(t_s\)</span> is when sampling
occurs.</p>
<p>A realistic sampler would rather capture a weighted-average of the
input voltage over a certain time window. This weighting function is
called the sampling aperture and is equivalent to the ISF</p>
<p><img src="/2022/06/10/isf-sampler/image-20220610235211500.png"
alt="image-20220610235211500" /></p>
<p>A <strong>time-varying impulse response</strong> <span
class="math inline">\(h(t, \tau)\)</span> is defined as the circuit
response at time <span class="math inline">\(t\)</span> responding to an
impulse arriving at time <span class="math inline">\(\tau\)</span>.</p>
<p>In general, the ISF can be regarded as the <strong>time-varying
impulse response</strong> evaluated at <em>one particular observation
time</em> <span class="math inline">\(t=t_0\)</span>.</p>
<p>The system output <span class="math inline">\(y(t)\)</span> is
related to the input <span class="math inline">\(x(t)\)</span> as: <span
class="math display">\[
y(t) = \int_{-\infty}^{\infty}h(t, \tau)\cdot x(\tau)d\tau
\]</span> Note that in a linear time-invariant (LTI) system, <span
class="math inline">\(h(t,\tau)=h(t-\tau)\)</span> and the above
equation reduces to a convolution.</p>
<p>If <span class="math inline">\(X(j\omega)\)</span> is the Fourier
transform of the input signal <span class="math inline">\(x(t)\)</span>,
i.e. <span class="math display">\[
x(t) = \frac{1}{2\pi}\int_{-\infty}^{\infty}X(j\omega)\cdot e^{j\omega
t}d\omega
\]</span> Then <span class="math display">\[\begin{align}
y(t) &amp;=
\int_{-\infty}^{\infty}h(t,\tau)\left[\frac{1}{2\pi}\int_{-\infty}^{\infty}X(j\omega)\cdot
e^{j\omega\tau }d\omega \right]\cdot d\tau \\
&amp;=\frac{1}{2\pi}\int_{-\infty}^{\infty}X(j\omega)\left[\int_{-\infty}^{\infty}h(t,\tau)\cdot
e^{j\omega\tau}d\tau\right]\cdot d\omega \\
&amp;=\frac{1}{2\pi}\int_{-\infty}^{\infty}X(j\omega)\left[\int_{-\infty}^{\infty}h(t,\tau)\cdot
e^{-j\omega(t-\tau)}d\tau\right]\cdot e^{j\omega t}\cdot d\omega \\
&amp;=\frac{1}{2\pi}\int_{-\infty}^{\infty}X(j\omega)\cdot
H(j\omega;t)\cdot e^{j\omega t}\cdot d\omega
\end{align}\]</span></p>
<p>where <span class="math inline">\(H(j\omega;t)\)</span> is
<strong>time-varying transfer function</strong>, defined as the Fourier
transform of the time-varying impulse response. <span
class="math display">\[
H(j\omega;t)=\int_{-\infty}^{\infty}h(t,\tau)\cdot
e^{-j\omega(t-\tau)}d\tau
\]</span> And it follows that: <span class="math display">\[
Y(j\omega)=H(j\omega;t)\cdot X(j\omega)
\]</span> And</p>
<p><span class="math display">\[\begin{align}
x(\tau) &amp; \overset{FT}{\longrightarrow} X(j\omega) \\
h(t,\tau) &amp; \overset{FT}{\longrightarrow} H(j\omega;t)
\end{align}\]</span></p>
<p>For linear, periodically time-varying (LPTV) systems, <span
class="math inline">\(h(t, \tau) = h(t+T, \tau+T)\)</span> and <span
class="math inline">\(H(j\omega; t) = H(j\omega; t+T)\)</span> where
<span class="math inline">\(T\)</span> is the period of the time-varying
dynamics of the system.</p>
<p>We prove <span class="math inline">\(H(j\omega; t) = H(j\omega;
t+T)\)</span>:</p>
<p><span class="math display">\[\begin{align}
\because H(j\omega;t)&amp;=\int_{-\infty}^{\infty}h(t,\tau)\cdot
e^{-j\omega(t-\tau)}d\tau \\
\therefore H(j\omega;t+T) &amp;= \int_{-\infty}^{\infty}h(t+T,\tau)\cdot
e^{-j\omega(t+T-\tau)}d\tau \\
&amp;= \int_{-\infty}^{\infty}h(t+T,\tau+T)\cdot
e^{-j\omega(t+T-(\tau+T))}d(\tau+T) \\
&amp;= \int_{-\infty}^{\infty}h(t+T,\tau+T)\cdot
e^{-j\omega(t-\tau)}d\tau \\
&amp;= \int_{-\infty}^{\infty}h(t,\tau)\cdot e^{-j\omega(t-\tau)}d\tau
\\
&amp;= H(j\omega;t)
\end{align}\]</span></p>
<h3 id="characterizing-isf-via-pac">Characterizing ISF via PAC</h3>
<p>Since <span class="math inline">\(H(j\omega;t)\)</span> is periodic
in <span class="math inline">\(T\)</span>, The time-varying transfer
function <span class="math inline">\(H(j\omega;t)\)</span> can be
expressed in a Fourier series: <span class="math display">\[
H(j\omega;t)=\sum_{m=-\infty}^{\infty}H_m(j\omega) \cdot e^{jm\omega_c
t}
\]</span> where <span class="math inline">\(\omega_c\)</span> is the
fundamental frequency of the periodic system. <span
class="math inline">\(H_m(j\omega)\)</span> represent the frequency
response of the system at the <em>(m-th)</em> harmonic output sideband
to a unit <span class="math inline">\(j\omega\)</span> sinusoid.</p>
<blockquote>
<p>The above equation link time-varying transfer function <span
class="math inline">\(H(j\omega;t)\)</span> with PAC simulation
output</p>
</blockquote>
<p>The response to a periodic impulse train, that is: <span
class="math display">\[
x(t)=\sum_{m=-\infty}^{\infty}\delta(t-\tau-nkT)
\]</span> The idea is that if the impulse response of the system settles
to zero long before the next impulse arrives, then the system response
to this impulse train would be approximately equal to the periodic
repetition of the true impulse response, i.e.: <span
class="math display">\[
y(t) \cong  \sum_{m=-\infty}^{\infty}h(t;\tau+nkT)
\]</span> and <span class="math inline">\(y(t)\)</span> would be
approximately equal to <span class="math inline">\(h(t;\tau)\)</span>
for <span class="math inline">\(\tau \leq t \le t+kT\)</span></p>
<p><img src="/2022/06/10/isf-sampler/yt.drawio.svg"
alt="yt.drawio" /></p>
<blockquote>
<p>Without loss of generality and for computation convenience, we set
<span class="math inline">\(k=1\)</span> thereafter.</p>
</blockquote>
<p>The Fourier transform <span class="math inline">\(X(j\omega)\)</span>
of the <strong>T-periodic</strong> impulse train is: <span
class="math display">\[
X(j\omega)=\omega_c\sum_{n=-\infty}^{\infty}\delta(\omega-n\omega_c)\cdot
e^{-j\omega\tau}
\]</span> Then the response <span class="math inline">\(y(t)\)</span>
is: <span class="math display">\[
y(t)=\frac{1}{T}\sum_{n=-\infty}^{\infty}H(jn\omega_c;t)\cdot
e^{jn\omega_c\cdot(t-\tau)}
\]</span> The expression for the approximate time-varying impulse
response: <span class="math display">\[
h(t,\tau) = \left\{ \begin{array}{cl}
\frac{1}{T}\sum_{n=-\infty}^{\infty}\sum_{m=-\infty}^{\infty}H_m(jn\omega_c)\cdot
e^{jm\omega_ct+jn\omega_c\cdot (t-\tau)} &amp; : \ \tau \leq \tau+T \\
0 &amp; : \ \text{elsewhere}
\end{array} \right.
\]</span> Finally, the ISF <span
class="math inline">\(\Gamma(\tau)\)</span> is equal to <span
class="math inline">\(h(t,\tau)\)</span> when <span
class="math inline">\(t=t_0\)</span> and <span class="math inline">\(t_0
\gt \tau\)</span> <span class="math display">\[
\Gamma(\tau)\cong
\frac{1}{T}\sum_{n=-\infty}^{\infty}\sum_{m=-\infty}^{\infty}H_m(jn\omega_c)\cdot
e^{jm\omega_ct_0+jn\omega_c\cdot (t_0-\tau)}
\]</span> In practice, the summations are carried out over finite ranges
of <strong>n</strong> and <strong>m</strong>, for example, -50~50.</p>
<p>For each combination of <strong>n</strong> and <strong>m</strong>,
the PAC analysis needs to be performed to compute <span
class="math inline">\(H_m(jn\omega_c)\)</span>, the m-th harmonic
response to the excitation at <span
class="math inline">\(n\omega_c\)</span></p>
<p>The detailed procedure for characterizing the ISF of this sampler is
outlined as follows:</p>
<ul>
<li><p>First, apply the proper input voltages that place the sampler in
a metastable state and perform the periodic steady-state (PSS)
analysis.</p></li>
<li><p>Second, perform the PAC analysis.</p></li>
<li><p>Third, based on the simulated PAC response, pick a time point
<span class="math inline">\(t_0\)</span> at which the ISF is to be
computed and derive the ISF</p></li>
</ul>
<p>One possible candidate for the ISF measurement point <span
class="math inline">\(t_0\)</span> is the time at which the output
voltage is amplified to the largest value. PAC response of the sampler
to a small signal DC input, that is, the time-varying transfer function
evaluated at <span class="math inline">\(\omega=0\)</span> <span
class="math display">\[
H(j\omega;t)=\sum_{m=-\infty}^{\infty}H_m(0) \cdot e^{jm\omega_c t}
\]</span> <img src="/2022/06/10/isf-sampler/image-20220614214446328.png"
alt="image-20220614214446328" /></p>
<blockquote>
<p>The total area under the ISF is the sampling gain, which is equal to
the time-varying gain measured at <span
class="math inline">\(t_0\)</span></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">time-varying gain at t0 H(0;t0): 19.486305</span><br><span class="line">The total area under the ISF: 19.990230</span><br></pre></td></tr></table></figure>
<h3 id="align-pss_td.pss-with-isf">Align pss_td.pss with ISF</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">****************************************************</span><br><span class="line">Periodic Steady-State Analysis `pss&#x27;: fund = 500 MHz</span><br><span class="line">****************************************************</span><br><span class="line">Trying `homotopy = gmin&#x27; for initial conditions.</span><br><span class="line">DC simulation time: CPU = 4.237 ms, elapsed = 4.27389 ms.</span><br><span class="line"></span><br><span class="line">===============================</span><br><span class="line">`pss&#x27;: time = (0 s -&gt; 102.6 ns)</span><br><span class="line">===============================</span><br><span class="line"></span><br><span class="line">Opening the PSF file ../psf/pss.tran.pss ...</span><br><span class="line">...</span><br><span class="line">Important parameter values in tstab integration:</span><br><span class="line">    start = 0 s</span><br><span class="line">    outputstart = 0 s</span><br><span class="line">    stop = 102.6 ns</span><br><span class="line">    period = 2 ns</span><br><span class="line">    maxperiods = 20</span><br><span class="line">    step = 102.6 ps</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p><strong>tstab = 102.6 ns</strong> can be observed in pss simulation
log</p>
<p><img src="/2022/06/10/isf-sampler/image-20220614214537033.png"
alt="image-20220614214537033" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tstab = <span class="number">102.6e-9</span>;</span><br><span class="line">tshift = <span class="built_in">mod</span>(tstab, Tc);</span><br><span class="line">tt_shift = tt - tshift;</span><br><span class="line">tt_shift_start_indx = <span class="built_in">find</span>(tt_shift&gt;=<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">isf_shift = <span class="built_in">circshift</span>(isf_re, -tt_shift_start_indx);</span><br></pre></td></tr></table></figure>
<h3 id="align-pss_fd.pss-with-isf">Align pss_fd.pss with ISF</h3>
<p>Since both are frequency originated, time-shift is NOT needed</p>
<p><img src="/2022/06/10/isf-sampler/image-20220614214613574.png"
alt="image-20220614214613574" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">wv</span> = <span class="title">wv_fd</span><span class="params">(fname,tt)</span></span></span><br><span class="line">fd = csvread(fname, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">DC = fd(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">w = <span class="number">2</span>*<span class="built_in">pi</span>*fd(<span class="number">2</span>:<span class="keyword">end</span>, <span class="number">1</span>);</span><br><span class="line">coef = fd(<span class="number">2</span>:<span class="keyword">end</span>, <span class="number">2</span>) + <span class="number">1</span><span class="built_in">i</span>*fd(<span class="number">2</span>:<span class="keyword">end</span>, <span class="number">3</span>);</span><br><span class="line">exp_sup = <span class="number">1</span><span class="built_in">i</span>*w.*tt;</span><br><span class="line">wv = sum(<span class="built_in">real</span>(coef .* <span class="built_in">exp</span>(exp_sup)), <span class="number">1</span>) + DC;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h3 id="remarks">Remarks</h3>
<p><strong>pss pac setup</strong></p>
<ul>
<li>clock frequency should be low enough to assure system response
settle to zero.</li>
<li>Beat Frequency os PSS should be clock frequency</li>
<li>For PAC setup,
<ul>
<li>the <code>Sweeptype</code> is <code>absolute</code></li>
<li><code>Input Frequency Sweep Range(Hz)</code> should be large
enough.</li>
<li><code>Sweep Type</code> should be <code>Linear</code> and
<code>Step Size</code> should equal <strong>PSS Beat
Frequency(Hz)</strong></li>
<li><code>SideBands</code> should large enough, like 50 (i.e. 50*2 +1,
positive, negative and 0)</li>
<li><code>Specialized Analyses</code> should be <code>None</code></li>
</ul></li>
</ul>
<blockquote>
<p>one example: clock, i.e. beat frequency = 8G PAC: input frequency
sweep from -400G to 400G and step is 8G, which is beat frequency, here
K=1 Eq.(9) of paper</p>
</blockquote>
<blockquote>
<p><strong>freqaxis=out</strong>: <code>freqaxis</code> of PAC not only
affect "Direct Plot"'s output but also simuation data i.e. the phase
shift(imaginary part).</p>
</blockquote>
<p>matlab matrix <strong>nonconjugate transpose</strong>:</p>
<p><code>transpose</code>, <code>.'</code> cf.
https://www.mathworks.com/help/matlab/ref/transpose.html</p>
<h2 id="tstab-in-pss"><code>tstab</code> in PSS</h2>
<p>Using shooting PSS, the steady waveform starts from
<code>tstab+n*tperiod</code>.</p>
<ul>
<li><strong>pss_td.pss</strong> is one period waveform starting from
<code>tstab+n*tperiod</code></li>
<li><strong>pss_fd.pss</strong> is the <em>complex</em> fourier series
coefficient of expanded to left and right <strong>pss_td.pss</strong>
waveform (<code>tstab+n*tperiod : tstab+(n+1)*tperiod</code>)</li>
</ul>
<blockquote>
<p>We have to left-shift <code>mod(tstab, tperiod)</code>
<code>pss_fd.pss</code> in order to align it with of
<strong>pss_tb.pss</strong></p>
</blockquote>
<p><img src="/2022/06/10/isf-sampler/image-20220610222535614.png"
alt="image-20220610222535614" /></p>
<h3 id="simulation-log">simulation log</h3>
<p>The below <code>stop = 1.3 ns</code> is actual <strong>tstab</strong>
time, though <code>Stop Time(tstab)</code> field of pss form is filled
with <code>0.3n</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">**************************************************</span><br><span class="line">Periodic Steady-State Analysis `pss&#x27;: fund = 1 GHz</span><br><span class="line">**************************************************</span><br><span class="line">DC simulation time: CPU = 208 us, elapsed = 211.954 us.</span><br><span class="line"></span><br><span class="line">=============================</span><br><span class="line">`pss&#x27;: time = (0 s -&gt; 1.3 ns)</span><br><span class="line">=============================</span><br><span class="line"></span><br><span class="line">Opening the PSF file ../psf/pss.tran.pss ...</span><br><span class="line"></span><br><span class="line">Output and IC/nodeset summary:</span><br><span class="line">                 save   1       (current)</span><br><span class="line">                 save   2       (voltage)</span><br><span class="line"></span><br><span class="line">Important parameter values in tstab integration:</span><br><span class="line">    start = 0 s</span><br><span class="line">    outputstart = 0 s</span><br><span class="line">    stop = 1.3 ns</span><br><span class="line">    period = 1 ns</span><br><span class="line">    maxperiods = 20</span><br><span class="line">    step = 1.3 ps</span><br><span class="line">    maxstep = 40 ps</span><br><span class="line">    ic = all</span><br><span class="line">    useprevic = no</span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">    pss: time = 64.01 ps    (4.92 %), step = 31.63 ps     (2.43 %)</span><br><span class="line">	...</span><br><span class="line">    pss: time = 1.224 ns    (94.2 %), step = 40 ps        (3.08 %)</span><br><span class="line">    pss: time = 1.3 ns       (100 %), step = 35.99 ps     (2.77 %)</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h3 id="pss-simulation-result">PSS simulation result</h3>
<p><img src="/2022/06/10/isf-sampler/image-20220610224100135.png"
alt="image-20220610224100135" /></p>
<h3 id="align-pss_tb-and-pss_fd">Align pss_tb and pss_fd</h3>
<p><img src="/2022/06/10/isf-sampler/image-20220610225310243.png"
alt="image-20220610225310243" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">clear;</span><br><span class="line">clc;</span><br><span class="line"></span><br><span class="line">freq = <span class="number">1e9</span>;</span><br><span class="line">tstab = <span class="number">1.3e-9</span>;</span><br><span class="line">Tp  = <span class="number">1e-9</span>;</span><br><span class="line"></span><br><span class="line">load(<span class="string">&#x27;pss_td.matlab&#x27;</span>)</span><br><span class="line">t = pss_td(:, <span class="number">1</span>);</span><br><span class="line">ytd = pss_td(:, <span class="number">2</span>);</span><br><span class="line"><span class="built_in">plot</span>(t*<span class="number">1e9</span>, ytd, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">6</span>)</span><br><span class="line"><span class="built_in">hold</span> on;</span><br><span class="line"></span><br><span class="line"><span class="comment">% time domian from pss frequency domain information</span></span><br><span class="line">coff_real = <span class="number">-0.155222</span>;</span><br><span class="line">coff_imag = <span class="number">-0.0247045</span>;</span><br><span class="line">wc = <span class="number">2</span>*<span class="built_in">pi</span>*freq;</span><br><span class="line">tfd = (<span class="number">0</span>:<span class="number">1e-11</span>:<span class="number">2e-9</span>);</span><br><span class="line">yfd = coff_real*<span class="built_in">cos</span>(wc*tfd) - coff_imag*<span class="built_in">sin</span>(wc*tfd);</span><br><span class="line"><span class="built_in">plot</span>(tfd*<span class="number">1e9</span>, yfd, <span class="string">&#x27;b&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">% actual pss_td.pss one-period waveform</span></span><br><span class="line">tfd_td = (tstab:<span class="number">1e-11</span>:<span class="number">2e-9</span>);</span><br><span class="line">yfd_td = coff_real*<span class="built_in">cos</span>(wc*tfd_td) - coff_imag*<span class="built_in">sin</span>(wc*tfd_td);</span><br><span class="line"><span class="built_in">plot</span>(tfd_td*<span class="number">1e9</span>, yfd_td, <span class="string">&#x27;--b&#x27;</span>, <span class="string">&#x27;LineWidth&#x27;</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">% align pss_fd with pss_tb by left shift mod(tstab, Tp) pss_fd</span></span><br><span class="line">tshift = <span class="built_in">mod</span>(tstab, Tp);</span><br><span class="line">tfd_shift = tfd - tshift;</span><br><span class="line">tfd_shift_start_indx = <span class="built_in">find</span>(tfd_shift&gt;=<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">tfd_shift = tfd_shift(<span class="number">1</span>, tfd_shift_start_indx:<span class="keyword">end</span>);</span><br><span class="line">yfd_shift = yfd(<span class="number">1</span>, tfd_shift_start_indx:<span class="keyword">end</span>);</span><br><span class="line"><span class="built_in">plot</span>(tfd_shift*<span class="number">1e9</span>, yfd_shift, <span class="string">&#x27;-magenta&#x27;</span>, <span class="string">&#x27;LineWidth&#x27;</span>, <span class="number">2</span>)</span><br><span class="line">grid on;</span><br><span class="line"></span><br><span class="line">xlabel(<span class="string">&#x27;t (ps)&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;V(t)&#x27;</span>);</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;Using pss\_td&#x27;</span>, <span class="string">&#x27;Using pss\_fd&#x27;</span>, <span class="string">&#x27;pss\_tb one period clip&#x27;</span>, <span class="string">&#x27;Using pss\_fd with time shift&#x27;</span>, <span class="string">&#x27;location&#x27;</span>, <span class="string">&#x27;east&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h2 id="reference">reference</h2>
<p>J. Kim, B. S. Leibowitz and M. Jeeradit, "Impulse sensitivity
function analysis of periodic circuits," 2008 IEEE/ACM International
Conference on Computer-Aided Design, 2008, pp. 386-391, doi:
10.1109/ICCAD.2008.4681602.</p>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/06/09/esd-protection/" rel="prev" title="ESD and Protection">
                  <i class="fa fa-angle-left"></i> ESD and Protection
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/06/21/sv-iff/" rel="next" title="SystemVerilog iff">
                  SystemVerilog iff <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Guo</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.1/dist/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdn.jsdelivr.net/npm/pdfobject@2.3.0/pdfobject.min.js","integrity":"sha256-JJZNsid68vnh3/zyj0lY9BN5ynxVX/12XgOa1TlaYN0="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js"></script>






  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
