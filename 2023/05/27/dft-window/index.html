<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.0.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.2/css/all.min.css" integrity="sha256-CTSx/A06dm1B063156EVh15m6Y67pAjZZaQc89LLSrU=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.18.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="leakage: ​ The component at one frequency leaks into the vicinity of another compnent owing to the spectral smearing introdued by window.  Notice side lobes adding out of phase can reduce the heights">
<meta property="og:type" content="article">
<meta property="og:title" content="Windowing Technique for Accurate DFT">
<meta property="og:url" content="http://example.com/2023/05/27/dft-window/index.html">
<meta property="og:site_name" content="KNOW-HOW">
<meta property="og:description" content="leakage: ​ The component at one frequency leaks into the vicinity of another compnent owing to the spectral smearing introdued by window.  Notice side lobes adding out of phase can reduce the heights">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2023/05/27/dft-window/sharpTransient.png">
<meta property="og:image" content="http://example.com/2023/05/27/dft-window/windowedsignal.png">
<meta property="og:image" content="http://example.com/2023/05/27/dft-window/captured-periodic.png">
<meta property="og:image" content="http://example.com/2023/05/27/dft-window/captured-nonperiodic.png">
<meta property="og:image" content="http://example.com/2023/05/27/dft-window/leakage-vs-nonleakage.png">
<meta property="og:image" content="http://example.com/2023/05/27/dft-window/rtaImage.png">
<meta property="og:image" content="http://example.com/2023/05/27/dft-window/hanning-periodicsignal.png">
<meta property="og:image" content="http://example.com/2023/05/27/dft-window/hanning-nonperiodicsignal.png">
<meta property="og:image" content="http://example.com/2023/05/27/dft-window/rms-cal.png">
<meta property="og:image" content="http://example.com/2023/05/27/dft-window/flattop-amplitude.png">
<meta property="og:image" content="http://example.com/2023/05/27/dft-window/flattop-leakage.png">
<meta property="og:image" content="http://example.com/2023/05/27/dft-window/flattop-2tone.png">
<meta property="og:image" content="http://example.com/2023/05/27/dft-window/uniformwindow.png">
<meta property="og:image" content="http://example.com/2023/05/27/dft-window/rms-windowed.png">
<meta property="og:image" content="http://example.com/2023/05/27/dft-window/windowed-2tone.png">
<meta property="og:image" content="http://example.com/2023/05/27/dft-window/image-20230526005823613.png">
<meta property="og:image" content="http://example.com/2023/05/27/dft-window/image-20230526005934411.png">
<meta property="og:image" content="http://example.com/2023/05/27/dft-window/image-20230526010047826.png">
<meta property="article:published_time" content="2023-05-27T10:58:53.000Z">
<meta property="article:modified_time" content="2023-11-08T08:53:26.846Z">
<meta property="article:author" content="Guo">
<meta property="article:tag" content="signal">
<meta property="article:tag" content="dft">
<meta property="article:tag" content="windowing">
<meta property="article:tag" content="leakage">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2023/05/27/dft-window/sharpTransient.png">


<link rel="canonical" href="http://example.com/2023/05/27/dft-window/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://example.com/2023/05/27/dft-window/","path":"2023/05/27/dft-window/","title":"Windowing Technique for Accurate DFT"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Windowing Technique for Accurate DFT | KNOW-HOW</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">KNOW-HOW</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#windowed-signal"><span class="nav-number">1.</span> <span class="nav-text">Windowed Signal</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#periodic-versus-non-periodic-background"><span class="nav-number">2.</span> <span class="nav-text">Periodic versus
Non-Periodic Background</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#periodic"><span class="nav-number">2.1.</span> <span class="nav-text">Periodic</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#non-periodic"><span class="nav-number">2.2.</span> <span class="nav-text">Non-periodic</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hanning"><span class="nav-number">3.</span> <span class="nav-text">Hanning</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#periodic-signal"><span class="nav-number">3.1.</span> <span class="nav-text">periodic signal</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#non-periodic-signal"><span class="nav-number">3.2.</span> <span class="nav-text">non-periodic signal</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rms-calculation"><span class="nav-number">3.3.</span> <span class="nav-text">RMS calculation</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#flattop"><span class="nav-number">4.</span> <span class="nav-text">Flattop</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#amplitude-errors"><span class="nav-number">4.1.</span> <span class="nav-text">amplitude errors</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#leakage"><span class="nav-number">4.2.</span> <span class="nav-text">leakage</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#uniform"><span class="nav-number">5.</span> <span class="nav-text">Uniform</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#benefit-of-reducing-leakage"><span class="nav-number">6.</span> <span class="nav-text">Benefit of Reducing Leakage</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#two-tones"><span class="nav-number">6.1.</span> <span class="nav-text">Two tones</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#the-window-function-in-the-frequency-domain"><span class="nav-number">7.</span> <span class="nav-text">The window function
in the frequency domain</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#properties-of-the-windows"><span class="nav-number">8.</span> <span class="nav-text">Properties of the Windows</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#demo"><span class="nav-number">9.</span> <span class="nav-text">Demo</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#reference"><span class="nav-number">10.</span> <span class="nav-text">reference</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Guo</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">180</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">153</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/raytroop" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;raytroop" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:raytroop@gmail.com" title="E-Mail → mailto:raytroop@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/05/27/dft-window/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Windowing Technique for Accurate DFT | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Windowing Technique for Accurate DFT
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-05-27 10:58:53" itemprop="dateCreated datePublished" datetime="2023-05-27T10:58:53+00:00">2023-05-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-11-08 08:53:26" itemprop="dateModified" datetime="2023-11-08T08:53:26+00:00">2023-11-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/dsp/" itemprop="url" rel="index"><span itemprop="name">dsp</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p><strong>leakage</strong>:</p>
<p>​ The component at one frequency leaks into the vicinity of another
compnent owing to the spectral smearing introdued by
<em>window</em>.</p>
<blockquote>
<p>Notice side lobes <em>adding out of phase</em> can <em>reduce</em>
the heights of the peaks</p>
</blockquote>
<h2 id="windowed-signal">Windowed Signal</h2>
<p>Short transient signals in the time domain produce high, broadband
frequency content.</p>
<p><img src="/2023/05/27/dft-window/sharpTransient.png"
alt="sharpTransient" /></p>
<p>To reduce leakage, a mathematical function called a
<strong>window</strong> is applied to the data. Windows are designed to
<em>reduce the sharp transient</em> in the re-created signal as much as
possible.</p>
<p><img src="/2023/05/27/dft-window/windowedsignal.png"
alt="windowedsignal" /></p>
<p>Because the sharp transients are reduced and smoothed, the broadband
frequency of the spectral leakage is also reduced.</p>
<h2 id="periodic-versus-non-periodic-background">Periodic versus
Non-Periodic Background</h2>
<p>When performing a Fourier Transform on measurement data, a window
affects periodic and non-periodic data differently:</p>
<ul>
<li><p><strong>Periodic (No Window needed)</strong>: A signal captured
in a periodic manner does not require a window, and a resulting Fourier
Transform has no leakage. Applying a window alters the resulting Fourier
transform, and even creates spectral leakage where there would have been
no leakage otherwise.</p></li>
<li><p><strong>Non-periodic (Window needed)</strong>: Windows are used
on signals that are captured in a non-periodic manner to reduce spectral
leakage and get closer to the periodic results. A window can minimize
the leakage present in a non-periodic signal, but cannot eliminate
it.</p></li>
</ul>
<blockquote>
<p>The signal is repeated and appended mathematically because the
measured data is assumed to be representative of the entire original
signal</p>
</blockquote>
<h3 id="periodic">Periodic</h3>
<p>When a measurement signal is captured in a periodic manner, the
Fourier Transform of the captured signal will have <strong>no
leakage</strong> in the frequency domain.</p>
<p>A window is not recommended for a periodic signal as it will distort
the signal in an unnecessary manner, and actually creates spectral
leakage.</p>
<p><img src="/2023/05/27/dft-window/captured-periodic.png"
alt="captured-periodic" /></p>
<h3 id="non-periodic">Non-periodic</h3>
<p>The same sine wave, with a different measurement time, results in a
non-periodic captured signal. Here, when the captured signal is
repeated, the original sine wave signal is not re-created.</p>
<p><img src="/2023/05/27/dft-window/captured-nonperiodic.png"
alt="captured-nonperiodic" /></p>
<p>In fact, several broadband transient events (circled in red) are
introduced. These transients create a broadband response, or
<strong>leakage</strong>.</p>
<p><strong>Windows</strong> are used to minimize this leakage effect in
the frequency domain.</p>
<p><img src="/2023/05/27/dft-window/leakage-vs-nonleakage.png"
alt="leakage-vs-nonleakage" /></p>
<h2 id="hanning">Hanning</h2>
<p>When doing operational noise and vibration measurements, the Hanning
window is commonly used.</p>
<p>Random data has spectral leakage due to the <em>abrupt cutoff</em> at
the beginning and end of the time block. It is
<em>non-periodic</em>.</p>
<p>There is <strong>no</strong> way to ensure that the captured random
signal is periodic by varying the measurement time.</p>
<p><strong>Hanning windows</strong> are often used with random data
because they have moderate impact on the frequency resolution and
amplitude accuracy of the resulting frequency spectrum.</p>
<ul>
<li><p>The maximum <em>amplitude error</em> of a Hanning window is
<em>15%</em></p>
<blockquote>
<p>In the cited article, all spectral data <em>had an amplitude
correction factor applied</em>.</p>
</blockquote></li>
<li><p>while the frequency leakage is typically confined to <em>1.5
spectral lines</em> to each side of the original sine wave
signal</p></li>
</ul>
<p><img src="/2023/05/27/dft-window/rtaImage.png"
alt="hanning.png" /></p>
<h3 id="periodic-signal">periodic signal</h3>
<p>Applying the Hanning window (or any window) to a periodic signal
creates <strong>leakage</strong>.</p>
<p><img src="/2023/05/27/dft-window/hanning-periodicsignal.png"
alt="hanning-periodicsignal" /></p>
<blockquote>
<p>The <em>periodically captured</em> sine wave with the Hanning window
(blue) is <em>wider</em> in frequency than the original signal (red)</p>
</blockquote>
<p>In the figure, the sine wave with the Hanning window (blue) is
<em>wider</em> in frequency than the original signal (red).</p>
<h3 id="non-periodic-signal">non-periodic signal</h3>
<p>When a Hanning window is applied to a non-periodic signal, the
leakage is greatly reduced and the amplitude is higher.</p>
<p><img src="/2023/05/27/dft-window/hanning-nonperiodicsignal.png"
alt="hanning-nonperiodicsignal" /></p>
<blockquote>
<p>A <em>non-periodically captured</em> sine wave (magenta) has a
spectral leakage over the entire bandwidth, applying a Hanning window
minimized the leakage (green)</p>
</blockquote>
<h3 id="rms-calculation">RMS calculation</h3>
<p>A <em>RMS calculation</em> <strong>sums up the energy within a
frequency range</strong>.</p>
<p><img src="/2023/05/27/dft-window/rms-cal.png" alt="rms-cal" /></p>
<ul>
<li><p>both the RMS of the periodic and non-periodic signals with a
Hanning window are equal to the RMS of the leakage-free sine
wave.</p></li>
<li><p>Only the RMS of the non-periodic sine wave without a window
applied is not equal to the others</p></li>
</ul>
<blockquote>
<p>With the leakage spread over a smaller frequency range, doing
analysis calculations like <em>RMS</em> yields more accurate
results.</p>
</blockquote>
<h2 id="flattop">Flattop</h2>
<ul>
<li><p>The Flattop window has a <em>better amplitude accuracy</em> in
frequency domain compared to the Hanning window,</p>
<blockquote>
<p>The maximum amplitude error of a Flattop window is <em>less than
0.01%</em>. By contrast, the Hanning window maximum amplitude error is
15%.</p>
</blockquote></li>
<li><p>A Flattop window confines leakage to <em>3.43 spectral lines</em>
to each side of the original signal.</p></li>
</ul>
<h3 id="amplitude-errors">amplitude errors</h3>
<p>These maximum amplitude errors assume that <em>amplitude correction
factors are applied to the frequency spectrums</em>. These amplitude
correction factors compensate for any reduction caused by applying a
window.</p>
<p><img src="/2023/05/27/dft-window/flattop-amplitude.png"
alt="flattop-amplitude" /></p>
<h3 id="leakage">leakage</h3>
<p>The frequency accuracy of the Flattop window is more coarse compared
to a Hanning window. As a result, the Flattop window is typically
employed on data where frequency peaks are distinct and well separated
from each other.</p>
<p><img src="/2023/05/27/dft-window/flattop-leakage.png"
alt="flattop-leakage" /></p>
<p>When the frequency peaks are not guaranteed to be well separated, the
Hanning window is preferred because it is less likely to cause
individual peaks to be lost in the spectrum</p>
<p><img src="/2023/05/27/dft-window/flattop-2tone.png"
alt="flattop-2tone" /></p>
<p>Spectrum of two periodically captured tones that are <span
class="math inline">\(4Hz\)</span> apart with a <span
class="math inline">\(1Hz\)</span> frequency resolution. The spectrum
with a Hanning window (green) shows two peaks while the spectrum with a
Flattop window (blue) shows one peak.</p>
<blockquote>
<p>Note that at the original frequencies of the tones the amplitude is
correct and equal to one for both windows.</p>
</blockquote>
<blockquote>
<p>One common application for a flattop window is performing
<em>calibration</em>. For example, a sound pistonphone only produces
<em>one single</em> and <em>distinct frequency</em> during microphone
calibration.</p>
</blockquote>
<h2 id="uniform">Uniform</h2>
<p>A Uniform window has a value of <em>1.0</em> across the entire
measurement time. In reality, a <strong>Uniform window</strong> could be
called <strong>no window</strong>.</p>
<blockquote>
<p>Depending on the data acquisition system used, sometimes the term
<strong>Rectangular</strong> window is also used.</p>
</blockquote>
<ul>
<li><p>A Uniform window creates no frequency or amplitude distortion
when the measured signal is periodic.</p></li>
<li><p>When a measured signal is not periodic, the amplitude is reduced
by a maximum of <em>36%</em> and the frequency content is spread over
the <em>entire bandwidth of the measurement</em>.</p>
<blockquote>
<p>This is due to <em>sharp transients</em> that are created by
repeating and appending the measured signal.</p>
</blockquote></li>
</ul>
<blockquote>
<p>Whenever a measurement signal is periodic, a Uniform window is
preferred.</p>
<p>Applying a Hanning or Flattop window to a periodic signal will
actually create amplitude and frequency distortion.</p>
</blockquote>
<p><img src="/2023/05/27/dft-window/uniformwindow.png"
alt="uniformwindow" /></p>
<h2 id="benefit-of-reducing-leakage">Benefit of Reducing Leakage</h2>
<p>The benefit is <strong>not</strong> that the captured signal is
perfectly replicated.</p>
<p><strong>The main benefit is that the leakage is now confined over a
smaller frequency range</strong>, instead of affecting the entire
frequency bandwidth of the measurement.</p>
<blockquote>
<p>With the leakage spread over a smaller frequency range, doing
analysis calculations like RMS yields more accurate results.</p>
</blockquote>
<p><img src="/2023/05/27/dft-window/rms-windowed.png"
alt="rms-windowed" /></p>
<p>It is impossible to calculate the proper RMS amplitude estimate over
a limited frequency range of the <em>un-windowed sine wave</em>, since
the leakage is <em>over the full frequency range</em>. Therefore the RMS
amplitude is not correct.</p>
<h3 id="two-tones">Two tones</h3>
<p>In the case of two closely spaced sine tones, without a window being
applied, two tones frequencies would leak into each other, which make
determining the true amplitude of individual peaks very difficult.</p>
<p>The window makes it easier to separate and distinguish each tone so a
proper analysis could be performed.</p>
<p><img src="/2023/05/27/dft-window/windowed-2tone.png"
alt="windowed-2tone" /></p>
<h2 id="the-window-function-in-the-frequency-domain">The window function
in the frequency domain</h2>
<p>The transfer function <span class="math inline">\(a(f)\)</span> of a
window <span class="math inline">\(w_j, j \in [0, N-1]\)</span>
expresses the response of the window to a sinusoidal signal at an offset
of <span class="math inline">\(f\)</span> frequency bins, i.e. DFT .</p>
<p><strong>real part:</strong> <span class="math display">\[
a_r(f)=\sum_{j=0}^{N-1}w_j\cos (2\pi f j/N)
\]</span></p>
<p><strong>imaginary part:</strong> <span class="math display">\[
a_i(f)=\sum_{j=0}^{N-1}w_j\sin (2\pi f j/N)
\]</span></p>
<p>frequency response can be obtained as <span class="math display">\[
a(f) = \frac{\sqrt{a_r^2+a_i^2}}{S_1}
\]</span> where <span class="math inline">\(S_1 = \sum
_{k=0}^{N-1}w_k\)</span></p>
<h2 id="properties-of-the-windows">Properties of the Windows</h2>
<p>There is <strong>no</strong> possibility of trade-off between
<em>main-lobe width</em> and <em>sied-lobe amplitude</em>, since the
<em>window length</em> is the only variable parameter.</p>
<blockquote>
<p>The rectangular window has the narrowest main lobe for a given
length, i.e. <span class="math inline">\(\Delta
_{ml}=4\pi/L\)</span></p>
<p>Other windows include the Bartlett, Hann, and Hamming windows. The
DTFTs of all these windows have main-lobe width <span
class="math inline">\(\Delta _{ml}=8\pi/(L-1)\)</span>, which is
approximately twice that of the rectangular window, but they have
significantly smaller side-lobe amplitudes.</p>
</blockquote>
<h2 id="demo">Demo</h2>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">clc;</span><br><span class="line">clear all;</span><br><span class="line"></span><br><span class="line">N = <span class="number">512</span>;</span><br><span class="line">fs = <span class="number">40</span>*<span class="number">1e3</span>; <span class="comment">% 40kHz</span></span><br><span class="line">fres = fs/N; <span class="comment">% 78.125</span></span><br><span class="line">tt = (<span class="number">0</span>:N<span class="number">-1</span>)*<span class="number">1</span>/fs;</span><br><span class="line">ff = (<span class="number">0</span>:N/<span class="number">2</span>)*fres;</span><br><span class="line">fin = <span class="number">390.625</span>;</span><br><span class="line"></span><br><span class="line">whan = hanning(N); <span class="comment">% hanning window</span></span><br><span class="line">wrect = rectwin(N); <span class="comment">% rect window</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">% fin/fs = 5/N, periodically captured sine wave</span></span><br><span class="line">wv = <span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>*fin*tt);</span><br><span class="line">power = periodogram(wv, whan, N, fs, <span class="string">&#x27;power&#x27;</span>);</span><br><span class="line">X = (power).^<span class="number">0.5</span>*<span class="number">2</span>^<span class="number">0.5</span>;</span><br><span class="line">psd = periodogram(wv, whan, N, fs, <span class="string">&#x27;psd&#x27;</span>);</span><br><span class="line">rms = sum(psd*fres)^<span class="number">0.5</span>;</span><br><span class="line">fprintf(<span class="string">&#x27;RMS@periodic &amp; hanning: %.5f\n&#x27;</span>, rms);</span><br><span class="line"></span><br><span class="line">power_rect = periodogram(wv, wrect, N, fs, <span class="string">&#x27;power&#x27;</span>);</span><br><span class="line">X_rect = (power_rect).^<span class="number">0.5</span>*<span class="number">2</span>^<span class="number">0.5</span>;</span><br><span class="line">psd_rect = periodogram(wv, wrect, N, fs, <span class="string">&#x27;psd&#x27;</span>);</span><br><span class="line">rms_rect = sum(psd_rect*fres)^<span class="number">0.5</span>;</span><br><span class="line">fprintf(<span class="string">&#x27;RMS@periodic &amp; rect: %.5f\n&#x27;</span>, rms_rect);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">plot</span>(ff, X, <span class="string">&#x27;r-o&#x27;</span>, ff, X_rect, <span class="string">&#x27;b-s&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;Frequency(Hz)&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;|X|&#x27;</span>)</span><br><span class="line">title(<span class="string">&#x27;Amplitude spectrum of periodically captured sine wave&#x27;</span>);</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;w/ hanning&#x27;</span>, <span class="string">&#x27;w/ rect&#x27;</span>);</span><br><span class="line">grid on</span><br><span class="line">grid minor</span><br><span class="line"><span class="comment">% rectangular window provide higher frequency resolution</span></span><br><span class="line"><span class="comment">% hanning window induce leakage for the periodically captured sine wave</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">% fin - 0.5fres</span></span><br><span class="line">fin_lkg0d5 = fin - <span class="number">0.5</span>*fres;</span><br><span class="line">wv_lkg0d5 = <span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>*fin_lkg0d5*tt);</span><br><span class="line">power_lkg0d5 = periodogram(wv_lkg0d5, whan, N, fs, <span class="string">&#x27;power&#x27;</span>);</span><br><span class="line">X_lkg0d5 = (power_lkg0d5).^<span class="number">0.5</span>*<span class="number">2</span>^<span class="number">0.5</span>;</span><br><span class="line">psd_lkg0d5 = periodogram(wv_lkg0d5, whan, N, fs, <span class="string">&#x27;psd&#x27;</span>);</span><br><span class="line">rms_lkg0d5 = sum(psd_lkg0d5*fres)^<span class="number">0.5</span>;</span><br><span class="line">fprintf(<span class="string">&#x27;RMS@-0.5fres &amp; hanning: %.5f\n&#x27;</span>, rms_lkg0d5);</span><br><span class="line"></span><br><span class="line">power_lkg0d5_rect = periodogram(wv_lkg0d5, wrect, N, fs, <span class="string">&#x27;power&#x27;</span>);</span><br><span class="line">X_lkg0d5_rect = (power_lkg0d5_rect).^<span class="number">0.5</span>*<span class="number">2</span>^<span class="number">0.5</span>;</span><br><span class="line">psd_lkg0d5_rect = periodogram(wv_lkg0d5, wrect, N, fs, <span class="string">&#x27;psd&#x27;</span>);</span><br><span class="line">rms_lkg0d5_rect = sum(psd_lkg0d5_rect*fres)^<span class="number">0.5</span>;</span><br><span class="line">fprintf(<span class="string">&#x27;RMS@-0.5fres &amp; rect: %.5f\n&#x27;</span>, rms_lkg0d5_rect);</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">plot</span>(ff, X_lkg0d5, <span class="string">&#x27;r-o&#x27;</span>, ff, X_lkg0d5_rect, <span class="string">&#x27;b-s&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;Frequency(Hz)&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;|X|&#x27;</span>)</span><br><span class="line">title(<span class="string">&#x27;Amplitude spectrum of -0.5fres&#x27;</span>);</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;w/ hanning&#x27;</span>, <span class="string">&#x27;w/ rect&#x27;</span>);</span><br><span class="line">grid on</span><br><span class="line">grid minor</span><br><span class="line"><span class="comment">% hanning reduce leakage and max amplitude error 15%</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">% fin - 0.25fres</span></span><br><span class="line">fin_lkg0d25 = fin - <span class="number">0.25</span>*fres;</span><br><span class="line">wv_lkg0d25 = <span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>*fin_lkg0d25*tt);</span><br><span class="line">power_lkg0d25 = periodogram(wv_lkg0d25, whan, N, fs, <span class="string">&#x27;power&#x27;</span>);</span><br><span class="line">X_lkg0d25 = (power_lkg0d25).^<span class="number">0.5</span>*<span class="number">2</span>^<span class="number">0.5</span>;</span><br><span class="line">psd_lkg0d25 = periodogram(wv_lkg0d25, whan, N, fs, <span class="string">&#x27;psd&#x27;</span>);</span><br><span class="line">rms_lkg0d25 = sum(psd_lkg0d25*fres)^<span class="number">0.5</span>;</span><br><span class="line">fprintf(<span class="string">&#x27;RMS@-0.25fres &amp; hanning: %.5f\n&#x27;</span>, rms_lkg0d25);</span><br><span class="line"></span><br><span class="line">power_lkg0d25_rect = periodogram(wv_lkg0d25, wrect, N, fs, <span class="string">&#x27;power&#x27;</span>);</span><br><span class="line">X_lkg0d25_rect = (power_lkg0d25_rect).^<span class="number">0.5</span>*<span class="number">2</span>^<span class="number">0.5</span>;</span><br><span class="line">psd_lkg0d25_rect = periodogram(wv_lkg0d25, wrect, N, fs, <span class="string">&#x27;psd&#x27;</span>);</span><br><span class="line">rms_lkg0d25_rect = sum(psd_lkg0d25_rect*fres)^<span class="number">0.5</span>;</span><br><span class="line">fprintf(<span class="string">&#x27;RMS@-0.25fres &amp; rect: %.5f\n&#x27;</span>, rms_lkg0d25_rect);</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">3</span>)</span><br><span class="line"><span class="built_in">plot</span>(ff, X_lkg0d25, <span class="string">&#x27;r-o&#x27;</span>, ff, X_lkg0d25_rect, <span class="string">&#x27;b-s&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;Frequency(Hz)&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;|X|&#x27;</span>)</span><br><span class="line">title(<span class="string">&#x27;Amplitude spectrum of -0.25fres&#x27;</span>);</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;w/ hanning&#x27;</span>, <span class="string">&#x27;w/ rect&#x27;</span>);</span><br><span class="line">grid on</span><br><span class="line">grid minor</span><br><span class="line"><span class="comment">% hanning reduce leakage</span></span><br></pre></td></tr></table></figure>
<p>output</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">RMS@periodic &amp; hanning: 0.70711</span><br><span class="line">RMS@periodic &amp; rect: 0.70711</span><br><span class="line">RMS@-0.5fres &amp; hanning: 0.70711</span><br><span class="line">RMS@-0.5fres &amp; rect: 0.70711</span><br><span class="line">RMS@-0.25fres &amp; hanning: 0.70711</span><br><span class="line">RMS@-0.25fres &amp; rect: 0.70780</span><br></pre></td></tr></table></figure>
<p><img src="/2023/05/27/dft-window/image-20230526005823613.png"
alt="image-20230526005823613" /></p>
<blockquote>
<p>rectangular window provide higher frequency resolution</p>
</blockquote>
<p><img src="/2023/05/27/dft-window/image-20230526005934411.png"
alt="image-20230526005934411" /></p>
<blockquote>
<p>hanning reduce leakage and max amplitude error 15%</p>
</blockquote>
<p><img src="/2023/05/27/dft-window/image-20230526010047826.png"
alt="image-20230526010047826" /></p>
<blockquote>
<p>hanning reduce leakage and reduce amplitude error</p>
</blockquote>
<h2 id="reference">reference</h2>
<p>Article (20416822) Title: How to Utilize a Windowing Technique for
Accurate DFT URL: <a
target="_blank" rel="noopener" href="https://support.cadence.com/apex/ArticleAttachmentPortal?id=a1Od000000050UrEAI">https://support.cadence.com/apex/ArticleAttachmentPortal?id=a1Od000000050UrEAI</a></p>
<p>B.P. Lathi, Roger Green. Linear Systems and Signals (The Oxford
Series in Electrical and Computer Engineering) 3rd Edition</p>
<p>Window Types: Hanning, Flattop, Uniform, Tukey, and Exponential
URL:<a
target="_blank" rel="noopener" href="https://community.sw.siemens.com/s/article/window-types-hanning-flattop-uniform-tukey-and-exponential">https://community.sw.siemens.com/s/article/window-types-hanning-flattop-uniform-tukey-and-exponential</a></p>
<p>Window Correction Factors URL:<a
target="_blank" rel="noopener" href="https://community.sw.siemens.com/s/article/window-correction-factors">https://community.sw.siemens.com/s/article/window-correction-factors</a></p>
<p>Root Mean Square (RMS) and Overall Level. URL:<a
target="_blank" rel="noopener" href="https://community.sw.siemens.com/s/article/root-mean-square-rms-and-overall-level">https://community.sw.siemens.com/s/article/root-mean-square-rms-and-overall-level</a></p>
<p>Windows and Spectral Leakage. URL:<a
target="_blank" rel="noopener" href="https://community.sw.siemens.com/s/article/windows-and-spectral-leakage">https://community.sw.siemens.com/s/article/windows-and-spectral-leakage</a></p>
<p>Alan V Oppenheim, Ronald W. Schafer. Discrete-Time Signal Processing,
3rd edition</p>
<p>Stefan Scholl, "Exact Signal Measurements using FFT
Analysis",Microelectronic Systems Design Research Group, TU
Kaiserslautern, Germany. [ <a
target="_blank" rel="noopener" href="https://kluedo.ub.rptu.de/frontdoor/deliver/index/docId/4293/file/exact_fft_measurements.pdf">pdf</a>
]</p>
<p>Harris, F. (1978). On the use of windows for harmonic analysis with
the discrete Fourier transform. Proceedings of the IEEE, 66, 51-83. [<a
target="_blank" rel="noopener" href="https://www.fceia.unr.edu.ar/prodivoz/Harris_1978.pdf">pdf</a>]</p>
<p>Equivalent noise bandwidth (ENBW) of window functions URL:<a
target="_blank" rel="noopener" href="https://www.gaussianwaves.com/2020/09/equivalent-noise-bandwidth-enbw-of-window-functions/">https://www.gaussianwaves.com/2020/09/equivalent-noise-bandwidth-enbw-of-window-functions/</a></p>
<p>Why should I zero-pad a signal before taking the Fourier transform?
URL:<a
target="_blank" rel="noopener" href="https://dsp.stackexchange.com/q/741">https://dsp.stackexchange.com/q/741</a></p>
<p>enbw function in MATLAB URL:<a
target="_blank" rel="noopener" href="https://www.mathworks.com/help/signal/ref/enbw.html">https://www.mathworks.com/help/signal/ref/enbw.html</a></p>
<p>Window function – figure of merits URL:<a
target="_blank" rel="noopener" href="https://www.gaussianwaves.com/2020/09/window-function-figure-of-merits/">https://www.gaussianwaves.com/2020/09/window-function-figure-of-merits/</a></p>
<p>Memos on FFT With Windowing URL:<a
target="_blank" rel="noopener" href="https://everynanocounts.com/2018/02/01/memos-on-fft-with-windowing/">https://everynanocounts.com/2018/02/01/memos-on-fft-with-windowing/</a></p>
<p>Jens Ahrens, "Some Notes on Windows in Spectral Analysis," Tech.
Report, Chalmers Univeristy of Technology, 2020. URL:<a
target="_blank" rel="noopener" href="https://appliedacousticschalmers.github.io/scaling-of-the-dft/notes_on_windows/">https://appliedacousticschalmers.github.io/scaling-of-the-dft/notes_on_windows/</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/signal/" rel="tag"># signal</a>
              <a href="/tags/dft/" rel="tag"># dft</a>
              <a href="/tags/windowing/" rel="tag"># windowing</a>
              <a href="/tags/leakage/" rel="tag"># leakage</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/05/21/bilinear-transformation/" rel="prev" title="Bilinear Transformation">
                  <i class="fa fa-angle-left"></i> Bilinear Transformation
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/05/27/dtft-dft/" rel="next" title="DTFT & DFT">
                  DTFT & DFT <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Guo</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.1/dist/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdn.jsdelivr.net/npm/pdfobject@2.2.12/pdfobject.min.js","integrity":"sha256-g2xji1rlE3KsGVClvuxTbcR0Kn2+wtQADSff2Tbb4zA="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js"></script>






  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
