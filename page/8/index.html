<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.1.1">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="KNOW-HOW">
<meta property="og:url" content="http://example.com/page/8/index.html">
<meta property="og:site_name" content="KNOW-HOW">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Guo">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/page/8/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/8/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>KNOW-HOW</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">KNOW-HOW</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Guo</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">164</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/raytroop" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;raytroop" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:raytroop@gmail.com" title="E-Mail → mailto:raytroop@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/07/20/pam4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/20/pam4/" class="post-title-link" itemprop="url">PAM4 Signaling</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-07-20 22:51:22" itemprop="dateCreated datePublished" datetime="2022-07-20T22:51:22+00:00">2022-07-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-08-09 09:55:04" itemprop="dateModified" datetime="2024-08-09T09:55:04+00:00">2024-08-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/analog/" itemprop="url" rel="index"><span itemprop="name">analog</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="why-pam4">Why PAM4?</h2>
<p><img src="/2022/07/20/pam4/image-20240808205451067.png"
alt="image-20240808205451067" /></p>
<p><img src="/2022/07/20/pam4/image-20240808205635598.png"
alt="image-20240808205635598" /></p>
<h2 id="bandwidth">Bandwidth</h2>
<blockquote>
<p>[How Interconnects Work: Bandwidth for Modeling and Measurements, <a
target="_blank" rel="noopener" href="https://www.simberian.com/AppNotes/HIW-Bandwidth-6to112-2021-11-08.pdf">https://www.simberian.com/AppNotes/HIW-Bandwidth-6to112-2021-11-08.pdf</a>]</p>
<p>[Moving from 28 Gbps NRZ to 56 Gbps PAM-4 - is it "free lunch"?, <a
target="_blank" rel="noopener" href="https://www.simberian.com/AppNotes/28NRZto56PAM4.pdf">https://www.simberian.com/AppNotes/28NRZto56PAM4.pdf</a>]</p>
<p>[PAM4: For Better and Worse Is PAM4 worth the hassle?<a
target="_blank" rel="noopener" href="https://www.signalintegrityjournal.com/articles/1151-pam4-for-better-and-worse">https://www.signalintegrityjournal.com/articles/1151-pam4-for-better-and-worse</a>]</p>
</blockquote>
<h2 id="pam4-basic">PAM4 Basic</h2>
<p><img src="/2022/07/20/pam4/image-20240624232935743.png"
alt="image-20240624232935743" /></p>
<p><img src="/2022/07/20/pam4/nrz-v-pam4-bits.png"
alt="PAM4, NRZ, PCIe 6.0" /></p>
<p><strong>PAM4</strong> only have <em>1/3</em> of the amplitude
compared to <strong>NRZ</strong> <span class="math display">\[
\text{SNR loss} = 20\log(\frac{1}{3}) \sim  9.5\text{dB}
\]</span></p>
<blockquote>
<p>In practice, there is further degradation due to nonlinearity</p>
</blockquote>
<p>In a more technical terms, we trade the <strong>transmitter’s
signal-to-noise ratio (SNR)</strong> for <strong>lower Nyquist
frequency</strong></p>
<p>Equalization will be a lot more complex</p>
<h3 id="energy">Energy</h3>
<p>1mW/Gbps = 1pJ/bit</p>
<h3 id="pam4-level-names">PAM4 Level Names</h3>
<p><img src="/2022/07/20/pam4/image-20220717000655620.png"
alt="image-20220717000655620" /></p>
<h3 id="pam4-eye-linearity">PAM4 Eye Linearity</h3>
<p><img src="/2022/07/20/pam4/image-20220716221740224.png"
alt="image-20220716221740224" /></p>
<p>Each level can have different amplitudes, which form the <strong>Eye
Linearity</strong> <span class="math display">\[
{\text{Eye
Linearity}}=\frac{\min(AV_{\text{upp}},AV_{\text{mid}},AV_{\text{low}})}{\max(AV_{\text{upp}},AV_{\text{mid}},AV_{\text{low}})}
\]</span></p>
<blockquote>
<p>Perfect eye = 1</p>
<p>Worst eye = 0</p>
</blockquote>
<h3 id="transmitter-linearity-rlm">Transmitter Linearity (RLM)</h3>
<p>The <strong>Level Separation Mismatch Ratio</strong>, commonly
referred to as <span class="math inline">\(R_{\text{LM}}\)</span>, is a
measurement that is not required in normative or informative VSR tests,
but is required by most other variants.</p>
<p><img src="/2022/07/20/pam4/image-20220716223452261.png"
alt="image-20220716223452261" /></p>
<p><span class="math display">\[\begin{align}
V_{\text{mid}} &amp;= \frac{V_0+V_3}{2} \\
ES1 &amp;= \frac{V_1-V_{\text{mid}}}{V_0-V_{\text{mid}}} \\
ES2 &amp;= \frac{V_2-V_{\text{mid}}}{V_3-V_{\text{mid}}} \\
R_{\text{LM}} &amp;= \min(3\times ES1, 3\times ES2, 2-3\times ES1,
2-3\times ES2)
\end{align}\]</span></p>
<p>where <em>ES</em> means <em>Effective Symbol Level</em></p>
<blockquote>
<p><span class="math inline">\(R_{\text{LM}}\)</span> is conceptually
similar to eye linearity but measured differently. An ideal PAM4 eye has
<span class="math inline">\(R_{\text{LM}}\)</span> equal to
<strong>1</strong>, but it does not scale in the same way as eye
linearity.</p>
<p>The closer <span class="math inline">\(R_{\text{LM}}\)</span> is to
<strong>1</strong>, the better the eye linearity is.</p>
</blockquote>
<h2 id="gray-coding">Gray Coding</h2>
<p>Gray code or reflected binary code was designed so that two
successive values differ by one bit</p>
<p>Reducing the number of switching</p>
<table>
<thead>
<tr class="header">
<th>Linear Code</th>
<th>Gray Code</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>11</td>
<td>10</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
</tr>
<tr class="odd">
<td>01</td>
<td>01</td>
</tr>
<tr class="even">
<td>00</td>
<td>00</td>
</tr>
</tbody>
</table>
<blockquote>
<ul>
<li>Only one bit error per symbol is made for incorrect decisions</li>
<li>This is the coding adopted in all the PAM4 standards</li>
<li>Support dual-mode with PAM2, by grounding the LSB</li>
<li>MSB is the bit transmitted first</li>
</ul>
</blockquote>
<h3 id="binary-to-pam4-and-back-to-binary-example">Binary to PAM4 and
Back to Binary Example</h3>
<p><img src="/2022/07/20/pam4/image-20220717000847185.png"
alt="image-20220717000847185" /></p>
<blockquote>
<p>The way that Gray coding combines the MSB (most significant bit) and
LSB (least significant bit) in each PAM4 symbol assures that
<strong>symbol errors</strong> caused by <strong>amplitude
noise</strong> are more likely to cause <strong>one bit error than
two</strong>. On the other hand, jitter is more likely to cause two bit
errors per symbol error.</p>
</blockquote>
<h1 id="pam4-tx-equalization">PAM4 TX equalization</h1>
<p><img src="/2022/07/20/pam4/image-20220717010007963.png"
alt="image-20220717010007963" /></p>
<p>Here, <span class="math inline">\(d_{\text{LSB}} \in \{-1,
1\}\)</span>, <span class="math inline">\(d_{\text{MSB}} \in \{-2,
2\}\)</span> and <span class="math inline">\(d&#39; \in \{ -3, -1, 1, 3
\}\)</span></p>
<p>Implementation-1 could potentially experience performance degradation
due to</p>
<ol type="1">
<li>Clock skew, <span class="math inline">\(\Delta t\)</span>, could
make the eye misaligned horizontally</li>
<li>Gain mismatch, <span class="math inline">\(\Delta G\)</span>, could
cause eye nonlinearity</li>
<li>Bandwidth mismatch, <span class="math inline">\(\Delta
f_{\text{BW}}\)</span>, could make the eye misaligned vertically</li>
</ol>
<p><img src="/2022/07/20/pam4/image-20220717011129124.png"
alt="image-20220717011129124" /></p>
<blockquote>
<p>Typically, a 3-tap FIR (pre + main + post) TX de-emphasis is used</p>
<p>3-tap FIR results in <span class="math inline">\(4^3 = 64\)</span>
possible distinct signal levels</p>
</blockquote>
<p><img src="/2022/07/20/pam4/msb_lsb.drawio.svg"
alt="msb_lsb.drawio" /></p>
<p><span class="math display">\[\begin{align}
R_U^M \parallel R_D^M &amp;= \frac{3R_T}{2}\\
R_U^L \parallel R_D^L &amp;= 3R_T
\end{align}\]</span></p>
<p>Thevenin Equivalent Circuit is <img
src="/2022/07/20/pam4/thevenin_1.drawio.svg"
alt="thevenin_1.drawio" /></p>
<p>Which can be simpified as <img
src="/2022/07/20/pam4/thevenin_2.drawio.svg" alt="thevenin_2.drawio" />
<span class="math display">\[\begin{align}
V_{\text{rx}} &amp;= \frac{1}{2}(V_p - V_m) \\
&amp;= \frac{1}{2}(\frac{2}{3}(2V_{\text{MSB}}+V_{\text{LSB}})-1) \\
&amp;=\frac{1}{3}(2V_{\text{MSB}}+V_{\text{LSB}})-\frac{1}{2}
\end{align}\]</span></p>
<p>The above eqations demonstrate that the output <span
class="math inline">\(V_{\text{rx}}\)</span> is the linear sum of
<strong>MSB</strong> and <strong>LSB</strong>; <strong>LSB</strong> and
<strong>MSB</strong> have relative weight, i.e. <em>1</em> for LSB and
<em>2</em> for MSB.</p>
<p>Assume pre cusor has <span class="math inline">\(L\)</span> legs,
main cursor <span class="math inline">\(M\)</span> legs and post cursor
<span class="math inline">\(N\)</span> legs, which is same with the
convention in "Voltage-Mode Driver Equalization"</p>
<p>The number of legs connected with supply can expressed as <span
class="math display">\[
n_{up} = (1-d_{n+1})L + d_{n}M + (1-d_{n-1})N
\]</span> Where <span class="math inline">\(d_n \in \{0, 1\}\)</span>,
or <span class="math display">\[
n_{up} = \frac{1}{2}(-D_{n+1}+1)L + \frac{1}{2}(D_{n}+1)M +
\frac{1}{2}(-D_{n-1}+1)N
\]</span> Where <span class="math inline">\(D_n \in \{-1,
+1\}\)</span></p>
<p>Then the number of legs connected with ground is <span
class="math display">\[
n_{dn}=L+M+N-n_{up}
\]</span> where <span
class="math inline">\(n_{up}+n_{dn}=L+M+N\)</span></p>
<p>Voltage resistor divider <span class="math display">\[\begin{align}
V_o &amp;=
\frac{\frac{R_{U}}{n_{dn}}}{\frac{R_U}{n_{dn}}+\frac{R_U}{n_{up}}} \\
&amp;= \frac{1}{2}- \frac{1}{2}D_{n+1}\frac{L}{L+M+N}+
\frac{1}{2}D_{n}\frac{M}{L+M+N}-\frac{1}{2}D_{n-1}\frac{N}{L+M+N} \\
&amp;= \frac{1}{2}-\frac{1}{2}D_{n+1}\cdot l+ \frac{1}{2}D_{n}\cdot
m-\frac{1}{2}D_{n-1}\cdot n
\end{align}\]</span></p>
<p>where <span class="math inline">\(l+m+n=1\)</span></p>
<p><span class="math inline">\(V_{\text{MSB}}\)</span> and <span
class="math inline">\(V_{\text{LSB}}\)</span> can be obtained</p>
<p><span class="math display">\[\begin{align}
V_{\text{MSB}} &amp;= \frac{1}{2}-\frac{1}{2}D^{\text{MSB}}_{n+1}\cdot
l+ \frac{1}{2}D^{\text{MSB}}_{n}\cdot
m-\frac{1}{2}D^{\text{MSB}}_{n-1}\cdot n \\
V_{\text{LSB}} &amp;= \frac{1}{2}-\frac{1}{2}D^{\text{LSB}}_{n+1}\cdot
l+ \frac{1}{2}D^{\text{LSB}}_{n}\cdot
m-\frac{1}{2}D^{\text{LSB}}_{n-1}\cdot n
\end{align}\]</span></p>
<p>Substitute the above equation into <span
class="math inline">\(V_{\text{rx}}\)</span>, we obtain the relationship
between driver legs and FFE coefficients</p>
<p><span class="math display">\[\begin{align}
V_{\text{rx}}
&amp;=\frac{1}{3}(2V_{\text{MSB}}+V_{\text{LSB}})-\frac{1}{2} \\
&amp;= \frac{1}{3} \left\{  2\left(
\frac{1}{2}-\frac{1}{2}D^{\text{MSB}}_{n+1}\cdot l+
\frac{1}{2}D^{\text{MSB}}_{n}\cdot m-
\frac{1}{2}D^{\text{MSB}}_{n-1}\cdot n \right) + \left(
\frac{1}{2}-\frac{1}{2}D^{\text{LSB}}_{n+1}\cdot l+
\frac{1}{2}D^{\text{LSB}}_{n}\cdot m-
\frac{1}{2}D^{\text{LSB}}_{n-1}\cdot n \right) \right\}-\frac{1}{2} \\
&amp;=  \left(-\frac{l}{6} \cdot 2 \cdot D^{\text{MSB}}_{n+1}+
\frac{m}{6} \cdot 2 \cdot D^{\text{MSB}}_{n}- \frac{n}{6} \cdot 2 \cdot
D^{\text{MSB}}_{n-1}\right) + \left(-\frac{l}{6} \cdot
D^{\text{LSB}}_{n+1}+ \frac{m}{6} \cdot D^{\text{LSB}}_{n}- \frac{n}{6}
\cdot D^{\text{LSB}}_{n-1}\right) \\
&amp;=  -\frac{l}{6}(2 \cdot D^{\text{MSB}}_{n+1}+D^{\text{LSB}}_{n+1})+
\frac{m}{6}(2\cdot D^{\text{MSB}}_{n}+D^{\text{LSB}}_{n})
-\frac{n}{6}(2\cdot D^{\text{MSB}}_{n-1}+D^{\text{LSB}}_{n-1})
\end{align}\]</span></p>
<p>After scaling, we obtain <span class="math display">\[
V_{\text{rx}}  = -l\cdot(2 \cdot
D^{\text{MSB}}_{n+1}+D^{\text{LSB}}_{n+1})+ m\cdot(2\cdot
D^{\text{MSB}}_{n}+D^{\text{LSB}}_{n}) - n \cdot(2\cdot
D^{\text{MSB}}_{n-1}+D^{\text{LSB}}_{n-1})
\]</span> Where <span class="math inline">\(C_{-1} = l\)</span>, <span
class="math inline">\(C_0 = m\)</span> and <span
class="math inline">\(C_{1}=n\)</span>, which is same with that of
NRZ.</p>
<h2 id="tx-serializer">TX Serializer</h2>
<h3 id="mux-timing">mux timing</h3>
<p><img src="/2022/07/20/pam4/mux2-1.drawio.svg"
alt="mux2-1.drawio" /></p>
<h3 id="divider-latch-timing">divider latch timing</h3>
<p><img src="/2022/07/20/pam4/div2-latch.drawio.svg"
alt="div2-latch.drawio" /></p>
<h3 id="two-latches">Two latches</h3>
<p><img src="/2022/07/20/pam4/two-latch.drawio.svg"
alt="two-latch.drawio" /></p>
<h2 id="dac-based-ffe-in-pam4-transmitter">DAC-based FFE in PAM4
Transmitter</h2>
<p><img src="/2022/07/20/pam4/image-20220721220225623.png"
alt="image-20220721220225623" /></p>
<p>One classic TX implementation contain:</p>
<ul>
<li>a DAC: <strong>56GS/s</strong> <strong>8b</strong></li>
<li>a DSP: <strong>8-tap FIR</strong></li>
</ul>
<blockquote>
<p>C. Menolfi et al., "A 112Gb/S 2.6pJ/b 8-Tap FFE PAM-4 SST TX in 14nm
CMOS," 2018 IEEE International Solid - State Circuits Conference -
(ISSCC), 2018, pp. 104-106, doi: 10.1109/ISSCC.2018.8310205.</p>
</blockquote>
<p><img src="/2022/07/20/pam4/image-20220721234522043.png"
alt="image-20220721234522043" /></p>
<h3 id="pi-coil"><span class="math inline">\(\pi\)</span>-coil</h3>
<p><img src="/2022/07/20/pam4/image-20220720232837839.png"
alt="image-20220720232837839" /></p>
<blockquote>
<p>J. Kim et al., "A 112Gb/s PAM-4 transmitter with 3-Tap FFE in 10nm
CMOS," 2018 IEEE International Solid - State Circuits Conference -
(ISSCC), 2018, pp. 102-104, doi: 10.1109/ISSCC.2018.8310204.</p>
</blockquote>
<h2 id="reference">reference</h2>
<p>C. Menolfi et al., "A 112Gb/S 2.6pJ/b 8-Tap FFE PAM-4 SST TX in 14nm
CMOS," 2018 IEEE International Solid - State Circuits Conference -
(ISSCC), 2018, pp. 104-106, doi: 10.1109/ISSCC.2018.8310205.</p>
<p>E. Chong et al., "A 112Gb/s PAM-4, 168Gb/s PAM-8 7bit DAC-Based
Transmitter in 7nm FinFET," ESSCIRC 2021 - IEEE 47th European Solid
State Circuits Conference (ESSCIRC), 2021, pp. 523-526, doi:
10.1109/ESSCIRC53450.2021.9567801.</p>
<p>B. Razavi, "Design Techniques for High-Speed Wireline Transmitters,"
in IEEE Open Journal of the Solid-State Circuits Society, vol. 1, pp.
53-66, 2021, doi: 10.1109/OJSSCS.2021.3112398.</p>
<p>Wang, Z., Choi, M., Lee, K., Park, K., Liu, Z., Biswas, A., Han, J.,
Du, S., &amp; Alon, E. (2022). An Output Bandwidth Optimized 200-Gb/s
PAM-4 100-Gb/s NRZ Transmitter With 5-Tap FFE in 28-nm CMOS. IEEE
Journal of Solid-State Circuits, 57(1), 21-31.
https://doi.org/10.1109/JSSC.2021.3109562</p>
<p>J. Kim et al., "A 112Gb/s PAM-4 transmitter with 3-Tap FFE in 10nm
CMOS," 2018 IEEE International Solid - State Circuits Conference -
(ISSCC), 2018, pp. 102-104, doi: 10.1109/ISSCC.2018.8310204.</p>
<p>PCIe® 6.0 Specification: The Interconnect for I/O Needs of the Future
PCI-SIG® Educational Webinar Series, [<a
target="_blank" rel="noopener" href="https://pcisig.com/sites/default/files/files/PCIe%206.0%20Webinar_Final_.pdf">https://pcisig.com/sites/default/files/files/PCIe%206.0%20Webinar_Final_.pdf</a>]</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/07/09/vm-drv-eq/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/09/vm-drv-eq/" class="post-title-link" itemprop="url">Voltage-Mode Driver Equalization</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-07-09 09:48:47" itemprop="dateCreated datePublished" datetime="2022-07-09T09:48:47+00:00">2022-07-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-08-09 09:55:04" itemprop="dateModified" datetime="2024-08-09T09:55:04+00:00">2024-08-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/analog/" itemprop="url" rel="index"><span itemprop="name">analog</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="sst-driver">SST Driver</h2>
<h3 id="sharing-termination-in-sst-transmitter">sharing termination in
SST transmitter</h3>
<p><img src="/2022/07/09/vm-drv-eq/tx_leg.drawio.svg"
alt="tx_leg.drawio" /></p>
<p>Sharing termination keep a constant current through leg, which
improve TX speed in this way. On the other hand, the sharing termination
facilitate drain/source sharing technique in layout.</p>
<h3 id="pull-up-and-pull-down-resistor">pull-up and pull-down
resistor</h3>
<p><img src="/2022/07/09/vm-drv-eq/sst-evolution.png"
alt="sst-evolution" /></p>
<p><strong>Original stacked structure</strong></p>
<p>Pro's:</p>
<p>​ smaller static current when both pull up and pull down path is
on</p>
<p>Con's:</p>
<p>​ slowly switching due to parasitic capacitance behind pull-up and
pull-down resistor</p>
<p><strong>with single shared linearization resistor</strong></p>
<p>Pro's:</p>
<p>​ The parasitic capacitance behind the resistor still exists but is
now always driven high or low actively</p>
<p>Con's:</p>
<p>​ more static current</p>
<h2 id="vm-driver-equalization---differential-ended-termination">VM
Driver Equalization - differential ended termination</h2>
<p><span class="math display">\[
V_o = D_{n+1}C_{-1}+D_nC_0+D_{n-1}C_{+1}
\]</span></p>
<p>where <span class="math inline">\(D_n \in \{-1, 1\}\)</span></p>
<p><img src="/2022/07/09/vm-drv-eq/vdrv.drawio.svg" alt="vdrv.drawio" />
<span class="math display">\[
V_{\text{rx}} = V_{\text{dd}} \frac{(R_2-R_1)R_T}{R_1R_T+R_2R_T+R_1R_2}
\]</span> With <span class="math inline">\(R_u=(L+M+N)R_T\)</span></p>
<p>Normalize above equation, obtain <span class="math display">\[
V_{\text{rx,norm}} = \frac{(R_2-R_1)R_T}{R_1R_T+R_2R_T+R_1R_2}
\]</span></p>
<table>
<thead>
<tr class="header">
<th></th>
<th><span class="math inline">\(D_{n-1}\)</span></th>
<th><span class="math inline">\(D_{n}\)</span></th>
<th><span class="math inline">\(D_{n+1}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(C_{-1}\)</span></td>
<td>1</td>
<td>-1</td>
<td>-1</td>
</tr>
<tr class="even">
<td><span class="math inline">\(C_0\)</span></td>
<td>-1</td>
<td>1</td>
<td>-1</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(C_{+1}\)</span></td>
<td>-1</td>
<td>-1</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Where precursor <span class="math inline">\(R_L = L\times
R_T\)</span>, main cursor <span class="math inline">\(R_M = M\times
R_T\)</span> and post cursor <span class="math inline">\(R_N = N\times
R_T\)</span></p>
<p><img src="/2022/07/09/vm-drv-eq/image-20220709151054840.png"
alt="image-20220709151054840" /></p>
<h3 id="equation-1">Equation-1</h3>
<blockquote>
<p><span class="math inline">\(D_{n-1}D_nD_{n+1}=1,-1,-1\)</span></p>
</blockquote>
<p><img src="/2022/07/09/vm-drv-eq/pre.drawio.svg"
alt="pre.drawio" /></p>
<p><span class="math display">\[\begin{align}
R_1 &amp;= R_N \\
&amp;= \frac{R_u}{N} \\
R_2 &amp;= R_L\parallel R_M \\
&amp;= \frac{R_u}{L+M}
\end{align}\]</span></p>
<p>We obtain <span class="math display">\[
V_{L}= \frac{1}{2}\cdot\frac{N-(L+M)}{L+M+N}
\]</span></p>
<h3 id="equation-2">Equation-2</h3>
<blockquote>
<p><span class="math inline">\(D_{n-1}D_nD_{n+1}=-1,1,-1\)</span></p>
</blockquote>
<p><img src="/2022/07/09/vm-drv-eq/main.drawio.svg"
alt="main.drawio" /></p>
<p>with <span class="math inline">\(R_1=R_T\)</span> and <span
class="math inline">\(R_2=+\infty\)</span>, we obtain <span
class="math display">\[
V_M = \frac{1}{2}
\]</span></p>
<h3 id="equation-3">Equation-3</h3>
<blockquote>
<p><span class="math inline">\(D_{n-1}D_nD_{n+1}=-1,-1,1\)</span></p>
</blockquote>
<p><span class="math display">\[\begin{align}
R_1 &amp;= R_L \\
&amp;= \frac{R_u}{L} \\
R_2 &amp;= R_N\parallel R_M \\
&amp;= \frac{R_u}{N+M}
\end{align}\]</span></p>
<p>We obtain <span class="math display">\[
V_N = \frac{1}{2}\cdot\frac{L-(N+M)}{L+M+N}
\]</span></p>
<h3 id="obtain-fir-coefficients">Obtain FIR coefficients</h3>
<p>We define <span class="math display">\[\begin{align}
l &amp;= \frac{L}{L+M+N} \\
m &amp;= \frac{M}{L+M+N} \\
n &amp;= \frac{N}{L+M+N}
\end{align}\]</span></p>
<p>where <span class="math inline">\(l+m+n=1\)</span></p>
<p>Due to Eq1 ~ Eq3 <span class="math display">\[
\left\{ \begin{array}{cl}
C_{-1}-C_0-C_1 &amp; = \frac{1}{2}(n-l-m) \\
-C_{-1}+C_0-C_1 &amp; = \frac{1}{2} \\
-C_{-1}-C_0+C_1 &amp; = \frac{1}{2}(l-n-m)
\end{array} \right.
\]</span> After scaling, we get <span class="math display">\[
\left\{ \begin{array}{cl}
C_{-1}-C_0-C_1 &amp; = -l-m+n \\
-C_{-1}+C_0-C_1 &amp; = l+m+n \\
-C_{-1}-C_0+C_1 &amp; = l-m-n
\end{array} \right.
\]</span> Then, <strong>the relationship between FIR coefficients and
legs is clear</strong>, i.e. <span class="math display">\[\begin{align}
C_{-1} &amp;= -\frac{L}{L+M+N} \\
C_{0} &amp;= \frac{M}{L+M+N} \\
C_{1} &amp;= -\frac{N}{L+M+N}
\end{align}\]</span></p>
<p>For example, <span class="math inline">\(C_{-1}=-0.1\)</span>, <span
class="math inline">\(C_0=0.7\)</span> and <span
class="math inline">\(C_1=-0.2\)</span> <span class="math display">\[
H(z) = -0.1+0.7z^{-1}-0.2z^{-2}
\]</span> <img src="/2022/07/09/vm-drv-eq/image-20220709185832444.png"
alt="image-20220709185832444" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">w = [<span class="number">-0.1</span>, <span class="number">0.7</span>, <span class="number">-0.2</span>];</span><br><span class="line">Fs = <span class="number">32e9</span>;</span><br><span class="line">[mag, w] = freqz(w, <span class="number">1</span>, [], Fs);</span><br><span class="line"><span class="built_in">plot</span>(w/<span class="number">1e9</span>, <span class="built_in">abs</span>(mag));</span><br><span class="line">xlabel(<span class="string">&#x27;Freq(GHz)&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;mag&#x27;</span>);</span><br><span class="line">grid on;</span><br></pre></td></tr></table></figure>
<h2 id="vm-driver-equalization---single-ended-termination">VM Driver
Equalization - single ended termination</h2>
<h3 id="equation-1-1">Equation-1</h3>
<p><img src="/2022/07/09/vm-drv-eq/pre_se.drawio.svg"
alt="pre_se.drawio" /></p>
<p><span class="math display">\[\begin{align}
V_{\text{rxp}} &amp;= \frac{1}{2} \cdot \frac{N}{L+M+N} \\
V_{\text{rxm}} &amp;= \frac{1}{2} \cdot \frac{L+M}{L+M+N}
\end{align}\]</span> So <span class="math display">\[
V_{L}= \frac{1}{2}\cdot\frac{N-(L+M)}{L+M+N}
\]</span> which is same with differential ended termination</p>
<h3 id="equation-2-1">Equation-2</h3>
<p><img src="/2022/07/09/vm-drv-eq/main_se.drawio.svg"
alt="main_se.drawio" /></p>
<p><span class="math display">\[\begin{align}
V_{\text{rxp}} &amp;= \frac{1}{2} \\
V_{\text{rxm}} &amp;= 0
\end{align}\]</span> So <span class="math display">\[
V_{M}= \frac{1}{2}
\]</span> which is same with differential ended termination</p>
<h3 id="equation-3-1">Equation-3</h3>
<p><span class="math display">\[
V_{N}= \frac{1}{2}\cdot\frac{L-(N+M)}{L+M+N}
\]</span></p>
<h3 id="obtain-fir-coefficients-1">Obtain FIR coefficients</h3>
<p>Same with differential ended termination driver.</p>
<h2 id="basic-feed-forward-equalization-theory">Basic Feed Forward
Equalization Theory</h2>
<p><img src="/2022/07/09/vm-drv-eq/image-20220709111229772.png"
alt="image-20220709111229772" /></p>
<p><img src="/2022/07/09/vm-drv-eq/image-20220709112543338.png"
alt="image-20220709112543338" /></p>
<p><img src="/2022/07/09/vm-drv-eq/image-20220709125046329.png"
alt="image-20220709125046329" /></p>
<blockquote>
<p>Pre-cursor FFE can compensate phase distortion through the
channel</p>
</blockquote>
<p><img src="/2022/07/09/vm-drv-eq/image-20220709130050057.png"
alt="image-20220709130050057" /></p>
<blockquote>
<p>Single-ended termination</p>
<p>Differential termination</p>
</blockquote>
<h2 id="reference">reference</h2>
<p>J. F. Bulzacchelli et al., "A 28-Gb/s 4-Tap FFE/15-Tap DFE Serial
Link Transceiver in 32-nm SOI CMOS Technology," in IEEE Journal of
Solid-State Circuits, vol. 47, no. 12, pp. 3232-3248, Dec. 2012, doi:
10.1109/JSSC.2012.2216414.</p>
<p>Jhwan Kim, CICC 2022, ES4-4: Transmitter Design for High-speed Serial
Data Communications</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/07/01/channel-termination/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/01/channel-termination/" class="post-title-link" itemprop="url">channel and termination</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-07-01 08:44:42" itemprop="dateCreated datePublished" datetime="2022-07-01T08:44:42+00:00">2022-07-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-08-09 09:55:03" itemprop="dateModified" datetime="2024-08-09T09:55:03+00:00">2024-08-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/analog/" itemprop="url" rel="index"><span itemprop="name">analog</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="voltage-mode-driver">voltage mode driver</h2>
<p><img src="/2022/07/01/channel-termination/voltagemode20220704.PNG"
alt="voltagemode20220704" /></p>
<h2 id="current-mode-driver">current mode driver</h2>
<p><img
src="/2022/07/01/channel-termination/image-20220702003926289.png"
alt="image-20220702003926289" /></p>
<h2 id="reference">reference</h2>
<p>Byungsub Kim, 2022 IEEE International Solid-State Circuits
Conference, "T11: Basics of Equalization Techniques: Channels,
Equalization, and Circuits"</p>
<p>Minsoo Choi et al., “An Approximate Closed-Form Channel Model for
Diverse Interconnect Applications,” IEEE Transactions on Circuits and
Systems-I: Regular Papers, vol. 61, no. 10, pp. 3034-3043, Oct.
2014.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/23/esd-dual-diodes-ggnmos/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/06/23/esd-dual-diodes-ggnmos/" class="post-title-link" itemprop="url">Dual Diode and ggNMOS</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-06-23 22:21:54" itemprop="dateCreated datePublished" datetime="2022-06-23T22:21:54+00:00">2022-06-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-08-09 09:55:03" itemprop="dateModified" datetime="2024-08-09T09:55:03+00:00">2024-08-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/analog/" itemprop="url" rel="index"><span itemprop="name">analog</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="hia-diode">HIA diode</h2>
<p><img
src="/2022/06/23/esd-dual-diodes-ggnmos/image-20230517233753530.png"
alt="image-20230517233753530" /></p>
<blockquote>
<p><em>HIA</em> = High Amp</p>
<p>lateral diode: <strong>perimeter</strong> is key DRC rule for ESD
diode</p>
<p>HIA diode process is same with regular junction diode</p>
</blockquote>
<h2 id="dual-stacked-diodes">Dual Stacked Diodes</h2>
<p><img
src="/2022/06/23/esd-dual-diodes-ggnmos/image-20230518012456390.png"
alt="image-20230518012456390" /></p>
<blockquote>
<p>PS: I/O to GND positively</p>
<p>NS: I/O to GND negatively</p>
<p>PD: I/O to VDD positively</p>
<p>ND: I/O to VDD negatively</p>
</blockquote>
<p>Dual diode should be used with <strong>power clamp</strong> for
<strong>PS</strong> and <strong>ND</strong> path</p>
<h3 id="pmos-power-clamp">PMOS power clamp</h3>
<p><img
src="/2022/06/23/esd-dual-diodes-ggnmos/power_clamp_pmos.drawio.svg"
alt="power_clamp_pmos.drawio" /></p>
<h2 id="ggnmos-grounded-gate-nmos">ggNMOS (grounded-gate NMOS)</h2>
<p><img
src="/2022/06/23/esd-dual-diodes-ggnmos/image-20220623231619052.png"
alt="image-20220623231619052" /></p>
<blockquote>
<p>The drain (D) is connected to an I/O pad and the gate (G) is
grounded.</p>
<p>To ensure “zero” leakage of the ESD protection structure under normal
operations.</p>
<p>To to protect gate of core device, tie-high and tie-low shall be used
when used as secondary ESD protection.</p>
</blockquote>
<p><img
src="/2022/06/23/esd-dual-diodes-ggnmos/image-20240723213214708.png"
alt="image-20240723213214708" /></p>
<blockquote>
<p>[<a
target="_blank" rel="noopener" href="https://monthly-pulse.com/wp-content/uploads/2021/11/2021-11-sofics_presentation_ieee_final.pdf">https://monthly-pulse.com/wp-content/uploads/2021/11/2021-11-sofics_presentation_ieee_final.pdf</a>]</p>
</blockquote>
<h3 id="positive-esd-transient-at-io-pad">Positive ESD transient at I/O
pad</h3>
<p><img
src="/2022/06/23/esd-dual-diodes-ggnmos/image-20220623233019912.png"
alt="image-20220623233019912" /></p>
<ol type="1">
<li><strong>DB</strong> junction is reverse-biased all the way to its
breakdown.</li>
<li>Avalance multiplication takes place and generates electron-hole
pairs</li>
<li>Hole current flows into the ground via the *B-region** and build up
a potential, VR, across the lateral parasitic resistance R</li>
<li>As VR increases, the <strong>BS</strong> junction turns on,
eventually triggers the parasitic lateral NPN transistor Q
(<strong>DBS</strong>)</li>
</ol>
<h3 id="negative-esd-transient-at-io-pad">Negative ESD transient at I/O
pad</h3>
<p><img
src="/2022/06/23/esd-dual-diodes-ggnmos/image-20220623233634452.png"
alt="image-20220623233634452" /></p>
<p>The forward-biased parasitic diode, <strong>BD</strong>, will shunt
the transient</p>
<blockquote>
<p>ggNMOS is commonly used in the GPIO provided by foundry, which
alleviate the ESD design burden of customer.</p>
<p>These GPIO is self-protective thanks to the ggNMOS.</p>
</blockquote>
<h2 id="reference">reference</h2>
<p>Wang, Albert Z. H. 2002. On-chip ESD protection for integrated
circuits: an IC design perspective. Boston, Mass: Kluwer Academic
Publishers.</p>
<p>Wang, Anq i &amp; Feng, H.G &amp; Gong, K &amp; Zhan, Ruqing &amp;
Stine, J. (2001). On-chip ESD protection design for integrated circuits:
An overview for IC designers. Microelectronics Journal. 32. 733-747.
10.1016/S0026-2692(01)00060-X.</p>
<p>Feng, Haigang, Ke Gong, Rouying Zhan and Albert Z. Wang. “On-Chip ESD
Protection Design for Ics.” (2001).</p>
<p>Introduction: ESD protection concepts for I/Os. URL: <a
target="_blank" rel="noopener" href="https://monthly-pulse.com/2022/03/29/introduction-esd-protection-concepts-for-i-os/">https://monthly-pulse.com/2022/03/29/introduction-esd-protection-concepts-for-i-os/</a></p>
<p>Answer: What does "strap" mean in this context? <a
target="_blank" rel="noopener" href="https://electronics.stackexchange.com/a/591759?stw=2">https://electronics.stackexchange.com/a/591759?stw=2</a></p>
<p>Hammer VLSI Flow URL: <a
target="_blank" rel="noopener" href="https://fires.im/micro22-slides-pdf/04_hammer_vlsi.pdf">https://fires.im/micro22-slides-pdf/04_hammer_vlsi.pdf</a></p>
<p>Calibre Rule Writing 2009</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/21/sv-iff/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/06/21/sv-iff/" class="post-title-link" itemprop="url">SystemVerilog iff</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-06-21 18:12:51" itemprop="dateCreated datePublished" datetime="2022-06-21T18:12:51+00:00">2022-06-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-08-09 09:55:04" itemprop="dateModified" datetime="2024-08-09T09:55:04+00:00">2024-08-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/digital/" itemprop="url" rel="index"><span itemprop="name">digital</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@(<span class="keyword">posedge</span> clk <span class="keyword">iff</span>(vld));</span><br><span class="line">do_something;</span><br></pre></td></tr></table></figure>
<p>is equivalent to</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">forever</span> <span class="keyword">begin</span></span><br><span class="line">	@(<span class="keyword">posedge</span> clk);</span><br><span class="line">    <span class="keyword">if</span>(vld) <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">do_something;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>iff</code> is more efficient than <code>if</code> because the
expression is recalculated when <code>vld</code> transition rather than
<code>clk</code>.</p>
</blockquote>
<p>One example, detecting the negative edge of
<code>rtr_io.cb.frameo_n[da]</code></p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">wait</span>(rtr_io<span class="variable">.cb</span><span class="variable">.frameo_n</span>[da] !== <span class="number">0</span>);</span><br><span class="line">@(rtr_io<span class="variable">.cb</span> <span class="keyword">iff</span>(rtr_io<span class="variable">.cb</span><span class="variable">.frameo_n</span>[da] === <span class="number">0</span> )); </span><br><span class="line"><span class="built_in">$display</span>(<span class="string">&quot;[DEBUG HGUO] %0t, rtr_io.cb.frameo_n[da] negedge&quot;</span>, <span class="built_in">$realtime</span>);</span><br></pre></td></tr></table></figure>
<p><img src="/2022/06/21/sv-iff/image-20220621182019927.png"
alt="image-20220621182019927" /></p>
<p><code>[DEBUG HGUO] 6887250.0ns, rtr_io.cb.frameo_n[da] negedge</code></p>
<p><strong>reference</strong></p>
<p>system verilog中的iff, URL: <a
target="_blank" rel="noopener" href="https://www.francisz.cn/2019/07/18/sv-iff/">https://www.francisz.cn/2019/07/18/sv-iff/</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/10/isf-sampler/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/06/10/isf-sampler/" class="post-title-link" itemprop="url">Impulse Sensitivity Function (ISF) of Periodic Sampler</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-06-10 19:57:01" itemprop="dateCreated datePublished" datetime="2022-06-10T19:57:01+00:00">2022-06-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-08-09 09:55:03" itemprop="dateModified" datetime="2024-08-09T09:55:03+00:00">2024-08-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/noise/" itemprop="url" rel="index"><span itemprop="name">noise</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>An efficient method to measure the ISFs of periodic circuits via
periodic AC (PAC) analysis, which is available from RF circuit
simulators such as SpectreRF and ADS</p>
<h2 id="isf">ISF</h2>
<h3 id="linear-time-varying-system-theory">Linear Time-varying System
Theory</h3>
<p>We define the ISF of the sampler as the sensitivity of its final
output voltage to the impulse arriving at its input at different times,
the ISF essentially describes the aperture of the sampler.</p>
<p>An ideal sampler would have the perfect aperture, i.e. sampling the
input voltage at exactly one point in time; thus, its ISF would be a
Dirac delta function, <span class="math inline">\(\delta(t-t_s)\)</span>
where <span class="math inline">\(t_s\)</span> is when sampling
occurs.</p>
<p>A realistic sampler would rather capture a weighted-average of the
input voltage over a certain time window. This weighting function is
called the sampling aperture and is equivalent to the ISF</p>
<p><img src="/2022/06/10/isf-sampler/image-20220610235211500.png"
alt="image-20220610235211500" /></p>
<p>A <strong>time-varying impulse response</strong> <span
class="math inline">\(h(t, \tau)\)</span> is defined as the circuit
response at time <span class="math inline">\(t\)</span> responding to an
impulse arriving at time <span class="math inline">\(\tau\)</span>.</p>
<p>In general, the ISF can be regarded as the <strong>time-varying
impulse response</strong> evaluated at <em>one particular observation
time</em> <span class="math inline">\(t=t_0\)</span>.</p>
<p>The system output <span class="math inline">\(y(t)\)</span> is
related to the input <span class="math inline">\(x(t)\)</span> as: <span
class="math display">\[
y(t) = \int_{-\infty}^{\infty}h(t, \tau)\cdot x(\tau)d\tau
\]</span> Note that in a linear time-invariant (LTI) system, <span
class="math inline">\(h(t,\tau)=h(t-\tau)\)</span> and the above
equation reduces to a convolution.</p>
<p>If <span class="math inline">\(X(j\omega)\)</span> is the Fourier
transform of the input signal <span class="math inline">\(x(t)\)</span>,
i.e. <span class="math display">\[
x(t) = \frac{1}{2\pi}\int_{-\infty}^{\infty}X(j\omega)\cdot e^{j\omega
t}d\omega
\]</span> Then <span class="math display">\[\begin{align}
y(t) &amp;=
\int_{-\infty}^{\infty}h(t,\tau)\left[\frac{1}{2\pi}\int_{-\infty}^{\infty}X(j\omega)\cdot
e^{j\omega\tau }d\omega \right]\cdot d\tau \\
&amp;=\frac{1}{2\pi}\int_{-\infty}^{\infty}X(j\omega)\left[\int_{-\infty}^{\infty}h(t,\tau)\cdot
e^{j\omega\tau}d\tau\right]\cdot d\omega \\
&amp;=\frac{1}{2\pi}\int_{-\infty}^{\infty}X(j\omega)\left[\int_{-\infty}^{\infty}h(t,\tau)\cdot
e^{-j\omega(t-\tau)}d\tau\right]\cdot e^{j\omega t}\cdot d\omega \\
&amp;=\frac{1}{2\pi}\int_{-\infty}^{\infty}X(j\omega)\cdot
H(j\omega;t)\cdot e^{j\omega t}\cdot d\omega
\end{align}\]</span></p>
<p>where <span class="math inline">\(H(j\omega;t)\)</span> is
<strong>time-varying transfer function</strong>, defined as the Fourier
transform of the time-varying impulse response. <span
class="math display">\[
H(j\omega;t)=\int_{-\infty}^{\infty}h(t,\tau)\cdot
e^{-j\omega(t-\tau)}d\tau
\]</span> And it follows that: <span class="math display">\[
Y(j\omega)=H(j\omega;t)\cdot X(j\omega)
\]</span> And</p>
<p><span class="math display">\[\begin{align}
x(\tau) &amp; \overset{FT}{\longrightarrow} X(j\omega) \\
h(t,\tau) &amp; \overset{FT}{\longrightarrow} H(j\omega;t)
\end{align}\]</span></p>
<p>For linear, periodically time-varying (LPTV) systems, <span
class="math inline">\(h(t, \tau) = h(t+T, \tau+T)\)</span> and <span
class="math inline">\(H(j\omega; t) = H(j\omega; t+T)\)</span> where
<span class="math inline">\(T\)</span> is the period of the time-varying
dynamics of the system.</p>
<p>We prove <span class="math inline">\(H(j\omega; t) = H(j\omega;
t+T)\)</span>:</p>
<p><span class="math display">\[\begin{align}
\because H(j\omega;t)&amp;=\int_{-\infty}^{\infty}h(t,\tau)\cdot
e^{-j\omega(t-\tau)}d\tau \\
\therefore H(j\omega;t+T) &amp;= \int_{-\infty}^{\infty}h(t+T,\tau)\cdot
e^{-j\omega(t+T-\tau)}d\tau \\
&amp;= \int_{-\infty}^{\infty}h(t+T,\tau+T)\cdot
e^{-j\omega(t+T-(\tau+T))}d(\tau+T) \\
&amp;= \int_{-\infty}^{\infty}h(t+T,\tau+T)\cdot
e^{-j\omega(t-\tau)}d\tau \\
&amp;= \int_{-\infty}^{\infty}h(t,\tau)\cdot e^{-j\omega(t-\tau)}d\tau
\\
&amp;= H(j\omega;t)
\end{align}\]</span></p>
<h3 id="characterizing-isf-via-pac">Characterizing ISF via PAC</h3>
<p>Since <span class="math inline">\(H(j\omega;t)\)</span> is periodic
in <span class="math inline">\(T\)</span>, The time-varying transfer
function <span class="math inline">\(H(j\omega;t)\)</span> can be
expressed in a Fourier series: <span class="math display">\[
H(j\omega;t)=\sum_{m=-\infty}^{\infty}H_m(j\omega) \cdot e^{jm\omega_c
t}
\]</span> where <span class="math inline">\(\omega_c\)</span> is the
fundamental frequency of the periodic system. <span
class="math inline">\(H_m(j\omega)\)</span> represent the frequency
response of the system at the <em>(m-th)</em> harmonic output sideband
to a unit <span class="math inline">\(j\omega\)</span> sinusoid.</p>
<blockquote>
<p>The above equation link time-varying transfer function <span
class="math inline">\(H(j\omega;t)\)</span> with PAC simulation
output</p>
</blockquote>
<p>The response to a periodic impulse train, that is: <span
class="math display">\[
x(t)=\sum_{m=-\infty}^{\infty}\delta(t-\tau-nkT)
\]</span> The idea is that if the impulse response of the system settles
to zero long before the next impulse arrives, then the system response
to this impulse train would be approximately equal to the periodic
repetition of the true impulse response, i.e.: <span
class="math display">\[
y(t) \cong  \sum_{m=-\infty}^{\infty}h(t;\tau+nkT)
\]</span> and <span class="math inline">\(y(t)\)</span> would be
approximately equal to <span class="math inline">\(h(t;\tau)\)</span>
for <span class="math inline">\(\tau \leq t \le t+kT\)</span></p>
<p><img src="/2022/06/10/isf-sampler/yt.drawio.svg"
alt="yt.drawio" /></p>
<blockquote>
<p>Without loss of generality and for computation convenience, we set
<span class="math inline">\(k=1\)</span> thereafter.</p>
</blockquote>
<p>The Fourier transform <span class="math inline">\(X(j\omega)\)</span>
of the <strong>T-periodic</strong> impulse train is: <span
class="math display">\[
X(j\omega)=\omega_c\sum_{n=-\infty}^{\infty}\delta(\omega-n\omega_c)\cdot
e^{-j\omega\tau}
\]</span> Then the response <span class="math inline">\(y(t)\)</span>
is: <span class="math display">\[
y(t)=\frac{1}{T}\sum_{n=-\infty}^{\infty}H(jn\omega_c;t)\cdot
e^{jn\omega_c\cdot(t-\tau)}
\]</span> The expression for the approximate time-varying impulse
response: <span class="math display">\[
h(t,\tau) = \left\{ \begin{array}{cl}
\frac{1}{T}\sum_{n=-\infty}^{\infty}\sum_{m=-\infty}^{\infty}H_m(jn\omega_c)\cdot
e^{jm\omega_ct+jn\omega_c\cdot (t-\tau)} &amp; : \ \tau \leq \tau+T \\
0 &amp; : \ \text{elsewhere}
\end{array} \right.
\]</span> Finally, the ISF <span
class="math inline">\(\Gamma(\tau)\)</span> is equal to <span
class="math inline">\(h(t,\tau)\)</span> when <span
class="math inline">\(t=t_0\)</span> and <span class="math inline">\(t_0
\gt \tau\)</span> <span class="math display">\[
\Gamma(\tau)\cong
\frac{1}{T}\sum_{n=-\infty}^{\infty}\sum_{m=-\infty}^{\infty}H_m(jn\omega_c)\cdot
e^{jm\omega_ct_0+jn\omega_c\cdot (t_0-\tau)}
\]</span> In practice, the summations are carried out over finite ranges
of <strong>n</strong> and <strong>m</strong>, for example, -50~50.</p>
<p>For each combination of <strong>n</strong> and <strong>m</strong>,
the PAC analysis needs to be performed to compute <span
class="math inline">\(H_m(jn\omega_c)\)</span>, the m-th harmonic
response to the excitation at <span
class="math inline">\(n\omega_c\)</span></p>
<p>The detailed procedure for characterizing the ISF of this sampler is
outlined as follows:</p>
<ul>
<li><p>First, apply the proper input voltages that place the sampler in
a metastable state and perform the periodic steady-state (PSS)
analysis.</p></li>
<li><p>Second, perform the PAC analysis.</p></li>
<li><p>Third, based on the simulated PAC response, pick a time point
<span class="math inline">\(t_0\)</span> at which the ISF is to be
computed and derive the ISF</p></li>
</ul>
<p>One possible candidate for the ISF measurement point <span
class="math inline">\(t_0\)</span> is the time at which the output
voltage is amplified to the largest value. PAC response of the sampler
to a small signal DC input, that is, the time-varying transfer function
evaluated at <span class="math inline">\(\omega=0\)</span> <span
class="math display">\[
H(j\omega;t)=\sum_{m=-\infty}^{\infty}H_m(0) \cdot e^{jm\omega_c t}
\]</span> <img src="/2022/06/10/isf-sampler/image-20220614214446328.png"
alt="image-20220614214446328" /></p>
<blockquote>
<p>The total area under the ISF is the sampling gain, which is equal to
the time-varying gain measured at <span
class="math inline">\(t_0\)</span></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">time-varying gain at t0 H(0;t0): 19.486305</span><br><span class="line">The total area under the ISF: 19.990230</span><br></pre></td></tr></table></figure>
<h3 id="align-pss_td.pss-with-isf">Align pss_td.pss with ISF</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">****************************************************</span><br><span class="line">Periodic Steady-State Analysis `pss&#x27;: fund = 500 MHz</span><br><span class="line">****************************************************</span><br><span class="line">Trying `homotopy = gmin&#x27; for initial conditions.</span><br><span class="line">DC simulation time: CPU = 4.237 ms, elapsed = 4.27389 ms.</span><br><span class="line"></span><br><span class="line">===============================</span><br><span class="line">`pss&#x27;: time = (0 s -&gt; 102.6 ns)</span><br><span class="line">===============================</span><br><span class="line"></span><br><span class="line">Opening the PSF file ../psf/pss.tran.pss ...</span><br><span class="line">...</span><br><span class="line">Important parameter values in tstab integration:</span><br><span class="line">    start = 0 s</span><br><span class="line">    outputstart = 0 s</span><br><span class="line">    stop = 102.6 ns</span><br><span class="line">    period = 2 ns</span><br><span class="line">    maxperiods = 20</span><br><span class="line">    step = 102.6 ps</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p><strong>tstab = 102.6 ns</strong> can be observed in pss simulation
log</p>
<p><img src="/2022/06/10/isf-sampler/image-20220614214537033.png"
alt="image-20220614214537033" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tstab = <span class="number">102.6e-9</span>;</span><br><span class="line">tshift = <span class="built_in">mod</span>(tstab, Tc);</span><br><span class="line">tt_shift = tt - tshift;</span><br><span class="line">tt_shift_start_indx = <span class="built_in">find</span>(tt_shift&gt;=<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">isf_shift = <span class="built_in">circshift</span>(isf_re, -tt_shift_start_indx);</span><br></pre></td></tr></table></figure>
<h3 id="align-pss_fd.pss-with-isf">Align pss_fd.pss with ISF</h3>
<p>Since both are frequency originated, time-shift is NOT needed</p>
<p><img src="/2022/06/10/isf-sampler/image-20220614214613574.png"
alt="image-20220614214613574" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">wv</span> = <span class="title">wv_fd</span><span class="params">(fname,tt)</span></span></span><br><span class="line">fd = csvread(fname, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">DC = fd(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">w = <span class="number">2</span>*<span class="built_in">pi</span>*fd(<span class="number">2</span>:<span class="keyword">end</span>, <span class="number">1</span>);</span><br><span class="line">coef = fd(<span class="number">2</span>:<span class="keyword">end</span>, <span class="number">2</span>) + <span class="number">1</span><span class="built_in">i</span>*fd(<span class="number">2</span>:<span class="keyword">end</span>, <span class="number">3</span>);</span><br><span class="line">exp_sup = <span class="number">1</span><span class="built_in">i</span>*w.*tt;</span><br><span class="line">wv = sum(<span class="built_in">real</span>(coef .* <span class="built_in">exp</span>(exp_sup)), <span class="number">1</span>) + DC;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h3 id="remarks">Remarks</h3>
<p><strong>pss pac setup</strong></p>
<ul>
<li>clock frequency should be low enough to assure system response
settle to zero.</li>
<li>Beat Frequency os PSS should be clock frequency</li>
<li>For PAC setup,
<ul>
<li>the <code>Sweeptype</code> is <code>absolute</code></li>
<li><code>Input Frequency Sweep Range(Hz)</code> should be large
enough.</li>
<li><code>Sweep Type</code> should be <code>Linear</code> and
<code>Step Size</code> should equal <strong>PSS Beat
Frequency(Hz)</strong></li>
<li><code>SideBands</code> should large enough, like 50 (i.e. 50*2 +1,
positive, negative and 0)</li>
<li><code>Specialized Analyses</code> should be <code>None</code></li>
</ul></li>
</ul>
<blockquote>
<p>one example: clock, i.e. beat frequency = 8G PAC: input frequency
sweep from -400G to 400G and step is 8G, which is beat frequency, here
K=1 Eq.(9) of paper</p>
</blockquote>
<blockquote>
<p><strong>freqaxis=out</strong>: <code>freqaxis</code> of PAC not only
affect "Direct Plot"'s output but also simuation data i.e. the phase
shift(imaginary part).</p>
</blockquote>
<p>matlab matrix <strong>nonconjugate transpose</strong>:</p>
<p><code>transpose</code>, <code>.'</code> cf.
https://www.mathworks.com/help/matlab/ref/transpose.html</p>
<h2 id="tstab-in-pss"><code>tstab</code> in PSS</h2>
<p>Using shooting PSS, the steady waveform starts from
<code>tstab+n*tperiod</code>.</p>
<ul>
<li><strong>pss_td.pss</strong> is one period waveform starting from
<code>tstab+n*tperiod</code></li>
<li><strong>pss_fd.pss</strong> is the <em>complex</em> fourier series
coefficient of expanded to left and right <strong>pss_td.pss</strong>
waveform (<code>tstab+n*tperiod : tstab+(n+1)*tperiod</code>)</li>
</ul>
<blockquote>
<p>We have to left-shift <code>mod(tstab, tperiod)</code>
<code>pss_fd.pss</code> in order to align it with of
<strong>pss_tb.pss</strong></p>
</blockquote>
<p><img src="/2022/06/10/isf-sampler/image-20220610222535614.png"
alt="image-20220610222535614" /></p>
<h3 id="simulation-log">simulation log</h3>
<p>The below <code>stop = 1.3 ns</code> is actual <strong>tstab</strong>
time, though <code>Stop Time(tstab)</code> field of pss form is filled
with <code>0.3n</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">**************************************************</span><br><span class="line">Periodic Steady-State Analysis `pss&#x27;: fund = 1 GHz</span><br><span class="line">**************************************************</span><br><span class="line">DC simulation time: CPU = 208 us, elapsed = 211.954 us.</span><br><span class="line"></span><br><span class="line">=============================</span><br><span class="line">`pss&#x27;: time = (0 s -&gt; 1.3 ns)</span><br><span class="line">=============================</span><br><span class="line"></span><br><span class="line">Opening the PSF file ../psf/pss.tran.pss ...</span><br><span class="line"></span><br><span class="line">Output and IC/nodeset summary:</span><br><span class="line">                 save   1       (current)</span><br><span class="line">                 save   2       (voltage)</span><br><span class="line"></span><br><span class="line">Important parameter values in tstab integration:</span><br><span class="line">    start = 0 s</span><br><span class="line">    outputstart = 0 s</span><br><span class="line">    stop = 1.3 ns</span><br><span class="line">    period = 1 ns</span><br><span class="line">    maxperiods = 20</span><br><span class="line">    step = 1.3 ps</span><br><span class="line">    maxstep = 40 ps</span><br><span class="line">    ic = all</span><br><span class="line">    useprevic = no</span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">    pss: time = 64.01 ps    (4.92 %), step = 31.63 ps     (2.43 %)</span><br><span class="line">	...</span><br><span class="line">    pss: time = 1.224 ns    (94.2 %), step = 40 ps        (3.08 %)</span><br><span class="line">    pss: time = 1.3 ns       (100 %), step = 35.99 ps     (2.77 %)</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h3 id="pss-simulation-result">PSS simulation result</h3>
<p><img src="/2022/06/10/isf-sampler/image-20220610224100135.png"
alt="image-20220610224100135" /></p>
<h3 id="align-pss_tb-and-pss_fd">Align pss_tb and pss_fd</h3>
<p><img src="/2022/06/10/isf-sampler/image-20220610225310243.png"
alt="image-20220610225310243" /></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">clear;</span><br><span class="line">clc;</span><br><span class="line"></span><br><span class="line">freq = <span class="number">1e9</span>;</span><br><span class="line">tstab = <span class="number">1.3e-9</span>;</span><br><span class="line">Tp  = <span class="number">1e-9</span>;</span><br><span class="line"></span><br><span class="line">load(<span class="string">&#x27;pss_td.matlab&#x27;</span>)</span><br><span class="line">t = pss_td(:, <span class="number">1</span>);</span><br><span class="line">ytd = pss_td(:, <span class="number">2</span>);</span><br><span class="line"><span class="built_in">plot</span>(t*<span class="number">1e9</span>, ytd, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">6</span>)</span><br><span class="line"><span class="built_in">hold</span> on;</span><br><span class="line"></span><br><span class="line"><span class="comment">% time domian from pss frequency domain information</span></span><br><span class="line">coff_real = <span class="number">-0.155222</span>;</span><br><span class="line">coff_imag = <span class="number">-0.0247045</span>;</span><br><span class="line">wc = <span class="number">2</span>*<span class="built_in">pi</span>*freq;</span><br><span class="line">tfd = (<span class="number">0</span>:<span class="number">1e-11</span>:<span class="number">2e-9</span>);</span><br><span class="line">yfd = coff_real*<span class="built_in">cos</span>(wc*tfd) - coff_imag*<span class="built_in">sin</span>(wc*tfd);</span><br><span class="line"><span class="built_in">plot</span>(tfd*<span class="number">1e9</span>, yfd, <span class="string">&#x27;b&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">% actual pss_td.pss one-period waveform</span></span><br><span class="line">tfd_td = (tstab:<span class="number">1e-11</span>:<span class="number">2e-9</span>);</span><br><span class="line">yfd_td = coff_real*<span class="built_in">cos</span>(wc*tfd_td) - coff_imag*<span class="built_in">sin</span>(wc*tfd_td);</span><br><span class="line"><span class="built_in">plot</span>(tfd_td*<span class="number">1e9</span>, yfd_td, <span class="string">&#x27;--b&#x27;</span>, <span class="string">&#x27;LineWidth&#x27;</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">% align pss_fd with pss_tb by left shift mod(tstab, Tp) pss_fd</span></span><br><span class="line">tshift = <span class="built_in">mod</span>(tstab, Tp);</span><br><span class="line">tfd_shift = tfd - tshift;</span><br><span class="line">tfd_shift_start_indx = <span class="built_in">find</span>(tfd_shift&gt;=<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">tfd_shift = tfd_shift(<span class="number">1</span>, tfd_shift_start_indx:<span class="keyword">end</span>);</span><br><span class="line">yfd_shift = yfd(<span class="number">1</span>, tfd_shift_start_indx:<span class="keyword">end</span>);</span><br><span class="line"><span class="built_in">plot</span>(tfd_shift*<span class="number">1e9</span>, yfd_shift, <span class="string">&#x27;-magenta&#x27;</span>, <span class="string">&#x27;LineWidth&#x27;</span>, <span class="number">2</span>)</span><br><span class="line">grid on;</span><br><span class="line"></span><br><span class="line">xlabel(<span class="string">&#x27;t (ps)&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;V(t)&#x27;</span>);</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;Using pss\_td&#x27;</span>, <span class="string">&#x27;Using pss\_fd&#x27;</span>, <span class="string">&#x27;pss\_tb one period clip&#x27;</span>, <span class="string">&#x27;Using pss\_fd with time shift&#x27;</span>, <span class="string">&#x27;location&#x27;</span>, <span class="string">&#x27;east&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h2 id="reference">reference</h2>
<p>J. Kim, B. S. Leibowitz and M. Jeeradit, "Impulse sensitivity
function analysis of periodic circuits," 2008 IEEE/ACM International
Conference on Computer-Aided Design, 2008, pp. 386-391, doi:
10.1109/ICCAD.2008.4681602.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/09/esd-protection/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/06/09/esd-protection/" class="post-title-link" itemprop="url">ESD and Protection</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-06-09 23:13:59" itemprop="dateCreated datePublished" datetime="2022-06-09T23:13:59+00:00">2022-06-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-08-09 09:55:03" itemprop="dateModified" datetime="2024-08-09T09:55:03+00:00">2024-08-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/analog/" itemprop="url" rel="index"><span itemprop="name">analog</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>The <strong>ESD design window</strong> is defined as the difference
between the breakdown voltage of the functional circuit (red line) and
the maximum signal voltage (blue line) <img
src="/2022/06/09/esd-protection/esddesignwindow-evolution.jpg"
alt="esddesignwindow-evolution" /></p>
<h2 id="tlp">TLP</h2>
<p>What makes <strong>TLP</strong> different than <strong>ESD</strong>
?</p>
<ul>
<li><strong>ESD</strong> tests simulate real world events (HBM, MM,
CDM)</li>
<li><strong>TLP</strong> does not simulate any real-world event</li>
<li><strong>ESD</strong> tests record failure level
(<em>Qualification</em>)</li>
<li><strong>TLP</strong> tests record failure level and device behavior
(<em>Characterization</em>)</li>
</ul>
<blockquote>
<p>TLP is not a qualification test, but a characterization method, which
describes the resistance of a device for a given stimulus, aka.
<em>Device Characterization</em></p>
<p>Unlike ESD waveforms, TLP does not mimic any real world event</p>
</blockquote>
<p><img src="/2022/06/09/esd-protection/image-20220609234548431.png"
alt="image-20220609234548431" /></p>
<h3 id="tlp-and-curve-tracing">TLP and Curve Tracing</h3>
<ul>
<li>Curve Tracing is DC; TLP is a short pulse
<ul>
<li>Shorter pulse - Reduced duty cycle, less heating, which means higher
voltage before failure</li>
<li>Controlled Impedance - Allows device behavior to be observed</li>
</ul></li>
<li>Both measure resistance of device with increasing voltage</li>
</ul>
<p><img src="/2022/06/09/esd-protection/image-20220609235252444.png"
alt="image-20220609235252444" /></p>
<h3 id="device-characterization-with-tlp">Device Characterization with
TLP</h3>
<ul>
<li>Turn-on time</li>
<li>Snapback voltage</li>
<li>Performance changes with rise time</li>
</ul>
<p><img src="/2022/06/09/esd-protection/image-20220609235427204.png"
alt="image-20220609235427204" /></p>
<h3 id="vf-tlp-and-cdm-differences">VF-TLP and CDM differences</h3>
<p>Question:</p>
<p>How well will VF-TLP results predict CDM testing performance?</p>
<p>Answer:</p>
<p>VF-TLP can be a guide to CDM failure levels, and provide a lot of
understanding of a circuit's operation during CDM stressing, but simple
correlations between VF-TLP failure current level and CDM withstand
voltage levels are difficult to establish.</p>
<h2 id="snapback-device">snapback device</h2>
<p>Unfortunately, this protection concept is not effective anymore in
advanced FinFET technology. Our analysis showed that both core and IO
transistors are damaged at the onset of snapback in several FinFET
processes. <img src="/2022/06/09/esd-protection/snapback.PNG"
alt="snapback" /></p>
<h2 id="power-clamp">power clamp</h2>
<p>Thanks to the device scaling the area is actually reasonable.
However, the leakage becomes the main bottleneck. <img
src="/2022/06/09/esd-protection/bigfet-concept.jpg"
alt="bigfet-concept" /></p>
<h2 id="esd-diode">ESD diode</h2>
<p><img src="/2022/06/09/esd-protection/image-20220618123654830.png"
alt="image-20220618123654830" /></p>
<p><img src="/2022/06/09/esd-protection/image-20220618123821117.png"
alt="image-20220618123821117" /></p>
<p><img src="/2022/06/09/esd-protection/image-20220618124644879.png"
alt="image-20220618124644879" /></p>
<blockquote>
<p>both diode are reverse-biased in normal operation, the PN Junction
capacitance is proportional to forward-bias voltage</p>
</blockquote>
<table>
<thead>
<tr class="header">
<th>Device</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ndio_mac</td>
<td>N+/P-well Diode</td>
</tr>
<tr class="even">
<td>pdio_mac</td>
<td>P+/N-well Diode</td>
</tr>
<tr class="odd">
<td>ndio_18_mac</td>
<td>1.8V N+/P-well Diode</td>
</tr>
<tr class="even">
<td>pdio_18_mac</td>
<td>1.8V P+/N-well Diode</td>
</tr>
<tr class="odd">
<td>ndio_hia18_mac</td>
<td>N-HIA Diode</td>
</tr>
<tr class="even">
<td>pdio_hia18_mac</td>
<td>P-HIA Diode</td>
</tr>
<tr class="odd">
<td>ndio_gated18_mac</td>
<td>Thick Oxide N-Gated Diode</td>
</tr>
<tr class="even">
<td>pdio_gated18_mac</td>
<td>Thick Oxide P-Gated Diode</td>
</tr>
</tbody>
</table>
<blockquote>
<p>HIA_DIO can be used for logic or high speed circuits ESD
protection</p>
<p>HIA: high current application purpose (High Amp)</p>
<p>There is no process difference between HIA_DIO and regular diode</p>
</blockquote>
<p><img src="/2022/06/09/esd-protection/image-20220618191312489.png"
alt="image-20220618191312489" /></p>
<p><img src="/2022/06/09/esd-protection/image-20220618183241535.png"
alt="image-20220618183241535" /></p>
<p><img src="/2022/06/09/esd-protection/image-20220618191405428.png"
alt="image-20220618191405428" /></p>
<table>
<thead>
<tr class="header">
<th>width (W)</th>
<th>2.020E-07</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Length (L)</strong></td>
<td>1.922E-06</td>
</tr>
<tr class="even">
<td><strong>ArrayY (Ny)</strong></td>
<td>2</td>
</tr>
<tr class="odd">
<td><strong>Perimeter (Ny*2*(W+L))</strong></td>
<td>8.496E-06</td>
</tr>
<tr class="even">
<td><strong>Area (Ny*W*L)</strong></td>
<td>7.76488E-13</td>
</tr>
</tbody>
</table>
<blockquote>
<ul>
<li><p>diode is drain/source originated, which is different from MOS
(Gate originated)</p></li>
<li><p><del>The perimeter of diode in DRC is different from that in PERC
deck, where PERC excludes the the left and right edge of
OD</del></p></li>
</ul>
</blockquote>
<p><em>g</em> after the rule numbers: DFM recommendations and
guidelines</p>
<p><sup>U</sup>: the rule is not checked by the DRC</p>
<h3 id="mos">MOS</h3>
<p><img src="/2022/06/09/esd-protection/image-20220618191906210.png"
alt="image-20220618191906210" /></p>
<p><img src="/2022/06/09/esd-protection/image-20220618192253726.png"
alt="image-20220618192253726" /></p>
<p><img src="/2022/06/09/esd-protection/image-20220618192325486.png"
alt="image-20220618192325486" /></p>
<blockquote>
<p><code>l</code> in netlist has different definition for MOS and
diode.</p>
<p>MOS: length of channel</p>
<p>diode: Gate space</p>
</blockquote>
<h2 id="reference">Reference</h2>
<p>Introduction to Transmission Line Pulse (TLP), URL: <a
target="_blank" rel="noopener" href="https://tools.thermofisher.com/content/sfs/brochures/TLP%20Presentation%20May%202009.pdf">https://tools.thermofisher.com/content/sfs/brochures/TLP%20Presentation%20May%202009.pdf</a></p>
<p>VF-TLP and CDM differences, URL: <a
target="_blank" rel="noopener" href="https://www.grundtech.com/app-note-vf-tlp-cdm-differences">https://www.grundtech.com/app-note-vf-tlp-cdm-differences</a></p>
<p>ESD-Testing: HBM to very fast TLP URL: <a
target="_blank" rel="noopener" href="https://www.thierry-lequeu.fr/data/ESREF/2004/Tut5.pdf">https://www.thierry-lequeu.fr/data/ESREF/2004/Tut5.pdf</a></p>
<p>S. Kim et al., "Technology Scaling of ESD Devices in State of the Art
FinFET Technologies," 2020 IEEE Custom Integrated Circuits Conference
(CICC), 2020, pp. 1-6, doi: 10.1109/CICC48029.2020.9075899.</p>
<p>Barth, Jon. "TLP and VFTLP Testing of Integrated Circuit ESD
Protection." (2015). ESD protection for FinFET processes URL: <a
target="_blank" rel="noopener" href="https://monthly-pulse.com/2021/01/19/esd-protection-for-finfet-processes/">https://monthly-pulse.com/2021/01/19/esd-protection-for-finfet-processes/</a></p>
<p>Yuanzhong Zhou, D. Connerney, R. Carroll and T. Luk, "Modeling MOS
snapback for circuit-level ESD simulation using BSIM3 and VBIC models,"
Sixth international symposium on quality electronic design (isqed'05),
2005, pp. 476-481, doi: 10.1109/ISQED.2005.81.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/08/run-test/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/06/08/run-test/" class="post-title-link" itemprop="url">How does UVM's run_test search testcase ?</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-06-08 00:53:36" itemprop="dateCreated datePublished" datetime="2022-06-08T00:53:36+00:00">2022-06-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-08-09 09:55:04" itemprop="dateModified" datetime="2024-08-09T09:55:04+00:00">2024-08-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/digital/" itemprop="url" rel="index"><span itemprop="name">digital</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>It depends on the simulator:</p>
<ul>
<li>QuestaSim, Xcelium: You have to <code>import</code> pkg or
`<code>include</code> file in top testbench</li>
<li>VCS: VCS automatically search testcase in other Compilation
Units</li>
</ul>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// test_pkg.sv</span></span><br><span class="line"><span class="keyword">package</span> sim_pkg;</span><br><span class="line">	<span class="keyword">import</span> uvm_pkg::*;</span><br><span class="line">	<span class="meta">`<span class="keyword">include</span> &quot;uvm_macros.svh&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">class</span> my_test <span class="keyword">extends</span> uvm_test;</span><br><span class="line">		`uvm_component_utils(my_test)</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">function</span> <span class="keyword">new</span>(<span class="keyword">string</span> name, uvm_component parent);</span><br><span class="line">			<span class="keyword">super</span><span class="variable">.new</span>(name, parent);</span><br><span class="line">		<span class="keyword">endfunction</span> : <span class="keyword">new</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">task</span> run_phase(uvm_phase phase);</span><br><span class="line">			`uvm_info(get_type_name(), <span class="string">&quot;this is run_phase of my_test&quot;</span>, UVM_LOW)</span><br><span class="line">		<span class="keyword">endtask</span> : run_phase</span><br><span class="line">	<span class="keyword">endclass</span> : my_test</span><br><span class="line"></span><br><span class="line">	<span class="keyword">class</span> its_test <span class="keyword">extends</span> uvm_test;</span><br><span class="line">		`uvm_component_utils(its_test)</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">function</span> <span class="keyword">new</span>(<span class="keyword">string</span> name, uvm_component parent);</span><br><span class="line">			<span class="keyword">super</span><span class="variable">.new</span>(name, parent);</span><br><span class="line">		<span class="keyword">endfunction</span> : <span class="keyword">new</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">task</span> run_phase(uvm_phase phase);</span><br><span class="line">			`uvm_info(get_type_name(), <span class="string">&quot;this is run_phase of its_test&quot;</span>, UVM_LOW)</span><br><span class="line">		<span class="keyword">endtask</span> : run_phase</span><br><span class="line">	<span class="keyword">endclass</span> : its_test</span><br><span class="line"></span><br><span class="line"><span class="keyword">endpackage</span> : sim_pkg</span><br></pre></td></tr></table></figure>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tb_top.sv</span></span><br><span class="line"><span class="keyword">module</span> tb_top;</span><br><span class="line">	<span class="keyword">import</span> uvm_pkg::*;</span><br><span class="line">	<span class="comment">//import sim_pkg::*;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">		run_test();</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<table>
<colgroup>
<col style="width: 11%" />
<col style="width: 78%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="header">
<th>simulator</th>
<th>cmd</th>
<th>result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>VCS</td>
<td><code>vcs -sverilog -ntb_opts uvm-1.2 test_pkg.sv tb_top.sv</code><br /><code>./simv +UVM_TESTNAME=my_test</code></td>
<td>✓</td>
</tr>
<tr class="even">
<td>Xcelium</td>
<td><code>xrun -64 -uvmhome CDNS-1.2 test_pkg.sv tb_top.sv +UVM_TESTNAME=my_test</code></td>
<td>✗</td>
</tr>
<tr class="odd">
<td>QuestaSim</td>
<td><code>vlog test_pkg.sv tb_top.sv -L $QUESTA_HOME/uvm-1.2</code><br /><code>vsim -c -do "run -all;exit" +UVM_TESTNAME=my_test work.tb_top -L $QUESTA_HOME/uvm-1.2</code></td>
<td>✗</td>
</tr>
</tbody>
</table>
<p><em>Xcelium log:</em></p>
<blockquote>
<p><code>UVM_WARNING @ 0: reporter [BDTYP] Cannot create a component of type 'my_test' because it is not registered with the factory. UVM_FATAL @ 0: reporter [INVTST] Requested test from command line +UVM_TESTNAME=my_test not found. UVM_INFO /home/EDA/Cadence/XCELIUM2109/tools/methodology/UVM/CDNS-1.2/sv/src/base/uvm_report_catcher.svh(705) @ 0: reporter [UVM/REPORT/CATCHER]</code></p>
</blockquote>
<p><em>QuestaSim log:</em></p>
<blockquote>
<p><code># UVM_INFO verilog_src/questa_uvm_pkg-1.2/src/questa_uvm_pkg.sv(277) @ 0: reporter [Questa UVM] QUESTA_UVM-1.2.3</code>
<code># UVM_INFO verilog_src/questa_uvm_pkg-1.2/src/questa_uvm_pkg.sv(278) @ 0: reporter [Questa UVM]  questa_uvm::init(+struct)</code>
<code># UVM_WARNING @ 0: reporter [BDTYP] Cannot create a component of type 'my_test' because it is not registered with the factory.</code>
<code># UVM_FATAL @ 0: reporter [INVTST] Requested test from command line +UVM_TESTNAME=my_test not found.</code>
<code># UVM_INFO verilog_src/uvm-1.2/src/base/uvm_report_server.svh(847) @ 0: reporter [UVM/REPORT/SERVER]</code></p>
</blockquote>
<p><strong>solution:</strong></p>
<p>uncomment <code>//import sim_pkg::*;</code> in <em>tb_top.sv</em></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/04/data-dump/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/06/04/data-dump/" class="post-title-link" itemprop="url">simulation data dumping</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-06-04 16:30:47" itemprop="dateCreated datePublished" datetime="2022-06-04T16:30:47+00:00">2022-06-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-08-09 09:55:03" itemprop="dateModified" datetime="2024-08-09T09:55:03+00:00">2024-08-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/digital/" itemprop="url" rel="index"><span itemprop="name">digital</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="fsdb">FSDB</h2>
<h3 id="fsdbdumpfile"><code>$fsdbDumpfile</code></h3>
<p>It specifies the FSDB file name created by the Novas object files for
FSDB dumping. If it is not specified, then the default FSDB file name is
"novas.fsdb".</p>
<blockquote>
<p>This command is valid only <strong>before</strong> executing
<code>$fsdbDumpvars</code> and is ignored if specified after
<code>$fsdbDumpvars</code></p>
</blockquote>
<h3 id="fsdbsuppress"><code>$fsdbSuppress</code></h3>
<p>The <code>fsdbSuppress</code>utility is used to skip dumping of few
instances, scopes, modules and signals. The
<code>fsdbSuppress</code>utility is a system task like other fsdb
tasks.</p>
<blockquote>
<p>For <code>$fsdbSuppress()</code> to be effective, it needs to be
specified/called <strong>before</strong> <code>$fsdbDumpvars</code></p>
</blockquote>
<h3
id="fsdbautoswitchdumpfile"><code>$fsdbAutoSwitchDumpfile</code></h3>
<p>Automatically switch to a new dump file when the working FSDB file
reaches the specified size or the specified wall time period.</p>
<blockquote>
<p>After the dumping is finished, a <strong>virtual FSDB file
(*.vf)</strong> is automatically created and list all of the generated
FSDB files with the correct sequence. Only the <strong>virtual FSDB
file</strong>, rather than all of the FSDB files, needs to be loaded to
view the simulation results</p>
</blockquote>
<p>When specified in the design to switch based on <strong>file
size</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$fsdbAutoSwitchDumpfile(File_Size | File_Size_var, &quot;FSDB_Name&quot; |FSDB_Name_var, Number_of_Files | Number_of_Files_var[ ,&quot;log_filename&quot; | ,log_filename_var ], [&quot;+no_overwrite&quot;]);</span><br></pre></td></tr></table></figure>
<p>When specified in the design to switch based on <strong>time
period</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$fsdbAutoSwitchDumpfile(File_Size | File_Size_var, &quot;FSDB_Name&quot; |FSDB_Name_var, Number_of_Files | Number_of_Files_var[ ,&quot;log_filename&quot; | ,log_filename_var ], [&quot;+no_overwrite&quot;], “+by_period”);</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>“+by_period”</code></p>
</blockquote>
<h3 id="fsdbdumpvars"><code>$fsdbDumpvars</code></h3>
<p>This command dumps the change in signal value to the FSDB file.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$fsdbDumpvars([ depth, | &quot;level=&quot;,depth_var, ],[instance | &quot;instance=&quot;,instance_var])</span><br></pre></td></tr></table></figure>
<blockquote>
<p>For VCS users, to include memory, MDA, packed array and structure
information in the generated FSDB file, the <code>-debug_access</code>
option must be included when VCS is invoked to <strong>compile the
design</strong></p>
</blockquote>
<ul>
<li><p><code>depth</code></p>
<p>Specify how many sub-scope levels under the given scope you want to
dump.</p>
<ul>
<li>Specify this argument as <strong>1</strong> to dump the signals
under the given scope</li>
<li>Specify this argument as <strong>0</strong> to dump all signals
under the given scope and its descendant scopes.</li>
</ul>
<p>0: all signals in all scopes.</p>
<p>1: all signals in current scope.</p>
<p>2: all signals in the current scope and all scopes one level
below.</p>
<p>n: all signals in the current scope and all scopes n-1 levels
below.</p>
<table>
<colgroup>
<col style="width: 36%" />
<col style="width: 9%" />
<col style="width: 18%" />
<col style="width: 36%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>tb.clk</th>
<th>tb.u_div2.div2</th>
<th>tb.u_div2.u_div2neg.div2neg</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>$fsdbDumpvars(0)</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="even">
<td>$fsdbDumpvars(1)</td>
<td>✓</td>
<td>✗</td>
<td>✗</td>
</tr>
<tr class="odd">
<td>$fsdbDumpvars(2)</td>
<td>✓</td>
<td>✓</td>
<td>✗</td>
</tr>
<tr class="even">
<td>$fsdbDumpvars(1, tb.u_div2)</td>
<td>✗</td>
<td>✓</td>
<td>✗</td>
</tr>
<tr class="odd">
<td>$fsdbDumpvars(0, tb.u_div2)</td>
<td>✗</td>
<td>✓</td>
<td>✓</td>
</tr>
</tbody>
</table>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> tb;</span><br><span class="line">	<span class="keyword">reg</span> clk;</span><br><span class="line"></span><br><span class="line">	divider2 u_div2(clk);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">		clk = <span class="number">1&#x27;b0</span>;</span><br><span class="line">		<span class="keyword">forever</span> #<span class="number">5</span> clk = ~clk;</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">		#<span class="number">100</span>;</span><br><span class="line">		<span class="built_in">$finish</span>();</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">		 #<span class="number">10</span>;</span><br><span class="line">		 $fsdbDumpfile(<span class="string">&quot;tb.fsdb&quot;</span>);</span><br><span class="line">		 <span class="comment">//$fsdbDumpvars(0);				// same with $fsdbDumpvars(0, tb)</span></span><br><span class="line">		 <span class="comment">//$fsdbDumpvars(1);				// same with $fsdbDumpvars(1, tb)</span></span><br><span class="line">		 <span class="comment">//$fsdbDumpvars(2);				// same with $fsdbDumpvars(2, tb)</span></span><br><span class="line">		 <span class="comment">//$fsdbDumpvars(1, tb.u_div2);</span></span><br><span class="line">		 $fsdbDumpvars(<span class="number">0</span>, tb<span class="variable">.u_div2</span>);</span><br><span class="line">		 #<span class="number">80</span> <span class="built_in">$finish</span>();</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> divider2 (</span><br><span class="line">	<span class="keyword">input</span> clk</span><br><span class="line">);</span><br><span class="line">	<span class="keyword">reg</span> div2;</span><br><span class="line"></span><br><span class="line">	divider2neg u_div2neg(div2);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">always</span>@(<span class="keyword">posedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">		div2 = ~div2;</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">		div2 = <span class="number">1&#x27;b0</span>;</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">module</span> divider2neg (</span><br><span class="line">	<span class="keyword">input</span> clk</span><br><span class="line">);</span><br><span class="line">	<span class="keyword">reg</span> div2neg;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">always</span>@(<span class="keyword">negedge</span> clk) <span class="keyword">begin</span></span><br><span class="line">		div2neg = ~div2neg;</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">		div2neg= <span class="number">1&#x27;b0</span>;</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p><em>compile</em> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vcs -full64 -kdb -debug_access+all tb.v</span><br></pre></td></tr></table></figure></p>
<p><em>simulate</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./simv</span><br></pre></td></tr></table></figure>
<p><em>load fsdb</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">verdi -ssf tb.fsdb</span><br></pre></td></tr></table></figure>
<p><img src="/2022/06/04/data-dump/image-20220604192421888.png"
alt="image-20220604192421888" /></p></li>
</ul>
<h3
id="fsdbdumpon-fsdbdumpoff"><code>$fsdbDumpon, $fsdbDumpoff</code></h3>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$fsdbDumpon([<span class="string">&quot;+fsdbfile+filename&quot;</span>])</span><br><span class="line"></span><br><span class="line">$fsdbDumpoff([<span class="string">&quot;+fsdbfile+filename&quot;</span>])</span><br></pre></td></tr></table></figure>
<p>These FSDB dumping commands turn dumping on and off.
<code>fsdbDumpon/fsdbDumpoff</code> has the highest priority and
overrides all other FSDB dumping commands.</p>
<p><code>fsdbDumpon/fsdbDumpoff</code> is not restricted to only
<code>fsdbDumpvars</code>. If there is more than one FSDB file open for
dumping at one simulation run, <code>fsdbDumpon/fsdbDumpoff</code> may
only affect a specific FSDB file by specifying the specific file
name.</p>
<ul>
<li><code>+fsdbfile+filename</code>: Specify the FSDB file name. If not
specified, the default FSDB file name is "novas.fsdb"</li>
</ul>
<h3 id="fsdbdumpfinish"><code>$fsdbDumpFinish</code></h3>
<p>This command closes all FSDB files in the current simulation and
stops dumping of signals. Although all FSDB files are <em>closed
automatically at the end of simulation</em>, this dumping command can be
invoked to <em>explicitly</em> close the FSDB files during the
simulation</p>
<h2 id="vcd">VCD</h2>
<h3 id="dumpfile"><code>$dumpfile</code></h3>
<p>The declaration onf <code>$dumpfile</code> must come before the
<code>$dumpvars</code> or any other system tasks that specifies
dump.</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">$dumpfile</span>(<span class="string">&quot;test.vcd&quot;</span>);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>argument <strong>is necessary</strong>, there is no default value</p>
</blockquote>
<h3 id="dumpvars"><code>$dumpvars</code></h3>
<p>The <code>$dumpvars</code> is used to specify which variables are to
be dumped ( in the file mentioned by <code>$dumpfile</code>). The
simplest way to use it is without any argument.</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">$dumpvars</span>(&lt;levels&gt; &lt;, &lt;module_or_variable&gt;&gt;* );</span><br></pre></td></tr></table></figure>
<h3 id="dumplimit"><code>$dumplimit</code></h3>
<p>It is possible that you inadvertantly generate huge file in Gigabytes
( for examples while dumping a Gigahertz clock for one second). To
reduce such occurrences, we may use <code>$dumplimit</code>. It usage
is</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">$dumplimit</span>(&lt;filesize&gt;);</span><br></pre></td></tr></table></figure>
<h3 id="dumpoff-and-dumpon"><code>$dumpoff and $dumpon</code></h3>
<p>During the simulation if you are bothered about about only during a
certain interval then you can use <code>$dumpoff</code> and
<code>$dumpon</code>. The following example shows its usage. It will
dump the changes for first 100 units of time and then between 10200 and
10400 units of time.</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">initial</span></span><br><span class="line">    <span class="built_in">$monitor</span>(<span class="built_in">$time</span>, <span class="string">&quot; reset=%b,clk_out=%b&quot;</span>,reset,clk_out);</span><br><span class="line">    <span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">            <span class="built_in">$dumpfile</span>(<span class="string">&quot;clkdiv2n_tb.vcd&quot;</span>);</span><br><span class="line">            <span class="built_in">$dumpvars</span>(<span class="number">0</span>,clkdiv2n_tb);</span><br><span class="line">            #<span class="number">100</span>;</span><br><span class="line">            <span class="built_in">$dumpoff</span>;</span><br><span class="line">            #<span class="number">10200</span>;</span><br><span class="line">            <span class="built_in">$dumpon</span>;</span><br><span class="line">            #<span class="number">10400</span>;</span><br><span class="line">            <span class="built_in">$dumpoff</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h3 id="demo">demo</h3>
<p>stimulus.v</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">`<span class="keyword">timescale</span> 1ns / 1ps</span></span><br><span class="line"><span class="keyword">module</span> stimulus;</span><br><span class="line">	<span class="comment">// Inputs</span></span><br><span class="line">	<span class="keyword">reg</span> x;</span><br><span class="line">	<span class="keyword">reg</span> y;</span><br><span class="line">	<span class="comment">// Outputs</span></span><br><span class="line">	<span class="keyword">wire</span> z;</span><br><span class="line">	<span class="comment">// Instantiate the Unit Under Test (UUT)</span></span><br><span class="line">	comparator uut (</span><br><span class="line">		<span class="variable">.x</span>(x),</span><br><span class="line">		<span class="variable">.y</span>(y),</span><br><span class="line">		<span class="variable">.z</span>(z)</span><br><span class="line">	);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">		<span class="built_in">$dumpfile</span>(<span class="string">&quot;test.vcd&quot;</span>);</span><br><span class="line">		<span class="built_in">$dumpvars</span>(<span class="number">0</span>);</span><br><span class="line">		<span class="comment">// Initialize Inputs</span></span><br><span class="line">		x = <span class="number">0</span>;</span><br><span class="line">		y = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		#<span class="number">20</span> x = <span class="number">1</span>;</span><br><span class="line">		#<span class="number">20</span> y = <span class="number">1</span>;</span><br><span class="line">		#<span class="number">20</span> y = <span class="number">0</span>;</span><br><span class="line">		#<span class="number">20</span> x = <span class="number">1</span>;</span><br><span class="line">		#<span class="number">40</span> ;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">		<span class="built_in">$monitor</span>(<span class="string">&quot;t=%3d x=%d,y=%d,z=%d \n&quot;</span>,<span class="built_in">$time</span>,x,y,z, );</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<p>comparator.v</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> comparator(</span><br><span class="line">	<span class="keyword">input</span> x,</span><br><span class="line">	<span class="keyword">input</span> y,</span><br><span class="line">	<span class="keyword">output</span> z</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">assign</span> z = (~x &amp; ~y) |(x &amp; y);</span><br><span class="line"></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ xrun stimulus.v comparator.v -access +rwc</span><br><span class="line">$ simvision test.vcd</span><br></pre></td></tr></table></figure>
<h2 id="reference">reference</h2>
<p>$dumpvars and $dumpfile Verilog,
http://www.referencedesigner.com/tutorials/verilog/verilog_62.php</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/04/plusargs-verilog/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/06/04/plusargs-verilog/" class="post-title-link" itemprop="url">plusargs in verilog</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-06-04 12:29:28" itemprop="dateCreated datePublished" datetime="2022-06-04T12:29:28+00:00">2022-06-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2024-08-09 09:55:04" itemprop="dateModified" datetime="2024-08-09T09:55:04+00:00">2024-08-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/digital/" itemprop="url" rel="index"><span itemprop="name">digital</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><strong>plusargs</strong> are command-line switches supported by the
simulator. As per SystemVerilog LRM arguments beginning with the
<code>+</code> character will be available using the
<code>$test$plusargs</code> and <code>$value$plusargs</code> <strong>PLI
APIs</strong>.</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$test$plusargs (user_string)</span><br><span class="line"></span><br><span class="line"><span class="built_in">$value$plusargs</span> (user_string, variable)</span><br></pre></td></tr></table></figure>
<h4 id="example">Example</h4>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tb.v</span></span><br><span class="line"><span class="keyword">module</span> tb;</span><br><span class="line">        <span class="keyword">int</span> a;</span><br><span class="line">        <span class="keyword">initial</span> <span class="keyword">begin</span></span><br><span class="line">                <span class="keyword">if</span>($test$plusargs(<span class="string">&quot;RUNSIM&quot;</span>)) <span class="keyword">begin</span></span><br><span class="line">                        <span class="built_in">$display</span>(<span class="string">&quot;There is RUNSIM plusargs&quot;</span>);</span><br><span class="line">                <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                        <span class="built_in">$display</span>(<span class="string">&quot;There is NO $test$plusargs&quot;</span>);</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">$value$plusargs</span>(<span class="string">&quot;SEED=%d&quot;</span>,a)) <span class="keyword">begin</span></span><br><span class="line">                        <span class="built_in">$display</span>(<span class="string">&quot;SEED=%d&quot;</span>,a);</span><br><span class="line">                <span class="keyword">end</span> <span class="keyword">else</span> <span class="keyword">begin</span></span><br><span class="line">                        <span class="built_in">$display</span>(<span class="string">&quot;There is NO $value$plusargs&quot;</span>);</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>compile</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ vlib work</span><br><span class="line">$ vlog -sv tb.v</span><br></pre></td></tr></table></figure></li>
<li><p>simulate (<em>QuestaSim</em>)</p>
<ul>
<li><p>with<strong>out</strong> plusargs</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vsim work.tb -c -do &quot;run; exit&quot;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># //</span><br><span class="line"># Loading sv_std.std</span><br><span class="line"># Loading work.tb(fast)</span><br><span class="line"># run</span><br><span class="line"># There is NO $test$plusargs</span><br><span class="line"># There is NO $value$plusargs</span><br><span class="line">#  exit</span><br><span class="line"># End time: 13:04:23 on Jun 04,2022, Elapsed time: 0:00:01</span><br><span class="line"># Errors: 0, Warnings: 0</span><br></pre></td></tr></table></figure></li>
<li><p>with plusargs</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vsim work.tb -c -do &quot;run; exit&quot; +SEED=31 +RUNSIM</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>+SEED=31 +RUNSIM</code></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># //</span><br><span class="line"># Loading sv_std.std</span><br><span class="line"># Loading work.tb(fast)</span><br><span class="line"># run</span><br><span class="line"># There is RUNSIM plusargs</span><br><span class="line"># SEED=         31</span><br><span class="line">#  exit</span><br><span class="line"># End time: 13:04:55 on Jun 04,2022, Elapsed time: 0:00:01</span><br><span class="line"># Errors: 0, Warnings: 0</span><br></pre></td></tr></table></figure></li>
</ul></li>
</ul>
<h4 id="reference">reference</h4>
<p>systemverilog-command-line-input URL: <a
target="_blank" rel="noopener" href="https://www.chipverify.com/systemverilog/systemverilog-command-line-input">https://www.chipverify.com/systemverilog/systemverilog-command-line-input</a></p>
<p>PLUSARGS IN SYSTEMVERILOG URL:<a
target="_blank" rel="noopener" href="https://www.theartofverification.com/plusargs-in-systemverilog/">https://www.theartofverification.com/plusargs-in-systemverilog/</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/page/7/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/9/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Guo</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.1/dist/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdn.jsdelivr.net/npm/pdfobject@2.3.0/pdfobject.min.js","integrity":"sha256-JJZNsid68vnh3/zyj0lY9BN5ynxVX/12XgOa1TlaYN0="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js"></script>






  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
