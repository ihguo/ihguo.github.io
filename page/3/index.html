<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.18.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="KNOW-HOW">
<meta property="og:url" content="http://example.com/page/3/index.html">
<meta property="og:site_name" content="KNOW-HOW">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Guo">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/page/3/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/3/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>KNOW-HOW</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">KNOW-HOW</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Guo</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">190</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">237</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/ihguo" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ihguo" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:raytroop@gmail.com" title="E-Mail → mailto:raytroop@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/06/03/variants-def-psd/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/06/03/variants-def-psd/" class="post-title-link" itemprop="url">Different Variants of the PSD Definition</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-06-03 18:45:33" itemprop="dateCreated datePublished" datetime="2023-06-03T18:45:33+00:00">2023-06-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-16 15:37:15" itemprop="dateModified" datetime="2023-09-16T15:37:15+00:00">2023-09-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/dsp/" itemprop="url" rel="index"><span itemprop="name">dsp</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>In the practice of engineering, it has become customary to use
slightly different variants of the PSD definition, depending on the
particular application or research field.</p>
<ul>
<li><p><strong>Two-Sided PSD</strong>, <span
class="math inline">\(S_x(f)\)</span></p>
<p>this is a synonym of the PSD defined as the Fourier Transform of the
<strong>autocorrelation</strong>.</p></li>
<li><p><strong>One-Sided PSD</strong>, <span
class="math inline">\(S&#39;_x(f)\)</span></p>
<p>this is a variant derived from the <em>two-sided PSD</em> by
considering only the <em>positive frequency</em> semi-axis.</p>
<p>To <strong>conserve the total power</strong>, the value of the
one-sided PSD is <strong>twice</strong> that of the two-sided PSD <span
class="math display">\[
S&#39;_x(f) = \left\{ \begin{array}{cl}
0 &amp; : \ f \geq 0 \\
S_x(f) &amp; : \ f = 0 \\
2S_x(f) &amp; : \ f \gt 0
\end{array} \right.
\]</span></p></li>
</ul>
<p><img src="/2023/06/03/variants-def-psd/image-20230603185546658.png"
alt="image-20230603185546658" /></p>
<blockquote>
<p>Note that the one-sided PSD definition makes sense only if the
two-sided is an even function of <span
class="math inline">\(f\)</span></p>
</blockquote>
<p>If <span class="math inline">\(S&#39;_x(f)\)</span> is even
symmetrical around a positive frequency <span
class="math inline">\(f_0\)</span>, then two additional definitions can
be adopted:</p>
<ul>
<li><p><strong>Single-Sideband PSD</strong>, <span
class="math inline">\(S_{SSB,x}(f)\)</span></p>
<p>This is obtained from <span
class="math inline">\(S&#39;_x(f)\)</span> by moving the origin of the
frequency axis to <span class="math inline">\(f_0\)</span> <span
class="math display">\[
S_{SSB,x}(f) =S&#39;_x(f+f_0)
\]</span> This concept is particularly useful for describing phase or
amplitude modulation schemes in wireless communications, where <span
class="math inline">\(f_0\)</span> is the carrier frequency.</p>
<blockquote>
<p>Note that there is no difference in the values of the one-sided
versus the SSB PSD; it is just a pure translation on the frequency
axis.</p>
</blockquote></li>
<li><p><strong>Double-Sideband PSD</strong>, <span
class="math inline">\(S_{DSB,x}(f)\)</span></p>
<p>this is a variant of the SSB PSD obtained by considering only the
positive frequency semi-axis.</p>
<p>As in the case of the one-sided PSD, to conserve total power, the
value of the DSB PSD is twice that of the SSB <span
class="math display">\[
S_{DSB,x}(f) = \left\{ \begin{array}{cl}
0 &amp; : \ f \geq 0 \\
S_{SSB,x}(f) &amp; : \ f = 0 \\
2S_{SSB,x}(f) &amp; : \ f \gt 0
\end{array} \right.
\]</span></p></li>
</ul>
<p><img src="/2023/06/03/variants-def-psd/image-20230603222054506.png"
alt="image-20230603222054506" /></p>
<blockquote>
<p>Note that the DSB definition makes sense only if the SSB PSD is even
symmetrical around zero</p>
</blockquote>
<h2 id="reference">reference</h2>
<p>Da Dalt, N., &amp; Sheikholeslami, A. (2018). Understanding jitter
and phase noise: A circuits and systems perspective. Cambridge
University Press.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/05/29/enbw-nl/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/05/29/enbw-nl/" class="post-title-link" itemprop="url">Effective Noise BandWidth and Noise Floor</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-05-29 23:57:28" itemprop="dateCreated datePublished" datetime="2023-05-29T23:57:28+00:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-16 15:37:15" itemprop="dateModified" datetime="2023-09-16T15:37:15+00:00">2023-09-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/dsp/" itemprop="url" rel="index"><span itemprop="name">dsp</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="ps-and-psd">PS and PSD</h2>
<p>The spectral density format is appropriate for random or noise
signals but inappropriate for discrete frequency components because the
latter theoretically have zero bandwidth</p>
<h2 id="incoherent-and-coherent-power-gains">Incoherent and Coherent
Power Gains</h2>
<p>The incoherent and coherent power gains of these windows are the
appropriate respective correction factors for a power spectral density
plot showing noise and a power spectral plot showing discrete
signals</p>
<h2 id="picket-fence-effect">picket-fence effect</h2>
<h2 id="effective-noise-bandwidth-enbw">Effective Noise BandWidth
(ENBW)</h2>
<h3 id="general-derivation">General derivation</h3>
<p>The relationship between a <em>power spectrum</em> (<span
class="math inline">\(PS, V^2\)</span>) and a <em>power spectral
density</em> (<span class="math inline">\(PSD, V^2/Hz\)</span>) is given
by the <strong>effective noise bandwidth</strong> (<em>ENBW</em>), which
can easily be determined at the time when the DFT is computed.</p>
<p>ENBW should always be recorded when a spectrum or spectral density is
computed, such that the result can be converted to the other form at a
later stage, when the information about the frequency resolution <span
class="math inline">\(f_{res}\)</span> and the window that was used is
normally not easily available any more.</p>
<p>The <strong>normalized equivalent noise bandwidth</strong> (NENBW) of
the window is given by</p>
<p><span class="math display">\[
\text{NENBW} = N\frac{S_2}{S_1}
\]</span> where <span class="math inline">\(S_1 = \sum
_{k=0}^{N-1}w_k\)</span> and <span class="math inline">\(S_2 = \sum
_{k=0}^{N-1}w_k^2\)</span></p>
<p>The <em>ENBW</em> is given by</p>
<p><span class="math display">\[
\text{ENBW} = \text{NENBW}\cdot f_{res} = \text{NENBW}\cdot
\frac{f_s}{N} = f_s\frac{S_2}{(S_1)^2}
\]</span></p>
<blockquote>
<p>Equivalent noise bandwidth (ENBW) compares a <em>window</em> to an
<em>ideal, rectangular time-window</em>. It is the <em>bandwidth of the
rectangular window's frequency-domain shape</em> that passes the same
amount of <strong>white noise</strong> energy as the frequency-domain
shape defined by the other window.</p>
</blockquote>
<p><img src="/2023/05/29/enbw-nl/enbw.png" alt="enbw" /></p>
<p>Therefore, the equivalent noise bandwidth <span
class="math inline">\(B_{enbw}\)</span> is given by</p>
<p><span class="math display">\[
B_{enbw} = \frac{\int_{-f}^{f} |W(f)|^2 df}{|W(f_0)|^2}
\]</span></p>
<p>Translating to discrete domain, the equivalent noise bandwidth can be
computed using DFT samples as</p>
<p><span class="math display">\[
B_{enbw} =\frac{\sum_{k=0}^{N-1}|W[k]|^2}{|W[k_0]|^2}
\]</span></p>
<p>where <span class="math inline">\(k_0\)</span> is the index at which
the magnitude of FFT output is maximum and <span
class="math inline">\(N\)</span> is the window length, i.e. <span
class="math inline">\(k_0=0\)</span>.</p>
<p>Applying <em>Parseval's theorem</em> and <span
class="math inline">\(W[0]=\sum_{n}w[n]\)</span>, <span
class="math inline">\(B_{enbw}\)</span> can also be computed using time
domain samples as</p>
<p><span class="math display">\[
B_{enbw} = N \frac{\sum_{n}|w[n]|^2}{ \left| \sum_{n} w[n] \right|^2}
\]</span></p>
<blockquote>
<p>scale <span class="math inline">\(w[n]\)</span>
<strong>don't</strong> change <span
class="math inline">\(B_{enbw}\)</span></p>
</blockquote>
<h3 id="an-alternative-derivation">An alternative derivation</h3>
<p><img src="/2023/05/29/enbw-nl/coherence-incoherence.drawio.svg"
alt="coherence-incoherence.drawio.svg" /></p>
<p>Assuming the windowed sequence <span class="math inline">\(v[n] =
x[n]w[n]\)</span></p>
<ul>
<li><p><span class="math inline">\(W[k]\)</span>: Fourier Transform of
finite sequence window</p></li>
<li><p><span class="math inline">\(X_{sig}\)</span>: Fourier Transform
of signal</p></li>
<li><p><span class="math inline">\(X_{n}\)</span>: Fourier Transform of
noise</p></li>
<li><p><span class="math inline">\(X_{v,sig}\)</span>: Fourier Transform
of windowed signal</p></li>
<li><p><span class="math inline">\(X_{v,n}\)</span>: Fourier Transform
of windowed signal</p></li>
</ul>
<p>The Fourier Transform of windowed signal can be expressed as</p>
<p><span class="math display">\[\begin{align}
X_{v,sig} &amp;= W_{max}\cdot X_{sig} \\
&amp;= W[0]\cdot X_{sig}
\end{align}\]</span></p>
<blockquote>
<p>For a typical window, <span class="math inline">\(W_{max}\)</span>
occurs at <span class="math inline">\(\omega = 0\)</span></p>
</blockquote>
<p>And the Frouier Transform of windowed noise can be expressed as</p>
<p><span class="math display">\[\begin{align}
X_{v,n}^2 &amp;= \sum_k (W[k])^2 \cdot X_n^2
\end{align}\]</span></p>
<p>divided by <span class="math inline">\((W[0])^2\)</span> on both
sides of the above equation</p>
<p><span class="math display">\[
\frac{X_{v,n}^2}{(W[0])^2} = \frac{\sum_k (W[k])^2}{(W[0])^2} \cdot
X_n^2
\]</span></p>
<p>By Parseval's theorem</p>
<p><span class="math display">\[
\frac{X_{v,n}^2}{\left(\sum_n w[n]\right)^2} = \frac{N\sum_n
w^2[n]}{\left(\sum_n w[n]\right)^2} \cdot X_n^2
\]</span></p>
<p>where <span class="math inline">\(X^2_n\)</span> is what is deserved
and</p>
<p><span class="math display">\[
X_n^2 = \frac{PS_{n}}{B_{enbw}}
\]</span></p>
<p>where <span class="math inline">\(B_{enbw} = N
\frac{\sum_{n}|w[n]|^2}{ \left| \sum_{n} w[n] \right|^2}\)</span></p>
<h3 id="code-example">code example</h3>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">lw = <span class="number">128</span>;</span><br><span class="line">win = hann(lw);</span><br><span class="line">lt = <span class="number">2048</span>;</span><br><span class="line">windft = fftshift(fft(win,lt));</span><br><span class="line"></span><br><span class="line">ad = <span class="built_in">abs</span>(windft).^<span class="number">2</span>;</span><br><span class="line">mg = <span class="built_in">max</span>(ad);</span><br><span class="line"></span><br><span class="line">fs = <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line">bw = enbw(win,fs);</span><br><span class="line"></span><br><span class="line">bdef = sum((win).^<span class="number">2</span>)/sum(win)^<span class="number">2</span>*fs;</span><br><span class="line">fprintf(<span class="string">&quot;bw: %.3f\n&quot;</span>, bw);</span><br><span class="line">fprintf(<span class="string">&quot;bdef: %.3f\n&quot;</span>, bdef);</span><br><span class="line"></span><br><span class="line">freq = -fs/<span class="number">2</span>:fs/lt:fs/<span class="number">2</span>-fs/lt;</span><br><span class="line"></span><br><span class="line"><span class="built_in">plot</span>(freq,ad, bw/<span class="number">2</span>*[<span class="number">-1</span> <span class="number">-1</span> <span class="number">1</span> <span class="number">1</span>],mg*[<span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span>],<span class="string">&#x27;--&#x27;</span>)</span><br><span class="line">xlim(bw*[<span class="number">-1</span> <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">Adiff = trapz(freq,ad)-bw*mg;</span><br><span class="line">fprintf(<span class="string">&quot;Adiff: %.3e\n&quot;</span>, Adiff);</span><br></pre></td></tr></table></figure>
<p>Verify that the area of the rectangle contains the same total power
as the window. <figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Adiff = trapz(freq,ad)-bw*mg</span><br></pre></td></tr></table></figure> output: <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bw: 11.811</span><br><span class="line">bdef: 11.811</span><br><span class="line">Adiff: 7.276e-12</span><br></pre></td></tr></table></figure></p>
<p><img src="/2023/05/29/enbw-nl/image-20230530230434715.png"
alt="image-20230530230434715" /></p>
<h2 id="noise-floor">noise floor</h2>
<p><strong>processing gain</strong>:</p>
<p>DFT can pull signals out of background noise. This is due to the
inherent <em>correlation gain</em> that takes place in any N-point
DFT.</p>
<h3 id="assuming-rect-window-is-used">assuming rect window is used</h3>
<p>DFT bin's output <em>noise</em> standard deviation (<em>rms</em>)
value is proportional to <span class="math inline">\(\sqrt{N}\)</span>,
and the DFT's output magnitude for the bin containing the <em>signal
tone</em> is proportional to <span class="math inline">\(N\)</span></p>
<p>signal tone power <span class="math display">\[
P_{\text{sig}} = 2 \frac{X_{sig}^2}{N^2}
\]</span></p>
<blockquote>
<p>+/- frequency spectrum and apply Parseval's theorem</p>
</blockquote>
<p>noise power <span class="math display">\[\begin{align}
P_n &amp;= \sum_{k=0}^{N-1}{\frac{(X_{n}(k))^2}{N^2}}  \\
&amp;= \frac{X_{n}^2}{N^2}\cdot N \\
&amp;= \frac{X_{n}^2}{N}
\end{align}\]</span></p>
<blockquote>
<p>note white noise, that is <span class="math inline">\(X_n(i) =
X_n(j)\)</span></p>
</blockquote>
<p>displayed <strong>SNR</strong> <span
class="math display">\[\begin{align}
\text{SNR} &amp;= 10\log10\left(\frac{X_{sig}^2}{X_{n}^2}\right) \\
&amp;= 10\log_{10}\left(\frac{P_{\text{sig}}N^2}{P_n2N}\right) \\
&amp;= 10\log_{10}\left(\frac{P_{\text{sig}}}{P_n}\right) +
10\log_{10}\left(\frac{N}{2}\right) \\
&amp;= \text{SNR}&#39; + 10\log_{10}(N/2)
\end{align}\]</span></p>
<p>If we increase a DFT's size from <span
class="math inline">\(N\)</span> to <span
class="math inline">\(2N\)</span>, the DFT's output SNR increased by
3dB. So we say that a DFT's <strong>processing gain</strong> increases
by 3dB whenever <span class="math inline">\(N\)</span> is doubled.</p>
<h3 id="general-formula">general formula</h3>
<p>signal tone power <span class="math display">\[
P_{\text{sig}} = 2 \frac{X_{sig}^2}{S_1^2}
\]</span></p>
<p>noise power <span class="math display">\[
P_n = \frac{X_{n}^2}{S_2}
\]</span></p>
<p>Then, displayed <strong>SNR</strong> is obtained <span
class="math display">\[
\text{SNR} = \text{SNR}&#39;+10\log_{10}\left(\frac{S_1^2}{2S_2}\right)
\]</span></p>
<h2 id="amplitude-correction">Amplitude Correction</h2>
<ol type="1">
<li><p>A finite-duration window <span
class="math inline">\(w[n]\)</span></p>
<p>DTFT is <span class="math inline">\(W[e^{j\omega}]\)</span> and the
maximum magnitude is is at DC frequency, which <span
class="math inline">\(\sum_n w_n\)</span></p></li>
<li><p>Sinusoidal signal <span class="math inline">\(x[n]\)</span></p>
<p>DFS is <span class="math inline">\(X_k\)</span>, and DTFT shall be
<span
class="math inline">\(\frac{2\pi}{N}X_k(e^{j\omega})\)</span></p></li>
<li><p>the windowed sequence <span class="math inline">\(v[n] =
x[n]w[n]\)</span></p>
<p>with multiplication property, DTFT of <span
class="math inline">\(v[n]\)</span> shall be <span
class="math inline">\(\frac{X_k(e^{j\omega})}{N}\sum_n w_n\)</span></p>
<p>As we know, DFT of <span class="math inline">\(v[n]\)</span> is
samples of its DTFT, that is <span class="math display">\[
\frac{X_k(e^{j\omega})}{N}\sum_n w_n = X_v[k]
\]</span> Therefore, <span class="math display">\[
\frac{X_k(e^{j\omega})}{N} = \frac{X_v[k]}{\sum_n w_n}
\]</span></p></li>
</ol>
<h2 id="demo">demo</h2>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%https://aaronscher.com/Course_materials/Communication_Systems/documents/PSD_Autocorrelation_Noise.pdf</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%Clear variables. clear command window, close all figures:</span></span><br><span class="line">clc;</span><br><span class="line">clear all;</span><br><span class="line">close all;</span><br><span class="line"><span class="comment">%%%Setup and define variables</span></span><br><span class="line">f0=<span class="number">10</span>; <span class="comment">%frequency of sinusoidal signal (Hz)</span></span><br><span class="line">fs=<span class="number">100</span>; <span class="comment">%sampling frequency (Hz)</span></span><br><span class="line">Ts=<span class="number">1</span>/fs; <span class="comment">%sampling period (seconds)</span></span><br><span class="line">N0=<span class="number">3000</span>; <span class="comment">%number of samples</span></span><br><span class="line">t=[<span class="number">0</span>:Ts:Ts*(N0<span class="number">-1</span>)]; <span class="comment">%Sample times</span></span><br><span class="line">noise_PSD=<span class="number">.5</span>; <span class="comment">%This is the desired noise power spectral density in W/Hz.</span></span><br><span class="line">variance=noise_PSD*fs;<span class="comment">% Variance = sigma^2</span></span><br><span class="line">sigma=<span class="built_in">sqrt</span>(variance);</span><br><span class="line">noise=transpose(sigma*<span class="built_in">randn</span>(N0,<span class="number">1</span>));<span class="comment">%create sampled white Gaussian noise.</span></span><br><span class="line">xsignal=<span class="number">20</span>*<span class="built_in">sin</span>(<span class="number">2</span>*<span class="built_in">pi</span>*f0*t); <span class="comment">%create sampled sinusoidal signal</span></span><br><span class="line">x=xsignal+noise; <span class="comment">%Add signal to noise</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>)</span><br><span class="line">histogram(noise,<span class="number">30</span>) <span class="comment">%plot histogram</span></span><br><span class="line">set(gca,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">14</span>) <span class="comment">%set font size of axis tick labels to 18</span></span><br><span class="line">xlabel(<span class="string">&#x27;Noise amplitude&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">ylabel(<span class="string">&#x27;Frequency of occurance&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">title(<span class="string">&#x27;Simulated histogram of white Gaussian noise&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">SNR_try1=snr(xsignal,noise); <span class="comment">%calculate SNR using built in &quot;snr&quot; function.</span></span><br><span class="line">SNR_try2=<span class="number">10</span>*<span class="built_in">log10</span>(sum(xsignal.^<span class="number">2</span>)/sum(noise.^<span class="number">2</span>)); <span class="comment">%manually calculate SNR.</span></span><br><span class="line"><span class="comment">%If everything is correct, the two SNR calculations above should agree.</span></span><br><span class="line"><span class="comment">%Plot noise in time-domain</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">plot</span>(t,x)</span><br><span class="line">set(gca,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">14</span>) <span class="comment">%set font size of axis tick labels to 18</span></span><br><span class="line">xlabel(<span class="string">&#x27;Time (s)&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">ylabel(<span class="string">&#x27;Amplitude&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">title(<span class="string">&#x27;Noisey sinusoid&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">grid on</span><br><span class="line"><span class="comment">%Plot power spectral density (PSD) of noise using three different methods:</span></span><br><span class="line"><span class="comment">%</span></span><br><span class="line"><span class="comment">%Method 1. Calcululate PSD from amplitude spectrum</span></span><br><span class="line">N=<span class="number">2</span>^<span class="number">16</span>; <span class="comment">%Number of discrete points in the FFT.)</span></span><br><span class="line">y=fft(x,N)/fs; <span class="comment">%fft of noise</span></span><br><span class="line">z=fftshift(y);<span class="comment">%center noise spectrum</span></span><br><span class="line">f_vec=[<span class="number">0</span>:<span class="number">1</span>:N<span class="number">-1</span>]*fs/N-fs/<span class="number">2</span>; <span class="comment">%designate sample frequencies</span></span><br><span class="line">amplitude_spectrum=<span class="built_in">abs</span>(z); <span class="comment">%compute two-sided amplitude spectrum</span></span><br><span class="line">ESD1=amplitude_spectrum.^<span class="number">2</span>; <span class="comment">%ESD = |F(w)|^2;</span></span><br><span class="line">PSD1=ESD1/((N0<span class="number">-1</span>)*Ts);<span class="comment">% PSD=ESD/T where T = total time of sample</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">3</span>)</span><br><span class="line"><span class="built_in">plot</span>(f_vec,<span class="number">10</span>*<span class="built_in">log10</span>(PSD1));</span><br><span class="line">xlabel(<span class="string">&#x27;Frequency [Hz]&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">ylabel(<span class="string">&#x27;dB/Hz&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">title(<span class="string">&#x27;Power spectral density - method 1&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">grid on</span><br><span class="line">set(gcf,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;w&#x27;</span>); <span class="comment">%set background color from grey (default) to white</span></span><br><span class="line">axis tight</span><br><span class="line"><span class="comment">%calculate average power using PSD calclated from method 1:</span></span><br><span class="line">Average_power_method_1=sum(PSD1)*fs/N; <span class="comment">% Pav=sum(PSD)*delta_f where delta_f=fs/N;</span></span><br><span class="line"><span class="comment">%</span></span><br><span class="line"><span class="comment">%Method 2 - Calculate PSD from autocorrelation</span></span><br><span class="line">time_lag=((-<span class="built_in">length</span>(x)+<span class="number">1</span>):<span class="number">1</span>:(<span class="built_in">length</span>(x)<span class="number">-1</span>))*Ts;</span><br><span class="line">auto_cor=xcorr(x,x)/fs; <span class="comment">%Use xcorr function to find PSD</span></span><br><span class="line">y=<span class="number">1</span>/fs*fft(auto_cor,N); <span class="comment">%fft of auto correlation function</span></span><br><span class="line">PSD2=<span class="built_in">abs</span>(<span class="number">1</span>/(N0<span class="number">-1</span>)*fftshift(fft(auto_cor,N)));</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">4</span>)</span><br><span class="line"><span class="built_in">plot</span>(f_vec,<span class="number">10</span>*<span class="built_in">log10</span>(PSD2));<span class="comment">%use convolution</span></span><br><span class="line">xlabel(<span class="string">&#x27;Frequency [Hz]&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">ylabel(<span class="string">&#x27;dB/Hz&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">title(<span class="string">&#x27;Power spectral density - method 2&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">grid on</span><br><span class="line">set(gcf,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;w&#x27;</span>); <span class="comment">%set background color from grey (default) to white</span></span><br><span class="line">axis tight</span><br><span class="line"><span class="comment">%calculate average power using PSD calclated from method 1:</span></span><br><span class="line">Average_power_method_2=sum(PSD2)*fs/N; <span class="comment">%Pav=sum(PSD)*delta_f where delta_f=fs/N;</span></span><br><span class="line"><span class="comment">%</span></span><br><span class="line"><span class="comment">%Method 3 - Calculate PSD using built in pwelch function</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">5</span>)</span><br><span class="line">PSD3=periodogram(x,[],N,fs,<span class="string">&#x27;centered&#x27;</span>);</span><br><span class="line"><span class="built_in">plot</span>(<span class="number">10</span>*<span class="built_in">log10</span>(PSD3))</span><br><span class="line">xlabel(<span class="string">&#x27;Frequency [Hz]&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">ylabel(<span class="string">&#x27;dB/Hz&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">title(<span class="string">&#x27;Power spectral density - method 3&#x27;</span>,<span class="string">&#x27;fontsize&#x27;</span>,<span class="number">14</span>)</span><br><span class="line">grid on</span><br><span class="line">set(gcf,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;w&#x27;</span>); <span class="comment">%set background color from grey (default) to white</span></span><br><span class="line">axis tight</span><br><span class="line">Average_power_method_3=sum(PSD3)*fs/N; <span class="comment">%Pav=sum(PSD)*delta_f where delta_f=fs/N;</span></span><br><span class="line"><span class="comment">%</span></span><br><span class="line"><span class="comment">%Calculate mean and average PSD of noise:</span></span><br><span class="line">PSD_noise=periodogram(noise,[],N,fs,<span class="string">&#x27;centered&#x27;</span>);</span><br><span class="line">Average_noise_PSD=<span class="built_in">mean</span>(PSD_noise);</span><br><span class="line">Mean_noise=<span class="built_in">mean</span>(noise);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/2023/05/29/enbw-nl/image-20230531004822838.png"
alt="image-20230531004822838" /></p>
<p><img src="/2023/05/29/enbw-nl/image-20230531005008418.png"
alt="image-20230531005008418" /></p>
<blockquote>
<p>The power spectral density plots for methods 2 and 3 exactly match
that for method 1 (shown above).</p>
</blockquote>
<h2 id="reference">reference</h2>
<p>Schmid, H. (2012). How to use the FFT and Matlab's pwelch function
for signal and noise simulations and measurements. URL:<a
target="_blank" rel="noopener" href="http://www.schmid-werren.ch/hanspeter/publications/2012fftnoise.pdf">http://www.schmid-werren.ch/hanspeter/publications/2012fftnoise.pdf</a></p>
<p>Bonnie C.Baker. Reading and Using Fast Fourier Transforms (FFT)
URL:<a
target="_blank" rel="noopener" href="http://ww1.microchip.com/downloads/en/appnotes/00681a.pdf">http://ww1.microchip.com/downloads/en/appnotes/00681a.pdf</a></p>
<p>FFT analysis: SNR and Noise level vary with FFT Window size URL:<a
target="_blank" rel="noopener" href="https://www.virtins.com/forum/viewtopic.php?f=7&amp;t=1382">https://www.virtins.com/forum/viewtopic.php?f=7&amp;t=1382</a></p>
<p>Lyons, R. G. (2011). Understanding digital signal processing (3rd
ed.). Prentice Hall</p>
<p>Stefan Scholl, "Exact Signal Measurements using FFT
Analysis",Microelectronic Systems Design Research Group, TU
Kaiserslautern, Germany. [<a
target="_blank" rel="noopener" href="https://kluedo.ub.rptu.de/frontdoor/deliver/index/docId/4293/file/exact_fft_measurements.pdf">pdf</a>]</p>
<p>enbw Matlab URL:<a
target="_blank" rel="noopener" href="https://www.mathworks.com/help/signal/ref/enbw.html">https://www.mathworks.com/help/signal/ref/enbw.html</a></p>
<p>Aaron Scher. PSD, Autocorrelation, and Noise in MATLAB [<a
target="_blank" rel="noopener" href="https://aaronscher.com/Course_materials/Communication_Systems/documents/PSD_Autocorrelation_Noise.pdf">pdf</a>]</p>
<p>Aaron Scher. FFT, total energy, and energy spectral density
computations in MATLAB [<a
target="_blank" rel="noopener" href="https://aaronscher.com/Course_materials/Communication_Systems/documents/Energy_signals_matlab_tutorial.pdf">pdf</a>]</p>
<p>Amplitude Estimation and Zero Padding URL:<a
target="_blank" rel="noopener" href="https://www.mathworks.com/help/signal/ug/amplitude-estimation-and-zero-padding.html">https://www.mathworks.com/help/signal/ug/amplitude-estimation-and-zero-padding.html</a></p>
<p>Harris, F. (1978). On the use of windows for harmonic analysis with
the discrete Fourier transform. Proceedings of the IEEE, 66, 51-83. [<a
target="_blank" rel="noopener" href="https://www.fceia.unr.edu.ar/prodivoz/Harris_1978.pdf">pdf</a>]</p>
<p>Harris, F. J. . (1976). Windows, harmonic analysis and the discrete
fourier transform. [<a
target="_blank" rel="noopener" href="https://apps.dtic.mil/sti/pdfs/ADA034956.pdf">pdf</a>]</p>
<p>Wang Hongwei. Virtins. Evaluation of Various Window Functions using
Multi-Instrument [<a
target="_blank" rel="noopener" href="https://www.virtins.com/doc/D1003/Evaluation_of_Various_Window_Functions_using_Multi-Instrument_D1003.pdf">pdf</a>]</p>
<p>Properties of FFT Windows Used in Stable32 [<a
target="_blank" rel="noopener" href="http://www.wriley.com/Properties%20of%20FFT%20Windows%20Used%20in%20Stable32.pdf">pdf</a>]</p>
<p>Solomon, Jr, O M. PSD computations using Welch's method. [Power
Spectral Density (PSD)]. United States. https://doi.org/10.2172/5688766
[<a target="_blank" rel="noopener" href="https://www.osti.gov/servlets/purl/5688766">pdf</a>]</p>
<p>Measure Power of Deterministic Periodic Signals [<a
target="_blank" rel="noopener" href="https://www.mathworks.com/help/signal/ug/measuring-the-power-of-deterministic-periodic-signals.html">link</a>]</p>
<p>Mathuranathan. Equivalent noise bandwidth (ENBW) of window functions.
[<a
target="_blank" rel="noopener" href="https://www.gaussianwaves.com/2020/09/equivalent-noise-bandwidth-enbw-of-window-functions/">link</a>]</p>
<p>recordingblogs, Equivalent noise bandwidth [<a
target="_blank" rel="noopener" href="https://www.recordingblogs.com/wiki/equivalent-noise-bandwidth">link</a>]</p>
<p>unpingco, Python for Signal Processing [<a
target="_blank" rel="noopener" href="https://github.com/unpingco/Python-for-Signal-Processing/blob/master/Windowing_Part2.ipynb">lnk</a>]</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/05/29/dnw/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/05/29/dnw/" class="post-title-link" itemprop="url">Impact of Deep N-well Implantation</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-05-29 00:00:26" itemprop="dateCreated datePublished" datetime="2023-05-29T00:00:26+00:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-16 15:37:15" itemprop="dateModified" datetime="2023-09-16T15:37:15+00:00">2023-09-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/analog/" itemprop="url" rel="index"><span itemprop="name">analog</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="substrate-noise">Substrate noise</h2>
<p>A variety of techniques can be used to minimize this noise, for
example by keeping analog devices surrounded by guard rings, or using a
separate supply for the substrate/well taps.</p>
<p>However <em>guard rings alone cannot prevent noise coupling deep in
the substrate, only surface currents</em>.</p>
<blockquote>
<p>PMOS are less noisy than NMOS since PMOS has its nwell which isolates
the substrate noise, but such is not valid for NMOS .</p>
</blockquote>
<h2 id="dnw">DNW</h2>
<p>The N-channel devices built directly into the P-type substrate are
not as effectively isolated as P-channel devices in their N-wells. This
is because despite creating a P+ guard ring around the devices, there
remains an electrical path below the guard ring for charge to flow.</p>
<p>To overcome this issue, a <em>deep N-well</em> can be used to more
effectively isolate these N-channel devices.</p>
<p><img src="/2023/05/29/dnw/image-20230529001556060.png"
alt="image-20230529001556060" /></p>
<p><img src="/2023/05/29/dnw/image-20230529010836003.png"
alt="image-20230529010836003" /></p>
<p><img src="/2023/05/29/dnw/BM_SS_Fig1-520x288.jpg"
alt="BM_SS_Together at Last_Fig1" /></p>
<blockquote>
<p><a
target="_blank" rel="noopener" href="https://blogs.sw.siemens.com/calibre/2015/11/03/together-at-last-combining-netlist-and-layout-data-for-power-aware-verification/">Together
At Last – Combining Netlist and Layout Data for Power-Aware
Verification</a></p>
</blockquote>
<p><img src="/2023/05/29/dnw/image-20230529002733114.png"
alt="image-20230529002733114" /></p>
<ul>
<li>the P-well is separated, allowing the voltage to be controlled</li>
<li>because the circuit within the deep N-well is separated from the
p-substrate in this structure, there is the benefit that this circuitry
is less susceptible to noise that propagates through the
p-substrate.</li>
</ul>
<h2 id="reference">reference</h2>
<p>Chew, K.W., Zhang, J., Shao, K., Loh, W., &amp; Chu, S.F. (2002).
Impact of Deep N-well Implantation on Substrate Noise Coupling and RF
Transistor Performance for Systems-on-a-Chip Integration. 32nd European
Solid-State Device Research Conference, 251-254. URL:[<a
target="_blank" rel="noopener" href="http://www.essderc2002.deis.unibo.it/ESSDERC_web/Session_D11/D11_1.pdf">slides</a>,
<a
target="_blank" rel="noopener" href="http://www.essderc2002.deis.unibo.it/data/pdf/Chew.pdf">paper</a>]</p>
<p>Mark Waller, <a
target="_blank" rel="noopener" href="https://www.planetanalog.com/analog-layout-why-wells-taps-and-guard-rings-are-crucial/">Analog
layout: Why wells, taps, and guard rings are crucial</a></p>
<p>KEITH SABINE <a
target="_blank" rel="noopener" href="https://www.planetanalog.com/using-deep-n-wells-in-analog-design/">Using
Deep N Wells in Analog Design</a></p>
<p>Faricelli, J. (2010). Layout-dependent proximity effects in deep
nanoscale CMOS. IEEE Custom Integrated Circuits Conference 2010,
1-8.</p>
<p>cmos_processing, URL:<a
target="_blank" rel="noopener" href="http://users.ece.utexas.edu/~athomsen/cmos_processing.pdf">http://users.ece.utexas.edu/~athomsen/cmos_processing.pdf</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/05/27/laplace-z/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/05/27/laplace-z/" class="post-title-link" itemprop="url">System Analysis Using Laplace Transform and z-Transform</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-05-27 14:37:03" itemprop="dateCreated datePublished" datetime="2023-05-27T14:37:03+00:00">2023-05-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-16 15:37:15" itemprop="dateModified" datetime="2023-09-16T15:37:15+00:00">2023-09-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/dsp/" itemprop="url" rel="index"><span itemprop="name">dsp</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="reference">reference</h2>
<p>Lathi, B. P., &amp; Green, R. A. (2018). Linear systems and signals
(Third Edition.). Oxford University Press.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/05/27/dtft-dft/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/05/27/dtft-dft/" class="post-title-link" itemprop="url">Discrete Time Fourier Transform (DTFT) vs Discrete Fourier Transform (DFT)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-05-27 10:59:52" itemprop="dateCreated datePublished" datetime="2023-05-27T10:59:52+00:00">2023-05-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-16 15:37:15" itemprop="dateModified" datetime="2023-09-16T15:37:15+00:00">2023-09-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/dsp/" itemprop="url" rel="index"><span itemprop="name">dsp</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="sampling-theorem">sampling theorem</h2>
<h3 id="time-sampling-theorem">time-sampling theorem</h3>
<p><img src="/2023/05/27/dtft-dft/image-20230527154334304.png"
alt="image-20230527154334304" /></p>
<p>The spectrum <span
class="math inline">\(\overline{X}(\omega)\)</span> consists of <span
class="math inline">\(X(\omega)\)</span> repeating periodically with
period <span class="math inline">\(\omega _s = 2\pi/T\)</span> rad/s, or
<span class="math inline">\(f_s = 1/T\)</span> Hz <span
class="math display">\[
\overline{X}(\omega) = \frac{1}{T}\sum_{n=-\infty}^{\infty}X(\omega -
n\omega _s)
\]</span></p>
<h3 id="spectral-sampling-theorem">spectral-sampling theorem</h3>
<p><img src="/2023/05/27/dtft-dft/image-20230527155436179.png"
alt="image-20230527155436179" /></p>
<p>The Fourier transform <span class="math inline">\(X(\omega)\)</span>
of a <strong>timelimited</strong> signal <span
class="math inline">\(x(t)\)</span> is given by <span
class="math display">\[
X(\omega)=\int_{-\infty}^{\infty}x(t)e^{-j\omega t}dt =
\int_0^{\tau}x(t)e^{-j\omega t}dt
\]</span> <span class="math inline">\(x_{T_0}(t)\)</span>, a
<strong>periodic</strong> signal formed by repeating <span
class="math inline">\(x(t)\)</span> every <span
class="math inline">\(T_0\)</span> seconds (<span
class="math inline">\(T_0 \gt \tau\)</span>), which can be expressed by
the exponential Fourier series <span class="math display">\[
x_{T_0}(t) = \sum_{-\infty}^{\infty}D_ne^{jn\omega _0t}
\]</span> where <span class="math inline">\(\omega_0 =
\frac{2\pi}{T_0}\)</span></p>
<p>And <span class="math inline">\(D_n\)</span> can be obtained by
(assuming <span class="math inline">\(T_0 \gt \tau\)</span>) <span
class="math display">\[
D_n = \frac{1}{T_0}\int_0^{T_0}x(t)e^{-jn\omega _0 t}dt =
\frac{1}{T_0}\int_0^{\tau}x(t)e^{-jn\omega _0 t}dt
\]</span> Then it follows that <span class="math display">\[
D_n = \frac{1}{T_0}X(n\omega _0)
\]</span> This result indicates that the <em>coefficients of the Fourier
series</em> for <span class="math inline">\(x_{T_0}(t)\)</span> are
<span class="math inline">\((1/T_0)\)</span> times the <em>sample values
of the spectrum</em> <span class="math inline">\(X(\omega)\)</span>
taken at intervals of <span class="math inline">\(\omega
_0\)</span>.</p>
<h4 id="spectral-interpolation">spectral interpolation</h4>
<p>Consider a signal <em>timelimited</em> to <span
class="math inline">\(\tau\)</span> seconds and <em>centered at</em>
<span class="math inline">\(T_c\)</span>. The spectrum <span
class="math inline">\(X(\omega)\)</span> of <span
class="math inline">\(x(t)\)</span> can be reconstructed from the
samples of <span class="math inline">\(X(\omega)\)</span> and the
<strong>spectral interpolation formula</strong> is obtained as <span
class="math display">\[
X(\omega) = \sum_{-\infty}^{\infty}X(n\omega _0)
\text{sinc}\left(\frac{\omega T_0}{2}-n\pi\right)e^{-j(\omega - n\omega
_0)T_c}
\]</span> step by step:</p>
<ol type="1">
<li><p>The Fourier transform of <span
class="math inline">\(x_{T_0}(t)\)</span> is <span
class="math display">\[
2\pi\sum_n D_n \delta(\omega - n\omega_0) = \frac{2\pi}{T_0}\sum_n
X(n\omega_0) \delta(\omega - n\omega_0)
\]</span></p></li>
<li><p>The Fourier transform of rectangular pulse <span
class="math inline">\(\text{rect}((t-T_c)/T_0)\)</span> centered at
<span class="math inline">\(T_c\)</span> and duration <span
class="math inline">\(T_0\)</span> <span class="math display">\[
T_0 \text{sinc}(\omega T_0/2)e^{-j\omega T_c}
\]</span></p></li>
<li><p>Hence, <span class="math inline">\(X(\omega)\)</span> is <span
class="math inline">\(1/2\pi\)</span> times the <em>convolution</em> of
these two Fourier</p></li>
</ol>
<h2 id="numerical-computation-of-the-fourier-transform">Numerical
Computation of The Fourier Transform</h2>
<h3 id="aliasing-and-leakage-in-numerical-computation">aliasing and
leakage in numerical computation</h3>
<ol type="1">
<li><p><em>timelimited</em> <span
class="math inline">\(x(t)\)</span></p>
<p>its spectrum <span class="math inline">\(X(\omega)\)</span> is
nonbandlimited - aliasing in the frequency domain</p></li>
<li><p><span class="math inline">\(x(t)\)</span> with
<em>bandlimited</em> spectrum <span
class="math inline">\(X(\omega)\)</span></p>
<p>no aliasing in the spectrum; such a signal is nontimelimited and
aliasing in the time domian</p></li>
</ol>
<h3 id="dfs---representation-of-periodic-sequences">DFS - representation
of periodic sequences</h3>
<p>also known as <strong>discrete-time Fouier series (DTFS)</strong></p>
<blockquote>
<p>Any <em>periodic sequence</em> can be represented as <em>a sum of
complex exponential sequences</em>.</p>
</blockquote>
<p>⭐Analysis equation <span class="math display">\[
\tilde{X}[k] = \sum_{n=0}^{N-1}\tilde{x}[n]W_N^{kn}
\]</span> where <span class="math inline">\(W_N =
e^{-j(2\pi/N)}\)</span></p>
<p>⭐Synthesis equation <span class="math display">\[
\tilde{x}[n] = \frac{1}{N}\sum_{k=0}^{N-1}\tilde{X}[k]W_N^{-kn}
\]</span></p>
<blockquote>
<p>The multiplicative constant <span class="math inline">\(1/N\)</span>
is included in above equation for convenience. It could also be absorbed
into the definition of <span
class="math inline">\(\tilde{X}[k]\)</span></p>
</blockquote>
<p>In general <span class="math display">\[
W_N^{n+lN} = e^{-j(2\pi/N)(n+lN)} =e^{-j(2\pi/N)n}=W_N^n
\]</span> The Fourier series coefficients <span
class="math inline">\(\tilde{X}[k]\)</span> can be interpreted to be</p>
<ul>
<li>a sequence of finite length, for <span
class="math inline">\(k=0,...,(N-1)\)</span>, and zero otherwise</li>
<li>a periodic sequence defined for all <span
class="math inline">\(k\)</span>, with period <span
class="math inline">\(N\)</span></li>
</ul>
<p>Clearly, both of these interpretations are acceptable, since in
<em>Synthesis equation</em> we use only the values of</p>
<p><span class="math inline">\(\tilde{X}[k]\)</span> for <span
class="math inline">\(0 \leq k \leq (N-1)\)</span>.</p>
<p>An advantage to interpreting the Fourier series coefficients <span
class="math inline">\(\tilde{X}[k]\)</span> as a periodic sequence is
that there is then a <em>duality</em> between the time and frequency
domains for the Fourier series representation of periodic sequences.</p>
<h4 id="duality">Duality</h4>
<p>An exact duality exists between the time and frequency domains in the
DFS representation that does not exist in the DTFT and z-transform
representation of sequences</p>
<p>This duality property is summarized as follows:</p>
<p>If <span class="math display">\[
\tilde{x}[n] \overset{DFS}\longleftrightarrow \tilde{X}[k]
\]</span> then <span class="math display">\[
\tilde{X}[n] \overset{DFS}\longleftrightarrow N\tilde{x}[-k]
\]</span></p>
<h3 id="the-fourier-transform-of-periodic-signals">The Fourier Transform
of Periodic Signals</h3>
<p>use the DFS representation to obtain a DTFT representation of
periodic signal:</p>
<ol type="1">
<li><p><em>uniform convergence</em> of the Fourier transform of a
sequence (<em>DTFT</em>) requires that the sequence be <em>absolutely
summable</em>, and <em>mean-square convergence</em> requires that the
sequence be <em>square summable</em>. Periodic sequences <strong>satisfy
neither condition</strong> .</p>
<p><strong>Absolute summability is a sufficient condition</strong> for
the existence of a Fourier transform representation (<em>DTFT</em>)</p>
<p><span class="math display">\[\begin{align}
|X(e^{j\omega})| &amp;= \left| \sum_{n=-\infty}^{\infty}x[n]e^{-j\omega
n} \right| \\
&amp;\leq \sum_{n=-\infty}^{\infty}|x[n]||e^{-j\omega n}| \\
&amp;\leq \sum_{n=-\infty}^{\infty}|x[n]| \lt \infty
\end{align}\]</span></p></li>
<li><p>sequences that can be expressed as a sum of complex exponentials
can be considered to have a Fourier transform representation as a train
of impulses</p></li>
</ol>
<p>⭐If <span class="math inline">\(\tilde{x}[n]\)</span> is periodic
with period <span class="math inline">\(N\)</span> and the corresponding
<em>DFS coefficients</em> are <span
class="math inline">\(\tilde{X}[k]\)</span>, then the Fourier transform
of <span class="math inline">\(\tilde{x}[n]\)</span> is defined to be
the <strong>impulse train</strong> <span class="math display">\[
\tilde{X}(e^{j\omega}) =
\sum_{k=-\infty}^{\infty}\frac{2\pi}{N}\tilde{X}[k]\delta\left(\omega -
\frac{2\pi k}{N}\right)
\]</span> Note that <span
class="math inline">\(\tilde{X}(e^{j\omega})\)</span> has the necessary
periodicity with period <span class="math inline">\(2\pi\)</span> since
<span class="math inline">\(\tilde{X}[k]\)</span> is periodic with
period <span class="math inline">\(N\)</span>, and the impulses are
spaced at integer multiples of <span
class="math inline">\(2\pi/N\)</span>, where <span
class="math inline">\(N\)</span> is an integer.</p>
<p>The follow inverse Fourier transform shows <span
class="math inline">\(\tilde{X}(e^{j\omega})\)</span> is a Fourier
transform representation of the periodic sequence <span
class="math inline">\(\tilde{x}[n]\)</span></p>
<p><img src="/2023/05/27/dtft-dft/image-20230528100004194.png"
alt="image-20230528100004194" /></p>
<blockquote>
<p>Although the Fourier transform of a periodic sequence does not
converge in the normal sense, the <strong>introduction of
impulses</strong> (<span class="math inline">\(\delta\left(\omega -
\frac{2\pi k}{N}\right)\)</span>) permits us to include <em>periodic
sequences formally within the framework of Fourier transform
analysis</em></p>
</blockquote>
<h3 id="relate-finite-length-signal-to-periodic-signal">relate
finite-length signal to periodic signal</h3>
<p><img src="/2023/05/27/dtft-dft/image-20230528112723460.png"
alt="image-20230528112723460" /></p>
<blockquote>
<p><span class="math display">\[
x[n] = \left\{ \begin{array}{cl}
\tilde{x}[n] &amp; : \ 0 \leq n \leq N-1 \\
0 &amp; : \text{otherwise}
\end{array} \right.
\]</span></p>
</blockquote>
<p>Consider a finite-length signal <span
class="math inline">\(x[n]\)</span> such that <span
class="math inline">\(x[n] = 0\)</span> except in the interval <span
class="math inline">\(0 \leq n \leq N − 1\)</span>, and consider the
convolution of <span class="math inline">\(x[n]\)</span> with the
periodic impulse train <span
class="math inline">\(\tilde{p}[n]\)</span>: <span
class="math display">\[
\tilde{x}[n] = x[n]*\tilde{p}[n] = x[n]*
\sum_{r=-\infty}^{\infty}\delta[n-rN] = \sum_{r=-\infty}^{\infty}x[n-rN]
\]</span> Thanks to Fourier Transform <em>convolution property</em>, the
DTFT of <span class="math inline">\(\tilde{x}[n]\)</span> is
obtained</p>
<p><span class="math display">\[\begin{align}
\tilde{X}(e^{j\omega}) &amp;= X(e^{j\omega}) \tilde{P}(e^{j\omega})\\
&amp;= X(e^{j\omega})
\sum_{k=-\infty}^{\infty}\frac{2\pi}{N}\delta\left(\omega - \frac{2\pi
k}{N}\right) \\
&amp; =
\sum_{k=-\infty}^{\infty}\frac{2\pi}{N}X(e^{j(2\pi/N)k})\delta\left(\omega
- \frac{2\pi k}{N}\right)
\end{align}\]</span></p>
<p>⭐ we conclude the DFS coefficients of <span
class="math inline">\(\tilde{x}[n]\)</span> is <span
class="math display">\[
\tilde{X}[k] = X(e^{j\omega})|_{\omega=2\pi k/N}
\]</span> where <span class="math inline">\(\tilde{X}[k]\)</span> is
<strong>DFS coefficients</strong> of <span
class="math inline">\(\tilde{X}[k]\)</span>;</p>
<p><span class="math inline">\(X(e^{j\omega})|_{\omega=2\pi
k/N}\)</span> is samples of the <strong>DTFT</strong> of the
<em>finite-length sequence</em> <span
class="math inline">\(x[n]\)</span></p>
<h3 id="sampling-the-fourier-transform">sampling the fourier
transform</h3>
<p>Assuming an <em>aperiodic sequence</em> with Fourier transform <span
class="math inline">\(X(e^{j\omega})\)</span>, the <strong>sequences of
samples</strong> <span class="math inline">\(\tilde{X}[k] =
X(e^{j\omega})|_{\omega=2\pi k/N}\)</span> being periodic with period
<span class="math inline">\(N\)</span> could be the <strong>sequence of
<em>DFS</em> coefficients</strong> of sequence <span
class="math inline">\(\tilde{x}[n]\)</span></p>
<p>⭐To obtain <span class="math inline">\(\tilde{x}[n]\)</span>,
substitute <span class="math inline">\(\tilde{X}[k]\)</span> into DFS
synthesis equation <span class="math display">\[
\tilde{x}[n] =x[n]*\sum_{r=-\infty}^{\infty}\delta[n-rN] =
\sum_{r=-\infty}^{\infty}x[n-rN]
\]</span> Thus, the periodic sequence <span
class="math inline">\(\tilde{x}[n]\)</span>, corresponding to <span
class="math inline">\(\tilde{X}[k]\)</span> obtained by sampling <span
class="math inline">\(X(e^{j\omega})\)</span>, is formed from <span
class="math inline">\(x[n]\)</span> by <em>adding together an infinite
number of shifted replicas of <span
class="math inline">\(x[n]\)</span></em>.</p>
<h3 id="discrete-fourier-transform-dft">Discrete Fourier Transform
(DFT)</h3>
<blockquote>
<p>When the <strong>Fourier series</strong> is used in this way to
represent <em>finite-length sequences</em>, it is called the discrete
Fourier transform or <strong>DFT</strong></p>
<p>In developing, discussing, and applying the DFT, it is always
important to remember that the representation through <em>samples of the
Fourier transform</em> is in effect <em>a representation of the
finite-duration sequence by a periodic sequence</em>, <strong>one period
of which is the finite duration sequence that we wish to
represent</strong></p>
</blockquote>
<ul>
<li><p>Considering a <em>finite-length</em> sequence <span
class="math inline">\(x[n]\)</span> of length <span
class="math inline">\(N\)</span> samples such that <span
class="math inline">\(x[n]=0\)</span> outside the range <span
class="math inline">\(0\leq n \leq N-1\)</span>.</p>
<p>To each finite-length sequence of length <span
class="math inline">\(N\)</span>, we can always associate a periodic
sequence <span class="math inline">\(\tilde{x}[n]\)</span></p>
<p><span class="math inline">\(\tilde{x}[n] =
\sum_{r=-\infty}^{\infty}x[n-rN]\)</span></p></li>
<li><p>Since <span class="math inline">\(x[n]\)</span> is assumed to
have finite length <span class="math inline">\(N\)</span>, there is
<em>no overlap</em> between the terms <span class="math inline">\(x[n −
rN]\)</span> for different values of <span
class="math inline">\(r\)</span>.</p>
<p><span class="math inline">\(\tilde{x}[n] = x[(n \; \text{modulo}\;
N)]\)</span></p></li>
</ul>
<p>As discussed the sequence of <em>DFS coefficients</em> <span
class="math inline">\(\tilde{X}[k]\)</span> of <em>the periodic
sequence</em> <span class="math inline">\(\tilde{x}[n]\)</span> is
itself a periodic sequence with <em>period</em> <span
class="math inline">\(N\)</span>.</p>
<p>To maintain a duality between the time and frequency domains, This
finite-duration sequence, <span class="math inline">\(X [k]\)</span>,
one period of <span class="math inline">\(\tilde{X}[k]\)</span> will be
referred to as the <strong>DFT</strong> <span class="math display">\[
X[k] = \left\{ \begin{array}{cl}
\tilde{X}[k] &amp; : \ 0 \leq k \leq N-1 \\
0 &amp; : \ \text{otherwise}
\end{array} \right.
\]</span> and <span class="math display">\[
\tilde{X}[k] = X[(k \; \text{modulo}\; N)]
\]</span> <span class="math inline">\(\tilde{X}[k]\)</span> and <span
class="math inline">\(\tilde{x}[n]\)</span> are related by</p>
<p><span class="math display">\[\begin{align}
\tilde{X}[k] &amp;= \sum_{n=0}^{N-1}\tilde{x}[n]W_N^{kn} \\
\tilde{x}[n] &amp;=\frac{1}{N} \sum_{k=0}^{N-1}\tilde{X}[k]W_N^{-kn}
\end{align}\]</span></p>
<p>where <span class="math inline">\(W_N = e^{-j(2\pi/N)}\)</span></p>
<p>DFT analysis and synthesis equations , <span
class="math inline">\(X[k]\)</span> and <span
class="math inline">\(x[n]\)</span> are related by</p>
<p>⭐ Analysis equation: <span class="math display">\[
X[k] = \left\{ \begin{array}{cl}
\sum_{n=0}^{N-1}x[n]W_N^{kn} &amp; : \ 0 \leq k \leq N-1 \\
0 &amp; : \ \text{otherwise}
\end{array} \right.
\]</span> ⭐ Synthesis equation: <span class="math display">\[
x[n] = \left\{ \begin{array}{cl}
\frac{1}{N} \sum_{k=0}^{N-1}X[k]W_N^{-kn} &amp; : \ 0 \leq n \leq N-1 \\
0 &amp; : \ \text{otherwise}
\end{array} \right.
\]</span></p>
<blockquote>
<p>That is, the fact that <span class="math inline">\(X[k]=0\)</span>
for <span class="math inline">\(k\)</span> outside the interval <span
class="math inline">\(0 \leq k \leq N −1\)</span> and that <span
class="math inline">\(x[n] = 0\)</span> for <span
class="math inline">\(n\)</span> outside the interval <span
class="math inline">\(0 \leq n \leq N − 1\)</span> is implied, but not
always stated explicitly.</p>
</blockquote>
<blockquote>
<p>The inherent periodicity is always present. Sometimes, it causes us
difficulty, and sometimes we can exploit it, but to totally ignore it is
to invite trouble.</p>
<p>In defining the DFT representation,</p>
<ul>
<li>we are simply recognizing that we are interested in values of <span
class="math inline">\(x[n]\)</span> only in the interval <span
class="math inline">\(0 \leq n \leq N-1\)</span>, because <span
class="math inline">\(x[n]\)</span> is really zero outside that
interval,</li>
<li>and we are interested in values of <span
class="math inline">\(X[k]\)</span> only in the interval <span
class="math inline">\(0 \leq k \leq N-1\)</span> because these are the
only values needed to reconstruct <span
class="math inline">\(x[n]\)</span></li>
</ul>
</blockquote>
<h3 id="multiplication-property-convolution-property">multiplication
property &amp; convolution property</h3>
<p>Because a digital computer can work only with <em>discrete data</em>
(sequence of numbers), moreover, it can compute <span
class="math inline">\(X(\omega)\)</span> only at some <em>discrete
values</em> of <span class="math inline">\(\omega\)</span> (samples of
<span class="math inline">\(X(\omega)\)</span>).</p>
<p><img src="/2023/05/27/dtft-dft/image-20230527181614818.png"
alt="image-20230527181614818" /></p>
<ul>
<li><p><strong>{ (a), (b) } -&gt; { (c), (d) }</strong>:</p>
<p>with CT multiplication property, <span
class="math inline">\(X(\omega) = T
\overline{X}(\omega)\)</span></p></li>
<li><p><strong>{ (c), (d) } -&gt; { (e), (f) }</strong>:</p>
<p>with DT convolution property, <span class="math inline">\(X_N(\omega)
= \frac{2\pi}{N}\overline{X}(\omega)\)</span></p></li>
<li><p>Assuming <span class="math inline">\(x_{T0}(t)
=\sum_{r=-\infty}^{\infty}x(t-rT_0)\)</span>, formed by adding together
an infinite number of shifted replicas of <span
class="math inline">\(x(t)\)</span>: with CT convolution property, <span
class="math inline">\(X_{T0}(\omega)=X(\omega)\frac{2\pi}{T_0}=\overline{X}(\omega)\frac{2\pi
T}{T_0}\)</span> which is <span
class="math inline">\(X_{T0}(\omega)=\frac{2\pi}{N}\overline{X}(\omega)\)</span></p></li>
</ul>
<p><span class="math inline">\(X_N(\omega) = X_{T0}(\omega)\)</span>
indicates that finite-length discrete-time sequence provide Fourier
Transform of continuous-time periodic signal</p>
<p>⭐when a signal <span class="math inline">\(x(t)\)</span> is sampled
and then periodically repeated, the corresponding spectrum is also
sampled and periodically repeated</p>
<h2 id="zero-padding">zero-padding</h2>
<h3 id="the-number-of-zero-padding">The number of zero-padding</h3>
<p>When you tack on a bunch of zeros to a sequence and then compute the
<em>DFT</em>, you're just getting <strong>more and more samples</strong>
of the <em>DTFT</em> of the original sequence.</p>
<p>Let's look at a simple rectangular pulse, <span
class="math inline">\(x[n]=1\)</span> for <span class="math inline">\(0
\leq n \lt M\)</span>. The DTFT of <span
class="math inline">\(x[n]\)</span> is: <span class="math display">\[
X(\omega) = \frac{\sin(\omega M/2)}{\sin(\omega/2)} e^{-j \omega
(M-1)/2}
\]</span> Let's plot <span class="math inline">\(|X(\omega)|\)</span>
for <span class="math inline">\(M=8\)</span> over a couple of
periods:</p>
<p><img src="/2023/05/27/dtft-dft/image-20230527210507334.png"
alt="image-20230527210507334" /></p>
<p>Here's the <em>P</em>-point DFT of our 8-point rectangular pulse:</p>
<ul>
<li><p>8-point DFT</p>
<p><img src="/2023/05/27/dtft-dft/image-20230526231448884.png"
alt="image-20230526231448884" /></p></li>
<li><p>16-point DFT</p>
<p><img src="/2023/05/27/dtft-dft/image-20230526231531076.png"
alt="image-20230526231531076" /></p></li>
<li><p>32-point DFT</p>
<p><img src="/2023/05/27/dtft-dft/image-20230526231633067.png"
alt="image-20230526231633067" /></p></li>
</ul>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">clc;</span><br><span class="line">clear all;</span><br><span class="line"></span><br><span class="line">M = <span class="number">8</span>;</span><br><span class="line">w = <span class="built_in">linspace</span>(<span class="number">-2</span>*<span class="built_in">pi</span>, <span class="number">2</span>*<span class="built_in">pi</span>, <span class="number">800</span>);</span><br><span class="line">X_dtft = (<span class="built_in">sin</span>(w*M/<span class="number">2</span>) ./ <span class="built_in">sin</span>(w/<span class="number">2</span>)) .* <span class="built_in">exp</span>(<span class="number">-1</span><span class="built_in">j</span> * w * (M<span class="number">-1</span>) / <span class="number">2</span>);</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">plot</span>(w, <span class="built_in">abs</span>(X_dtft))</span><br><span class="line">title(<span class="string">&#x27;DTFT (|X(\omega)|)&#x27;</span>)</span><br><span class="line"></span><br><span class="line">x = <span class="built_in">ones</span>(<span class="number">1</span>, M);</span><br><span class="line"></span><br><span class="line"><span class="comment">% P = 8</span></span><br><span class="line">P = <span class="number">8</span>;</span><br><span class="line">X_8pt = fft(x, P);</span><br><span class="line">w_k_8pt = (<span class="number">0</span>:P<span class="number">-1</span>) * (<span class="number">2</span>*<span class="built_in">pi</span>/P);</span><br><span class="line"></span><br><span class="line"><span class="comment">% 16-point dft</span></span><br><span class="line">P = <span class="number">16</span>;</span><br><span class="line">X_16pt = fft(x, P); <span class="comment">% pad 8 point</span></span><br><span class="line">w_k_16pt = (<span class="number">0</span>:P<span class="number">-1</span>) * (<span class="number">2</span>*<span class="built_in">pi</span>/P);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">% 32-point dft</span></span><br><span class="line">P = <span class="number">32</span>;</span><br><span class="line">X_32pt = fft(x, P); <span class="comment">% pad 24 point</span></span><br><span class="line">w_k_32pt = (<span class="number">0</span>:P<span class="number">-1</span>) * (<span class="number">2</span>*<span class="built_in">pi</span>/P);</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">plot</span>(w, <span class="built_in">abs</span>(X_dtft))</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"><span class="built_in">plot</span>(w_k_8pt, <span class="built_in">abs</span>(X_8pt), <span class="string">&#x27;o&#x27;</span>)</span><br><span class="line"><span class="built_in">hold</span> off</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;dtft&#x27;</span>, <span class="string">&#x27;8-point dft&#x27;</span>)</span><br><span class="line">title(<span class="string">&#x27;8-point dft (without zero-padding)&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">3</span>)</span><br><span class="line"><span class="built_in">plot</span>(w, <span class="built_in">abs</span>(X_dtft))</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"><span class="built_in">plot</span>(w_k_16pt, <span class="built_in">abs</span>(X_16pt), <span class="string">&#x27;o&#x27;</span>)</span><br><span class="line"><span class="built_in">hold</span> off</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;dtft&#x27;</span>, <span class="string">&#x27;16-point dft with 8 point zero-padding&#x27;</span>)</span><br><span class="line">title(<span class="string">&#x27;16-point dft&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">4</span>)</span><br><span class="line"><span class="built_in">plot</span>(w, <span class="built_in">abs</span>(X_dtft))</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line"><span class="built_in">plot</span>(w_k_32pt, <span class="built_in">abs</span>(X_32pt), <span class="string">&#x27;o&#x27;</span>)</span><br><span class="line"><span class="built_in">hold</span> off</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;dtft&#x27;</span>, <span class="string">&#x27;32-point dft&#x27;</span>)</span><br><span class="line">title(<span class="string">&#x27;32-point dft with 24 point zero-padding&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><strong>Zero padding does not improve accuracy or
resolution.</strong></p>
<ul>
<li><p>Zero padding only allows us to look at more samples of that
imperfect reality. It can never reduce the imperfection which caused by
<strong>aliasing</strong>.</p></li>
<li><p>The only way to obtain the detailed signal spectrum with a fine
frequency resolution is to apply more available data samples, that is, a
longer sequence of data.</p></li>
</ul>
<p><img src="/2023/05/27/dtft-dft/image-20230529232357283.png"
alt="image-20230529232357283" /></p>
<p><img src="/2023/05/27/dtft-dft/image-20230529232704566.png"
alt="image-20230529232704566" /></p>
<h3 id="prepend-vs-postpend-vs-both">prepend vs postpend vs both</h3>
<p><em>TODO</em></p>
<h2 id="reference">reference</h2>
<p>Proakis, J. G., &amp; Manolakis, D. G. (2007). Digital signal
processing (4th ed.). Pearson Prentice Hall.</p>
<p>Tan, &amp; Jiang, J. (2019). Digital signal processing : fundamentals
and applications / Lizhe Tan and Jean Jiang. (Third edition.). Academic
Press.</p>
<p><a
target="_blank" rel="noopener" href="https://blogs.mathworks.com/steve/2010/03/15/the-dft-and-the-dtft-mathjax/?doing_wp_cron=1648269838.4060609340667724609375">Steve
Eddins, The DFT and the DTFT</a></p>
<p>Lathi, B. P., &amp; Green, R. A. (2018). Linear systems and signals
(Third Edition.). Oxford University Press.</p>
<p>Oppenheim, A. V., &amp; Schafer, R. W. (2014). Discrete-time signal
processing (Third ed., Pearson new internat. ed.). Pearson.</p>
<p>Lyons, R. G. (2011). Understanding digital signal processing (3rd
ed.). Prentice Hall.</p>
<p>Dr. Wang Hongwei. FFT Basics and Case Study using Multi-Instrument
[<a
target="_blank" rel="noopener" href="https://www.virtins.com/doc/D1002/FFT_Basics_and_Case_Study_using_Multi-Instrument_D1002.pdf">pdf</a>]</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/05/27/dft-window/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/05/27/dft-window/" class="post-title-link" itemprop="url">Windowing Technique for Accurate DFT</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-05-27 10:58:53" itemprop="dateCreated datePublished" datetime="2023-05-27T10:58:53+00:00">2023-05-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-16 15:37:15" itemprop="dateModified" datetime="2023-09-16T15:37:15+00:00">2023-09-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/dsp/" itemprop="url" rel="index"><span itemprop="name">dsp</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><strong>leakage</strong>:</p>
<p>​ The component at one frequency leaks into the vicinity of another
compnent owing to the spectral smearing introdued by
<em>window</em>.</p>
<blockquote>
<p>Notice side lobes <em>adding out of phase</em> can <em>reduce</em>
the heights of the peaks</p>
</blockquote>
<h2 id="windowed-signal">Windowed Signal</h2>
<p>Short transient signals in the time domain produce high, broadband
frequency content.</p>
<p><img src="/2023/05/27/dft-window/sharpTransient.png"
alt="sharpTransient" /></p>
<p>To reduce leakage, a mathematical function called a
<strong>window</strong> is applied to the data. Windows are designed to
<em>reduce the sharp transient</em> in the re-created signal as much as
possible.</p>
<p><img src="/2023/05/27/dft-window/windowedsignal.png"
alt="windowedsignal" /></p>
<p>Because the sharp transients are reduced and smoothed, the broadband
frequency of the spectral leakage is also reduced.</p>
<h2 id="periodic-versus-non-periodic-background">Periodic versus
Non-Periodic Background</h2>
<p>When performing a Fourier Transform on measurement data, a window
affects periodic and non-periodic data differently:</p>
<ul>
<li><p><strong>Periodic (No Window needed)</strong>: A signal captured
in a periodic manner does not require a window, and a resulting Fourier
Transform has no leakage. Applying a window alters the resulting Fourier
transform, and even creates spectral leakage where there would have been
no leakage otherwise.</p></li>
<li><p><strong>Non-periodic (Window needed)</strong>: Windows are used
on signals that are captured in a non-periodic manner to reduce spectral
leakage and get closer to the periodic results. A window can minimize
the leakage present in a non-periodic signal, but cannot eliminate
it.</p></li>
</ul>
<blockquote>
<p>The signal is repeated and appended mathematically because the
measured data is assumed to be representative of the entire original
signal</p>
</blockquote>
<h3 id="periodic">Periodic</h3>
<p>When a measurement signal is captured in a periodic manner, the
Fourier Transform of the captured signal will have <strong>no
leakage</strong> in the frequency domain.</p>
<p>A window is not recommended for a periodic signal as it will distort
the signal in an unnecessary manner, and actually creates spectral
leakage.</p>
<p><img src="/2023/05/27/dft-window/captured-periodic.png"
alt="captured-periodic" /></p>
<h3 id="non-periodic">Non-periodic</h3>
<p>The same sine wave, with a different measurement time, results in a
non-periodic captured signal. Here, when the captured signal is
repeated, the original sine wave signal is not re-created.</p>
<p><img src="/2023/05/27/dft-window/captured-nonperiodic.png"
alt="captured-nonperiodic" /></p>
<p>In fact, several broadband transient events (circled in red) are
introduced. These transients create a broadband response, or
<strong>leakage</strong>.</p>
<p><strong>Windows</strong> are used to minimize this leakage effect in
the frequency domain.</p>
<p><img src="/2023/05/27/dft-window/leakage-vs-nonleakage.png"
alt="leakage-vs-nonleakage" /></p>
<h2 id="hanning">Hanning</h2>
<p>When doing operational noise and vibration measurements, the Hanning
window is commonly used.</p>
<p>Random data has spectral leakage due to the <em>abrupt cutoff</em> at
the beginning and end of the time block. It is
<em>non-periodic</em>.</p>
<p>There is <strong>no</strong> way to ensure that the captured random
signal is periodic by varying the measurement time.</p>
<p><strong>Hanning windows</strong> are often used with random data
because they have moderate impact on the frequency resolution and
amplitude accuracy of the resulting frequency spectrum.</p>
<ul>
<li><p>The maximum <em>amplitude error</em> of a Hanning window is
<em>15%</em></p>
<blockquote>
<p>In the cited article, all spectral data <em>had an amplitude
correction factor applied</em>.</p>
</blockquote></li>
<li><p>while the frequency leakage is typically confined to <em>1.5
spectral lines</em> to each side of the original sine wave
signal</p></li>
</ul>
<p><img src="/2023/05/27/dft-window/rtaImage.png"
alt="hanning.png" /></p>
<h3 id="periodic-signal">periodic signal</h3>
<p>Applying the Hanning window (or any window) to a periodic signal
creates <strong>leakage</strong>.</p>
<p><img src="/2023/05/27/dft-window/hanning-periodicsignal.png"
alt="hanning-periodicsignal" /></p>
<blockquote>
<p>The <em>periodically captured</em> sine wave with the Hanning window
(blue) is <em>wider</em> in frequency than the original signal (red)</p>
</blockquote>
<p>In the figure, the sine wave with the Hanning window (blue) is
<em>wider</em> in frequency than the original signal (red).</p>
<h3 id="non-periodic-signal">non-periodic signal</h3>
<p>When a Hanning window is applied to a non-periodic signal, the
leakage is greatly reduced and the amplitude is higher.</p>
<p><img src="/2023/05/27/dft-window/hanning-nonperiodicsignal.png"
alt="hanning-nonperiodicsignal" /></p>
<blockquote>
<p>A <em>non-periodically captured</em> sine wave (magenta) has a
spectral leakage over the entire bandwidth, applying a Hanning window
minimized the leakage (green)</p>
</blockquote>
<h3 id="rms-calculation">RMS calculation</h3>
<p>A <em>RMS calculation</em> <strong>sums up the energy within a
frequency range</strong>.</p>
<p><img src="/2023/05/27/dft-window/rms-cal.png" alt="rms-cal" /></p>
<ul>
<li><p>both the RMS of the periodic and non-periodic signals with a
Hanning window are equal to the RMS of the leakage-free sine
wave.</p></li>
<li><p>Only the RMS of the non-periodic sine wave without a window
applied is not equal to the others</p></li>
</ul>
<blockquote>
<p>With the leakage spread over a smaller frequency range, doing
analysis calculations like <em>RMS</em> yields more accurate
results.</p>
</blockquote>
<h2 id="flattop">Flattop</h2>
<ul>
<li><p>The Flattop window has a <em>better amplitude accuracy</em> in
frequency domain compared to the Hanning window,</p>
<blockquote>
<p>The maximum amplitude error of a Flattop window is <em>less than
0.01%</em>. By contrast, the Hanning window maximum amplitude error is
15%.</p>
</blockquote></li>
<li><p>A Flattop window confines leakage to <em>3.43 spectral lines</em>
to each side of the original signal.</p></li>
</ul>
<h3 id="amplitude-errors">amplitude errors</h3>
<p>These maximum amplitude errors assume that <em>amplitude correction
factors are applied to the frequency spectrums</em>. These amplitude
correction factors compensate for any reduction caused by applying a
window.</p>
<p><img src="/2023/05/27/dft-window/flattop-amplitude.png"
alt="flattop-amplitude" /></p>
<h3 id="leakage">leakage</h3>
<p>The frequency accuracy of the Flattop window is more coarse compared
to a Hanning window. As a result, the Flattop window is typically
employed on data where frequency peaks are distinct and well separated
from each other.</p>
<p><img src="/2023/05/27/dft-window/flattop-leakage.png"
alt="flattop-leakage" /></p>
<p>When the frequency peaks are not guaranteed to be well separated, the
Hanning window is preferred because it is less likely to cause
individual peaks to be lost in the spectrum</p>
<p><img src="/2023/05/27/dft-window/flattop-2tone.png"
alt="flattop-2tone" /></p>
<p>Spectrum of two periodically captured tones that are <span
class="math inline">\(4Hz\)</span> apart with a <span
class="math inline">\(1Hz\)</span> frequency resolution. The spectrum
with a Hanning window (green) shows two peaks while the spectrum with a
Flattop window (blue) shows one peak.</p>
<blockquote>
<p>Note that at the original frequencies of the tones the amplitude is
correct and equal to one for both windows.</p>
</blockquote>
<blockquote>
<p>One common application for a flattop window is performing
<em>calibration</em>. For example, a sound pistonphone only produces
<em>one single</em> and <em>distinct frequency</em> during microphone
calibration.</p>
</blockquote>
<h2 id="uniform">Uniform</h2>
<p>A Uniform window has a value of <em>1.0</em> across the entire
measurement time. In reality, a <strong>Uniform window</strong> could be
called <strong>no window</strong>.</p>
<blockquote>
<p>Depending on the data acquisition system used, sometimes the term
<strong>Rectangular</strong> window is also used.</p>
</blockquote>
<ul>
<li><p>A Uniform window creates no frequency or amplitude distortion
when the measured signal is periodic.</p></li>
<li><p>When a measured signal is not periodic, the amplitude is reduced
by a maximum of <em>36%</em> and the frequency content is spread over
the <em>entire bandwidth of the measurement</em>.</p>
<blockquote>
<p>This is due to <em>sharp transients</em> that are created by
repeating and appending the measured signal.</p>
</blockquote></li>
</ul>
<blockquote>
<p>Whenever a measurement signal is periodic, a Uniform window is
preferred.</p>
<p>Applying a Hanning or Flattop window to a periodic signal will
actually create amplitude and frequency distortion.</p>
</blockquote>
<p><img src="/2023/05/27/dft-window/uniformwindow.png"
alt="uniformwindow" /></p>
<h2 id="benefit-of-reducing-leakage">Benefit of Reducing Leakage</h2>
<p>The benefit is <strong>not</strong> that the captured signal is
perfectly replicated.</p>
<p><strong>The main benefit is that the leakage is now confined over a
smaller frequency range</strong>, instead of affecting the entire
frequency bandwidth of the measurement.</p>
<blockquote>
<p>With the leakage spread over a smaller frequency range, doing
analysis calculations like RMS yields more accurate results.</p>
</blockquote>
<p><img src="/2023/05/27/dft-window/rms-windowed.png"
alt="rms-windowed" /></p>
<p>It is impossible to calculate the proper RMS amplitude estimate over
a limited frequency range of the <em>un-windowed sine wave</em>, since
the leakage is <em>over the full frequency range</em>. Therefore the RMS
amplitude is not correct.</p>
<h3 id="two-tones">Two tones</h3>
<p>In the case of two closely spaced sine tones, without a window being
applied, two tones frequencies would leak into each other, which make
determining the true amplitude of individual peaks very difficult.</p>
<p>The window makes it easier to separate and distinguish each tone so a
proper analysis could be performed.</p>
<p><img src="/2023/05/27/dft-window/windowed-2tone.png"
alt="windowed-2tone" /></p>
<h2 id="the-window-function-in-the-frequency-domain">The window function
in the frequency domain</h2>
<p>The transfer function <span class="math inline">\(a(f)\)</span> of a
window <span class="math inline">\(w_j, j \in [0, N-1]\)</span>
expresses the response of the window to a sinusoidal signal at an offset
of <span class="math inline">\(f\)</span> frequency bins, i.e. DFT .</p>
<p><strong>real part:</strong> <span class="math display">\[
a_r(f)=\sum_{j=0}^{N-1}w_j\cos (2\pi f j/N)
\]</span></p>
<p><strong>imaginary part:</strong> <span class="math display">\[
a_i(f)=\sum_{j=0}^{N-1}w_j\sin (2\pi f j/N)
\]</span></p>
<p>frequency response can be obtained as <span class="math display">\[
a(f) = \frac{\sqrt{a_r^2+a_i^2}}{S_1}
\]</span> where <span class="math inline">\(S_1 = \sum
_{k=0}^{N-1}w_k\)</span></p>
<h2 id="properties-of-the-windows">Properties of the Windows</h2>
<p>There is <strong>no</strong> possibility of trade-off between
<em>main-lobe width</em> and <em>sied-lobe amplitude</em>, since the
<em>window length</em> is the only variable parameter.</p>
<blockquote>
<p>The rectangular window has the narrowest main lobe for a given
length, i.e. <span class="math inline">\(\Delta
_{ml}=4\pi/L\)</span></p>
<p>Other windows include the Bartlett, Hann, and Hamming windows. The
DTFTs of all these windows have main-lobe width <span
class="math inline">\(\Delta _{ml}=8\pi/(L-1)\)</span>, which is
approximately twice that of the rectangular window, but they have
significantly smaller side-lobe amplitudes.</p>
</blockquote>
<h2 id="demo">Demo</h2>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">clc;</span><br><span class="line">clear all;</span><br><span class="line"></span><br><span class="line">N = <span class="number">512</span>;</span><br><span class="line">fs = <span class="number">40</span>*<span class="number">1e3</span>; <span class="comment">% 40kHz</span></span><br><span class="line">fres = fs/N; <span class="comment">% 78.125</span></span><br><span class="line">tt = (<span class="number">0</span>:N<span class="number">-1</span>)*<span class="number">1</span>/fs;</span><br><span class="line">ff = (<span class="number">0</span>:N/<span class="number">2</span>)*fres;</span><br><span class="line">fin = <span class="number">390.625</span>;</span><br><span class="line"></span><br><span class="line">whan = hanning(N); <span class="comment">% hanning window</span></span><br><span class="line">wrect = rectwin(N); <span class="comment">% rect window</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">% fin/fs = 5/N, periodically captured sine wave</span></span><br><span class="line">wv = <span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>*fin*tt);</span><br><span class="line">power = periodogram(wv, whan, N, fs, <span class="string">&#x27;power&#x27;</span>);</span><br><span class="line">X = (power).^<span class="number">0.5</span>*<span class="number">2</span>^<span class="number">0.5</span>;</span><br><span class="line">psd = periodogram(wv, whan, N, fs, <span class="string">&#x27;psd&#x27;</span>);</span><br><span class="line">rms = sum(psd*fres)^<span class="number">0.5</span>;</span><br><span class="line">fprintf(<span class="string">&#x27;RMS@periodic &amp; hanning: %.5f\n&#x27;</span>, rms);</span><br><span class="line"></span><br><span class="line">power_rect = periodogram(wv, wrect, N, fs, <span class="string">&#x27;power&#x27;</span>);</span><br><span class="line">X_rect = (power_rect).^<span class="number">0.5</span>*<span class="number">2</span>^<span class="number">0.5</span>;</span><br><span class="line">psd_rect = periodogram(wv, wrect, N, fs, <span class="string">&#x27;psd&#x27;</span>);</span><br><span class="line">rms_rect = sum(psd_rect*fres)^<span class="number">0.5</span>;</span><br><span class="line">fprintf(<span class="string">&#x27;RMS@periodic &amp; rect: %.5f\n&#x27;</span>, rms_rect);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">plot</span>(ff, X, <span class="string">&#x27;r-o&#x27;</span>, ff, X_rect, <span class="string">&#x27;b-s&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;Frequency(Hz)&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;|X|&#x27;</span>)</span><br><span class="line">title(<span class="string">&#x27;Amplitude spectrum of periodically captured sine wave&#x27;</span>);</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;w/ hanning&#x27;</span>, <span class="string">&#x27;w/ rect&#x27;</span>);</span><br><span class="line">grid on</span><br><span class="line">grid minor</span><br><span class="line"><span class="comment">% rectangular window provide higher frequency resolution</span></span><br><span class="line"><span class="comment">% hanning window induce leakage for the periodically captured sine wave</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">% fin - 0.5fres</span></span><br><span class="line">fin_lkg0d5 = fin - <span class="number">0.5</span>*fres;</span><br><span class="line">wv_lkg0d5 = <span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>*fin_lkg0d5*tt);</span><br><span class="line">power_lkg0d5 = periodogram(wv_lkg0d5, whan, N, fs, <span class="string">&#x27;power&#x27;</span>);</span><br><span class="line">X_lkg0d5 = (power_lkg0d5).^<span class="number">0.5</span>*<span class="number">2</span>^<span class="number">0.5</span>;</span><br><span class="line">psd_lkg0d5 = periodogram(wv_lkg0d5, whan, N, fs, <span class="string">&#x27;psd&#x27;</span>);</span><br><span class="line">rms_lkg0d5 = sum(psd_lkg0d5*fres)^<span class="number">0.5</span>;</span><br><span class="line">fprintf(<span class="string">&#x27;RMS@-0.5fres &amp; hanning: %.5f\n&#x27;</span>, rms_lkg0d5);</span><br><span class="line"></span><br><span class="line">power_lkg0d5_rect = periodogram(wv_lkg0d5, wrect, N, fs, <span class="string">&#x27;power&#x27;</span>);</span><br><span class="line">X_lkg0d5_rect = (power_lkg0d5_rect).^<span class="number">0.5</span>*<span class="number">2</span>^<span class="number">0.5</span>;</span><br><span class="line">psd_lkg0d5_rect = periodogram(wv_lkg0d5, wrect, N, fs, <span class="string">&#x27;psd&#x27;</span>);</span><br><span class="line">rms_lkg0d5_rect = sum(psd_lkg0d5_rect*fres)^<span class="number">0.5</span>;</span><br><span class="line">fprintf(<span class="string">&#x27;RMS@-0.5fres &amp; rect: %.5f\n&#x27;</span>, rms_lkg0d5_rect);</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">plot</span>(ff, X_lkg0d5, <span class="string">&#x27;r-o&#x27;</span>, ff, X_lkg0d5_rect, <span class="string">&#x27;b-s&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;Frequency(Hz)&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;|X|&#x27;</span>)</span><br><span class="line">title(<span class="string">&#x27;Amplitude spectrum of -0.5fres&#x27;</span>);</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;w/ hanning&#x27;</span>, <span class="string">&#x27;w/ rect&#x27;</span>);</span><br><span class="line">grid on</span><br><span class="line">grid minor</span><br><span class="line"><span class="comment">% hanning reduce leakage and max amplitude error 15%</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">% fin - 0.25fres</span></span><br><span class="line">fin_lkg0d25 = fin - <span class="number">0.25</span>*fres;</span><br><span class="line">wv_lkg0d25 = <span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>*fin_lkg0d25*tt);</span><br><span class="line">power_lkg0d25 = periodogram(wv_lkg0d25, whan, N, fs, <span class="string">&#x27;power&#x27;</span>);</span><br><span class="line">X_lkg0d25 = (power_lkg0d25).^<span class="number">0.5</span>*<span class="number">2</span>^<span class="number">0.5</span>;</span><br><span class="line">psd_lkg0d25 = periodogram(wv_lkg0d25, whan, N, fs, <span class="string">&#x27;psd&#x27;</span>);</span><br><span class="line">rms_lkg0d25 = sum(psd_lkg0d25*fres)^<span class="number">0.5</span>;</span><br><span class="line">fprintf(<span class="string">&#x27;RMS@-0.25fres &amp; hanning: %.5f\n&#x27;</span>, rms_lkg0d25);</span><br><span class="line"></span><br><span class="line">power_lkg0d25_rect = periodogram(wv_lkg0d25, wrect, N, fs, <span class="string">&#x27;power&#x27;</span>);</span><br><span class="line">X_lkg0d25_rect = (power_lkg0d25_rect).^<span class="number">0.5</span>*<span class="number">2</span>^<span class="number">0.5</span>;</span><br><span class="line">psd_lkg0d25_rect = periodogram(wv_lkg0d25, wrect, N, fs, <span class="string">&#x27;psd&#x27;</span>);</span><br><span class="line">rms_lkg0d25_rect = sum(psd_lkg0d25_rect*fres)^<span class="number">0.5</span>;</span><br><span class="line">fprintf(<span class="string">&#x27;RMS@-0.25fres &amp; rect: %.5f\n&#x27;</span>, rms_lkg0d25_rect);</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">3</span>)</span><br><span class="line"><span class="built_in">plot</span>(ff, X_lkg0d25, <span class="string">&#x27;r-o&#x27;</span>, ff, X_lkg0d25_rect, <span class="string">&#x27;b-s&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;Frequency(Hz)&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;|X|&#x27;</span>)</span><br><span class="line">title(<span class="string">&#x27;Amplitude spectrum of -0.25fres&#x27;</span>);</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;w/ hanning&#x27;</span>, <span class="string">&#x27;w/ rect&#x27;</span>);</span><br><span class="line">grid on</span><br><span class="line">grid minor</span><br><span class="line"><span class="comment">% hanning reduce leakage</span></span><br></pre></td></tr></table></figure>
<p>output</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">RMS@periodic &amp; hanning: 0.70711</span><br><span class="line">RMS@periodic &amp; rect: 0.70711</span><br><span class="line">RMS@-0.5fres &amp; hanning: 0.70711</span><br><span class="line">RMS@-0.5fres &amp; rect: 0.70711</span><br><span class="line">RMS@-0.25fres &amp; hanning: 0.70711</span><br><span class="line">RMS@-0.25fres &amp; rect: 0.70780</span><br></pre></td></tr></table></figure>
<p><img src="/2023/05/27/dft-window/image-20230526005823613.png"
alt="image-20230526005823613" /></p>
<blockquote>
<p>rectangular window provide higher frequency resolution</p>
</blockquote>
<p><img src="/2023/05/27/dft-window/image-20230526005934411.png"
alt="image-20230526005934411" /></p>
<blockquote>
<p>hanning reduce leakage and max amplitude error 15%</p>
</blockquote>
<p><img src="/2023/05/27/dft-window/image-20230526010047826.png"
alt="image-20230526010047826" /></p>
<blockquote>
<p>hanning reduce leakage and reduce amplitude error</p>
</blockquote>
<h2 id="reference">reference</h2>
<p>Article (20416822) Title: How to Utilize a Windowing Technique for
Accurate DFT URL: <a
target="_blank" rel="noopener" href="https://support.cadence.com/apex/ArticleAttachmentPortal?id=a1Od000000050UrEAI">https://support.cadence.com/apex/ArticleAttachmentPortal?id=a1Od000000050UrEAI</a></p>
<p>B.P. Lathi, Roger Green. Linear Systems and Signals (The Oxford
Series in Electrical and Computer Engineering) 3rd Edition</p>
<p>Window Types: Hanning, Flattop, Uniform, Tukey, and Exponential
URL:<a
target="_blank" rel="noopener" href="https://community.sw.siemens.com/s/article/window-types-hanning-flattop-uniform-tukey-and-exponential">https://community.sw.siemens.com/s/article/window-types-hanning-flattop-uniform-tukey-and-exponential</a></p>
<p>Window Correction Factors URL:<a
target="_blank" rel="noopener" href="https://community.sw.siemens.com/s/article/window-correction-factors">https://community.sw.siemens.com/s/article/window-correction-factors</a></p>
<p>Root Mean Square (RMS) and Overall Level. URL:<a
target="_blank" rel="noopener" href="https://community.sw.siemens.com/s/article/root-mean-square-rms-and-overall-level">https://community.sw.siemens.com/s/article/root-mean-square-rms-and-overall-level</a></p>
<p>Windows and Spectral Leakage. URL:<a
target="_blank" rel="noopener" href="https://community.sw.siemens.com/s/article/windows-and-spectral-leakage">https://community.sw.siemens.com/s/article/windows-and-spectral-leakage</a></p>
<p>Alan V Oppenheim, Ronald W. Schafer. Discrete-Time Signal Processing,
3rd edition</p>
<p>Stefan Scholl, "Exact Signal Measurements using FFT
Analysis",Microelectronic Systems Design Research Group, TU
Kaiserslautern, Germany. [ <a
target="_blank" rel="noopener" href="https://kluedo.ub.rptu.de/frontdoor/deliver/index/docId/4293/file/exact_fft_measurements.pdf">pdf</a>
]</p>
<p>Harris, F. (1978). On the use of windows for harmonic analysis with
the discrete Fourier transform. Proceedings of the IEEE, 66, 51-83. [<a
target="_blank" rel="noopener" href="https://www.fceia.unr.edu.ar/prodivoz/Harris_1978.pdf">pdf</a>]</p>
<p>Equivalent noise bandwidth (ENBW) of window functions URL:<a
target="_blank" rel="noopener" href="https://www.gaussianwaves.com/2020/09/equivalent-noise-bandwidth-enbw-of-window-functions/">https://www.gaussianwaves.com/2020/09/equivalent-noise-bandwidth-enbw-of-window-functions/</a></p>
<p>Why should I zero-pad a signal before taking the Fourier transform?
URL:<a
target="_blank" rel="noopener" href="https://dsp.stackexchange.com/q/741">https://dsp.stackexchange.com/q/741</a></p>
<p>enbw function in MATLAB URL:<a
target="_blank" rel="noopener" href="https://www.mathworks.com/help/signal/ref/enbw.html">https://www.mathworks.com/help/signal/ref/enbw.html</a></p>
<p>Window function – figure of merits URL:<a
target="_blank" rel="noopener" href="https://www.gaussianwaves.com/2020/09/window-function-figure-of-merits/">https://www.gaussianwaves.com/2020/09/window-function-figure-of-merits/</a></p>
<p>Memos on FFT With Windowing URL:<a
target="_blank" rel="noopener" href="https://everynanocounts.com/2018/02/01/memos-on-fft-with-windowing/">https://everynanocounts.com/2018/02/01/memos-on-fft-with-windowing/</a></p>
<p>Jens Ahrens, "Some Notes on Windows in Spectral Analysis," Tech.
Report, Chalmers Univeristy of Technology, 2020. URL:<a
target="_blank" rel="noopener" href="https://appliedacousticschalmers.github.io/scaling-of-the-dft/notes_on_windows/">https://appliedacousticschalmers.github.io/scaling-of-the-dft/notes_on_windows/</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/05/23/sc-spectreRF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/05/23/sc-spectreRF/" class="post-title-link" itemprop="url">SpectreRF Periodic Analysis</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-05-23 01:21:52" itemprop="dateCreated datePublished" datetime="2023-05-23T01:21:52+00:00">2023-05-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-16 15:37:15" itemprop="dateModified" datetime="2023-09-16T15:37:15+00:00">2023-09-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/cad/" itemprop="url" rel="index"><span itemprop="name">cad</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="reference">reference</h2>
<p>Vishal Saxena, "SpectreRF Periodic Analysis" URL:<a
target="_blank" rel="noopener" href="https://www.eecis.udel.edu/~vsaxena/courses/ece614/Handouts/SpectreRF%20Periodic%20Analysis.pdf">https://www.eecis.udel.edu/~vsaxena/courses/ece614/Handouts/SpectreRF%20Periodic%20Analysis.pdf</a></p>
<p>Josh Carnes,Peter Kurahashi. "Periodic Analyses of Sampled Systems"
URL:<a
target="_blank" rel="noopener" href="https://slideplayer.com/slide/14865977/">https://slideplayer.com/slide/14865977/</a></p>
<p>Kundert, Ken. (2006). Simulating Switched-Capacitor Filters with
SpectreRF. URL:<a
target="_blank" rel="noopener" href="https://designers-guide.org/analysis/sc-filters.pdf">https://designers-guide.org/analysis/sc-filters.pdf</a></p>
<p>Article (20482538) Title: Why is pnoise sampled(jitter) different
than pnoise timeaverage on a driven circuit? URL:<a
target="_blank" rel="noopener" href="https://support.cadence.com/apex/ArticleAttachmentPortal?id=a1O0V000009EStcUAG">https://support.cadence.com/apex/ArticleAttachmentPortal?id=a1O0V000009EStcUAG</a></p>
<p>Article (20467468) Title: The mathematics behind choosing the upper
frequency when simulating pnoise jitter on an oscillator URL:<a
target="_blank" rel="noopener" href="https://support.cadence.com/apex/ArticleAttachmentPortal?id=a1O0V000007MnBUUA0">https://support.cadence.com/apex/ArticleAttachmentPortal?id=a1O0V000007MnBUUA0</a></p>
<p>Andrew Beckett. "Simulating phase noise for PFD-CP". URL:<a
target="_blank" rel="noopener" href="https://groups.google.com/g/comp.cad.cadence/c/NPisXTElx6E/m/XjWxKbbfh2cJ">https://groups.google.com/g/comp.cad.cadence/c/NPisXTElx6E/m/XjWxKbbfh2cJ</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/05/21/bilinear-transformation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/05/21/bilinear-transformation/" class="post-title-link" itemprop="url">Bilinear Transformation</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-05-21 10:59:33" itemprop="dateCreated datePublished" datetime="2023-05-21T10:59:33+00:00">2023-05-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-16 15:37:15" itemprop="dateModified" datetime="2023-09-16T15:37:15+00:00">2023-09-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/dsp/" itemprop="url" rel="index"><span itemprop="name">dsp</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><strong>Bilinear Transformation</strong>, also known as
<strong>Bilinear Approximation</strong>, an algebraic transformation
between the variables <span class="math inline">\(s\)</span> and <span
class="math inline">\(z\)</span> that maps the entire <span
class="math inline">\(j\Omega\)</span>-axis in the <span
class="math inline">\(s\)</span>-plane to <em>one revolution of the unit
circle</em> in the <span class="math inline">\(z\)</span>-plane.</p>
<p>That is, with this approach, <span class="math inline">\(-\infty \le
\Omega \le +\infty\)</span> maps onto <span class="math inline">\(-\pi
\le \omega \le +\pi\)</span>, the transformation between the
continuous-time and discrete-time frequency variables is necessarily
<strong>nonlinear</strong>.</p>
<p>With <span class="math inline">\(H_c(s)\)</span> denoting the
continuous-time system function and <span
class="math inline">\(H(z)\)</span> the discrete-time system function,
the bilinear transformation corresponds to replacing <span
class="math inline">\(s\)</span> by <span class="math display">\[
s=\frac{2}{T_d}\left( \frac{1-z^{-1}}{1+z^{-1}} \right)
\]</span></p>
<p>that is, <span class="math display">\[
H(z) = H_c\left( \frac{2}{T_d}\left( \frac{1-z^{-1}}{1+z^{-1}} \right)
\right)
\]</span></p>
<h2 id="reference">reference</h2>
<p>[AN001] Designing from zero an IIR filter in Verilog using biquad
structure and bilinear discretization. URL:<a
target="_blank" rel="noopener" href="https://www.controlpaths.com/articles/an001_designing_iir_biquad_filter_bilinear/">https://www.controlpaths.com/articles/an001_designing_iir_biquad_filter_bilinear/</a></p>
<p>Frequency warping using the bilinear transform. URL:<a
target="_blank" rel="noopener" href="https://www.controlpaths.com/2022/05/09/frequency-warping-using-the-bilinear-transform/">https://www.controlpaths.com/2022/05/09/frequency-warping-using-the-bilinear-transform/</a></p>
<p>Digital control loops. Theoretical approach. URL:<a
target="_blank" rel="noopener" href="https://www.controlpaths.com/2022/02/28/digital-control-loops-theoretical-approach/">https://www.controlpaths.com/2022/02/28/digital-control-loops-theoretical-approach/</a></p>
<p>Simulation of DSP algorithms in Verilog. URL:<a
target="_blank" rel="noopener" href="https://www.controlpaths.com/2023/05/20/simulation-of-dsp-algorithms-in-verilog/">https://www.controlpaths.com/2023/05/20/simulation-of-dsp-algorithms-in-verilog/</a></p>
<p>Implementing a digital biquad filter in Verilog. URL:<a
target="_blank" rel="noopener" href="https://www.controlpaths.com/2021/04/19/implementing-a-digital-biquad-filter-in-verilog/">https://www.controlpaths.com/2021/04/19/implementing-a-digital-biquad-filter-in-verilog/</a></p>
<p>Implementing a FIR filter using folding. URL:<a
target="_blank" rel="noopener" href="https://www.controlpaths.com/2021/05/17/implementing-a-fir-filter-using-folding/">https://www.controlpaths.com/2021/05/17/implementing-a-fir-filter-using-folding/</a></p>
<p>Oppenheim, Alan V. and Cram. “Discrete-time signal processing : Alan
V. Oppenheim, 3rd edition.” (2011).</p>
<p>Extras: PID Compensator with Bilinear Approximation URL:<a
target="_blank" rel="noopener" href="https://ctms.engin.umich.edu/CTMS/index.php?aux=Extras_PIDbilin">https://ctms.engin.umich.edu/CTMS/index.php?aux=Extras_PIDbilin</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/05/20/ldo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/05/20/ldo/" class="post-title-link" itemprop="url">Low-Dropout Regulator</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-05-20 01:13:16" itemprop="dateCreated datePublished" datetime="2023-05-20T01:13:16+00:00">2023-05-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-16 15:37:15" itemprop="dateModified" datetime="2023-09-16T15:37:15+00:00">2023-09-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/analog/" itemprop="url" rel="index"><span itemprop="name">analog</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="reference">reference</h2>
<p>Hinojo, J.M., Martínez, C.I., &amp; Torralba, A.J. (2018). Internally
Compensated LDO Regulators for Modern System-on-Chip Design.</p>
<p>Mingoo Seok. ISSCC 2020 tutorial "Basics of Digital Low-Dropout (LDO)
Integrated Voltage Regulator"</p>
<p>Pavan Kumar Hanumolu. CICC 2015. "Low Dropout Regulators"</p>
<p>Chen, K. (2016). Power Management Techniques for Integrated Circuit
Design.</p>
<p>Morita, B.G. (2014). Understand Low-Dropout Regulator ( LDO )
Concepts to Achieve Optimal Designs.</p>
<p>H. -S. Kim, "Exploring Ways to Minimize Dropout Voltage for
Energy-Efficient Low-Dropout Regulators: Viable approaches that preserve
performance," in IEEE Solid-State Circuits Magazine, vol. 15, no. 2, pp.
59-68, Spring 2023, doi: 10.1109/MSSC.2023.3262767.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/05/20/wire/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Guo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="KNOW-HOW">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | KNOW-HOW">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2023/05/20/wire/" class="post-title-link" itemprop="url">wire</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-05-20 00:54:06" itemprop="dateCreated datePublished" datetime="2023-05-20T00:54:06+00:00">2023-05-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-09-16 15:37:15" itemprop="dateModified" datetime="2023-09-16T15:37:15+00:00">2023-09-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/analog/" itemprop="url" rel="index"><span itemprop="name">analog</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="delay">delay</h2>
<h3 id="the-elmore-delay">The Elmore Delay</h3>
<p><img src="/2023/05/20/wire/image-20230624234813719.png"
alt="image-20230624234813719" /></p>
<p><img src="/2023/05/20/wire/image-20230624234940864.png"
alt="image-20230624234940864" /></p>
<p><img src="/2023/05/20/wire/image-20230625001756173.png"
alt="image-20230625001756173" /></p>
<blockquote>
<p>Basic idea: use of <strong>mean</strong> of <span
class="math inline">\(v&#39;(t)\)</span> to approximate
<strong>median</strong> of <span
class="math inline">\(v&#39;(t)\)</span></p>
</blockquote>
<p><img src="/2023/05/20/wire/image-20230624235148246.png"
alt="image-20230624235148246" /></p>
<p><img src="/2023/05/20/wire/image-20230625002239199.png"
alt="image-20230625002239199" /></p>
<blockquote>
<p>Elmore delay approximates the <strong>median</strong> of <span
class="math inline">\(h(t)\)</span> by the <strong>mean</strong> of
<span class="math inline">\(h(t)\)</span></p>
</blockquote>
<h3 id="distributed-rc-line">Distributed RC-Line</h3>
<p><img src="/2023/05/20/wire/image-20230624224005736.png"
alt="image-20230624224005736" /></p>
<h3 id="lumped-approximations">Lumped approximations</h3>
<h4 id="rc-models"><span class="math inline">\(rc\)</span>-models</h4>
<p>If your simulator does not support a distributed <span
class="math inline">\(rc\)</span>-model, or if the computational
complexity of these models slows down your simulation too much, you can
construct a simple yet accurate model yourself by approximating the
distributed <span class="math inline">\(rc\)</span> by a lumped RC
network with a limited number of elements</p>
<p><img src="/2023/05/20/wire/image-20230624230057265.png"
alt="image-20230624230057265" /></p>
<blockquote>
<p>The accuracy of the model is determined by the number of stages. For
instance, the error of the <span class="math inline">\(\Pi -3\)</span>
model is less than 3%, which is generally sufficient.</p>
</blockquote>
<h4 id="why-use-pi-model">Why use "<span
class="math inline">\(\Pi\)</span> Model"</h4>
<p><img src="/2023/05/20/wire/image-20230624230800255.png"
alt="image-20230624230800255" /></p>
<h4 id="examples">examples</h4>
<p><img src="/2023/05/20/wire/image-20230624224643487.png"
alt="image-20230624224643487" /></p>
<p><img src="/2023/05/20/wire/image-20230624224923241.png"
alt="image-20230624224923241" /></p>
<h2 id="inductive-effect">Inductive Effect</h2>
<ul>
<li>RC delay increases quadratically with length</li>
<li>LC delay (speed of light flight time) increases linearly with
length</li>
</ul>
<blockquote>
<p>Inductance will only be important to the delay of low-resistance
signals such as wide clock lines</p>
</blockquote>
<h3 id="wave">wave</h3>
<p>Signal propagates over the wire as a <strong>wave</strong> (rather
than <strong>diffusing</strong> as in <span
class="math inline">\(rc\)</span> only models)</p>
<blockquote>
<p>Signal propagates by alternately transferring energy from capacitive
to inductive modes</p>
</blockquote>
<h2 id="reference">reference</h2>
<p>Akio Kitagawa, Analog layout design <a
target="_blank" rel="noopener" href="https://mixsignal.files.wordpress.com/2013/03/analog-layout.pdf">https://mixsignal.files.wordpress.com/2013/03/analog-layout.pdf</a></p>
<p>THE WIRE <a
target="_blank" rel="noopener" href="http://bwrcs.eecs.berkeley.edu/Classes/icdesign/ee141_f01/Notes/chapter4.pdf">http://bwrcs.eecs.berkeley.edu/Classes/icdesign/ee141_f01/Notes/chapter4.pdf</a></p>
<p>Anoop Veliyath, Design Engineer, Cadence Design Systems. Accurately
Modeling Transmission Line Behavior with an LC Network-based Approach
[<a
target="_blank" rel="noopener" href="https://www.pspice.com/sites/default/files/Transmission_Line_Modeling.pdf">pdf</a>]</p>
<p>Mark Horowitz. Lecture 2: Wires and Wire Models [<a
target="_blank" rel="noopener" href="https://web.stanford.edu/class/archive/ee/ee371/ee371.1066/lectures/Old/lect_02.pdf">pdf</a>]</p>
<p>Neil Weste and David Harris. 2010. CMOS VLSI Design: A Circuits and
Systems Perspective (4th. ed.). Addison-Wesley Publishing Company,
USA.</p>
<p>Cheng-Kok Koh. EE695K Modeling and Optimization of High Performance
Interconnect [<a
target="_blank" rel="noopener" href="https://engineering.purdue.edu/~chengkok/ee695K/lec3a.pdf">lec3a_pdf</a>]</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="Previous page" aria-label="Previous page" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/19/">19</a><a class="extend next" rel="next" title="Next page" aria-label="Next page" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Guo</span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.1/dist/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdn.jsdelivr.net/npm/pdfobject@2.2.12/pdfobject.min.js","integrity":"sha256-g2xji1rlE3KsGVClvuxTbcR0Kn2+wtQADSff2Tbb4zA="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js"></script>






  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
